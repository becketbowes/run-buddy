/*! For license information please see sub_common.js.LICENSE.txt */
(window.LearnosityAmd=window.LearnosityAmd||[]).push([[0],{132:function(t,r,a){"use strict";a.d(r,"a",(function(){return i18nTemplate}));var l=a(0),S=a.n(l);function i18nTemplate(t,r){return S.a.isEmpty(t)?"":(S()(r).forEach((function(r,a){var l="{{".concat(a,"}}");t=t.replace(l,r)})),t)}},136:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(10),L=(a(42),a(35));function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=_getPrototypeOf(t);if(r){var S=_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E=["exactMatch","partialMatch","partialMatchV2"],D=function isDefaultValidResponseValue(t){return 0===S.a.filter(t,(function(t){return t||0===t})).length},j=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(ClozeScorer,t);var r=_createSuper(ClozeScorer);function ClozeScorer(){return _classCallCheck(this,ClozeScorer),r.apply(this,arguments)}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(ClozeScorer,[{key:"reset",value:function reset(t){var r=JSON.stringify(t),a=this.flags||this.cachedFlags;if(this.serializedData!==r){t.question.validation&&t.question.validation.scoring_type||(t=O.a.normalizeParameters(t));var l=getOptions(t.question,a);try{this.scoringData=function getScoringData(t,r){var a=t.question.validation,l=[];if(!function canValidateResponse(t){if(!1===S.a.getNested(t,"validation.automarkable"))return!1;var r=t.validation||t||{};return!S.a.isEmpty(r)&&(S.a.isArray(r.valid_responses)||S.a.isObject(r.valid_response)&&!D(r.valid_response.value))}(t.question))return{automarkable:!1};t.question.equiv_literal_legacy&&(t=O.a.processCompatibility(t));if(t.response=t.response||{},a&&a.scoring_type){if(!S.a.contains(E,a.scoring_type))throw new O.a.InvalidScoringTypeException(t.question.type,a.scoring_type);return a.valid_response&&l.push(a.valid_response),a.alt_responses&&(l=l.concat(a.alt_responses)),function processResponsesCurrentScoringFormat(t,r,a){var l={score:1,penaltyScore:0,rounding:"floor"};return O.a.scoreArray(t,r,l,a)}(t,l,r)}return S.a.isArray(t.question.valid_responses)?function processLegacyResponses1233(t,r){var a,l,L=t.question,E=t.response&&t.response.value||[],D=L.valid_responses,j=[];r=getOptions(L,{stripWhiteSpaceForMath:!0}),S.a.each(E,(function(t,L){var E,B,q=D[L],G=!1;S.a.each(q,(function(a){a.value&&S.a.isNumber(a.score)&&(O.a.stringCompare(t,a.value,r)?(B=a.score,G=!0):B=B||0,(S.a.isUndefined(E)||a.score>E)&&(E=a.score))})),a=O.a.addIfDefined(a,B),l=O.a.addIfDefined(l,E),j.push(G)})),E.length||S.a.each(D,(function(t,r){var a;S.a.each(t,(function(t){S.a.isNumber(t.score)&&(S.a.isUndefined(a)||t.score>a)&&(a=t.score)})),l=O.a.addIfDefined(l,a)}));return{score:a,responsesValid:j,maxScore:l,isValid:j.length?S.a.all(j):void 0}}(t,r):function processLegacyResponsesPre2140(t,r){var a,l=t.question,L=t.response||{};l.validation=l.validation||{};var E,D,j=l.validation.valid_responses,B=L.value||[],q=Math.abs(S.a.isNumber(l.validation.penalty_score)?l.validation.penalty_score:0),G=function getResponseScoreArray(t){var r,a=parseFloat(t.validation.valid_score),l=t.validation.valid_responses,O=[];if(a=isNaN(a)?1:a,S.a.isArray(t.validation.valid_score))O=t.validation.valid_score;else for(var L=0;L<l.length;L++){r=[];for(var E=0;E<l[L].length;E++)r.push(a);O.push(r)}return O}(l),X=[],$=0;S.a.each(B,(function(t,l){var L=j[l],D=0,B=!1;if(!S.a.isUndefined(t)&&null!==t&&""!==t&&S.a.isArray(L))for(var $=0;$<L.length;$++){if(O.a.stringCompare(t,L[$],r)){D=G[l][$],a=L,B=!0;break}D=-1*q}X.push(B),E=(S.a.isUndefined(E)?0:E)+D})),S.a.each(G,(function(t){$+=S.a.max(t)})),B.length&&!1===l.validation.partial_scoring&&E!==$&&(E=0);B.length&&X.length&&(D=!1===l.validation.partial_scoring?S.a.all(X):S.a.any(X));return{score:E,responsesValid:X,suggestedResponse:a,maxScore:$,isValid:D}}(t,r)}(t,l),O.a.normalizeScores(this.scoringData,t)}catch(t){this.scoringData={error:t}}this.serializedData=r}return this.cachedFlags=a,this}},{key:"flags",get:function get(){}}]),ClozeScorer}(L.a);function getOptions(t,r){var a={caseSensitive:!!t.case_sensitive,removeWhitespace:!!t.is_math&&r.stripWhiteSpaceForMath,matchAllPossibleResponses:!(!t.validation||!t.validation.match_all_possible_responses)};return delete r.stripWhiteSpaceForMath,S.a.extend(r,a)}r.a=j},143:function(t,r,a){"use strict";a.d(r,"a",(function(){return l})),a.d(r,"f",(function(){return S})),a.d(r,"e",(function(){return O})),a.d(r,"d",(function(){return L})),a.d(r,"c",(function(){return E})),a.d(r,"g",(function(){return D})),a.d(r,"b",(function(){return j}));var l={bold:{type:"button",icon:"lrn-icon-bold",command:"bold"},italic:{type:"button",icon:"lrn-icon-italic",command:"italic"},underline:{type:"button",icon:"lrn-icon-underline",command:"underline"},codeInline:{type:"button",icon:"lrn-icon-code-inline",command:"codeInline"},codeEditor:{type:"button",icon:"lrn-icon-code-editor",command:"codeEditor"},orderedList:{type:"button",icon:"lrn-icon-list-numbered",command:"insertOrderedList"},unorderedList:{type:"button",icon:"lrn-icon-list-bulleted",command:"insertUnorderedList"},removeFormat:{type:"button",icon:"lrn-icon-remove-format",command:"removeFormat"},alignLeft:{type:"button",icon:"lrn-icon-align-left",command:"alignLeftStyle"},alignCenter:{type:"button",icon:"lrn-icon-align-center",command:"alignCenterStyle"},alignRight:{type:"button",icon:"lrn-icon-align-right",command:"alignRightStyle"},alignJustify:{type:"button",icon:"lrn-icon-align-justify",command:"alignJustifyStyle"},superscript:{type:"button",icon:"lrn-icon-superscript",command:"superscript"},subscript:{type:"button",icon:"lrn-icon-subscript",command:"subscript"},insertHorizontalRule:{type:"button",icon:"lrn-icon-hr",command:"insertHorizontalRule"},indentIncrease:{type:"button",icon:"lrn-icon-indent-increase",command:"increaseIndent"},indentDecrease:{type:"button",icon:"lrn-icon-indent-decrease",command:"decreaseIndent"},textDirectionLtr:{type:"button",icon:"lrn-icon-text-direction-ltr",command:"textDirectionLtr"},textDirectionRtl:{type:"button",icon:"lrn-icon-text-direction-rtl",command:"textDirectionRtl"},blockquote:{type:"button",icon:"lrn-icon-blockquote",command:"insertBlockQuote"},table:{type:"createTable",icon:"lrn-icon-table"},editTable:{type:"editTable",icon:"lrn-icon-edit-table"},image:{type:"insertImage",icon:"lrn-icon-image",icons:{edit:"lrn-icon-image-edit",preview:"lrn-icon-image-preview",delete:"lrn-icon-image-delete"}},undo:{type:"button",icon:"lrn-icon-undo",command:"undo"},redo:{type:"button",icon:"lrn-icon-redo",command:"redo"},charactermap:{type:"charactermap"},characterMathMap:{type:"characterMathMap"},"|":{type:"divider"},formulaEditor:{type:"formulaEditor",icon:"lrn-icon-formula"}},S=12,O={SMALL:"small",MEDIUM:"medium",LARGE:"large",FULL_SIZE:"fullSize"},L={SMALL:200,MEDIUM:525,LARGE:1024,FULL_SIZE:3024},E={CREATE_FORMULA:"createFormula",EDIT_FORMULA:"editFormula"},D={FORMULA_EDITOR:"editFormula"},j=["image/jpg","image/jpeg","image/png","image/gif","image/bmp",".jfif"]},153:function(t,r,a){"use strict";var l=a(126),S=a.n(l);function Icon(t){var r=t.icon;return r?S.a.createElement("span",{className:"lrn_icon  ".concat(r),"aria-hidden":"true"}):null}function ScreenReader(t){var r=t.label;return r?S.a.createElement("span",{className:"sr-only"},"  ",r):null}r.a={Divider:function Divider(){return S.a.createElement("div",{className:"lrn-divider"})},Button:function Button(t){var r=t.disabled,a=t.isActive,l=t.name,O=t.icon,L=t.label,E=t.activeClassName,D=t.children,j=t.getRef,B=t.onMouseEnter,q=t.onMouseLeave,G=t.onMouseDown,X=t.onClick,$=t.tabIndex,Z="lrn_btn  lrn-editor-toolbar-button-".concat(l,"  ").concat(a?E:"","  ").concat(t.className||"");return S.a.createElement("button",{ref:function ref(t){return j&&j(t)},type:"button",className:Z,"aria-label":L,"aria-pressed":a,disabled:r,onMouseEnter:function onMouseEnter(){return B(L)},onMouseLeave:q,onMouseDown:function mouseDownHandler(t){G&&G(),t.preventDefault()},onClick:function clickHandler(t){X&&X(),t.preventDefault()},tabIndex:$},S.a.createElement(Icon,{icon:O}),S.a.createElement(ScreenReader,{label:L}),D)}}},154:function(t,r,a){"use strict";var l=a(126),S=a.n(l),O=a(179);a(182);r.a=function Modal(t){var r=t.afterRender,a=t.children,l=t.title,L=t.parentNode,E=t.modalIsOpen,D=t.onRequestClose,j=t.preventFocusWhenAppear,B="lrn-wysihtml-modal  ".concat(t.className||"");return S.a.createElement(O.a,{afterRender:r,preventFocusWhenAppear:j,isOpen:E,parentNode:L,className:"lrn-wysihtml-floating-modal",onRequestClose:D,shouldUpdatePosition:!1},S.a.createElement("div",{className:B,style:{opacity:1}},S.a.createElement("div",{className:"lrn-wysihtml-modal-dialog",role:"dialog",style:{opacity:1}},S.a.createElement("div",{className:"lrn-wysihtml-modal-title"},l),S.a.createElement("div",{className:"lrn-wysihtml-modal-content"},a),S.a.createElement("button",{type:"button",className:"lrn_btn lrn_btn_close",title:"Close","data-lrn-action":"close",onClick:D},S.a.createElement("span",{className:"sr-only"},"Close")))))}},166:function(t,r,a){"use strict";var l=a(5),S=a.n(l),O=a(0),L=a.n(O),E=a(51),D=["toggle"],j=["Left","Right","Backspace","÷","×","-","+","="];switch(E.a.getOs()){case"osx":D=["shift","opt"];break;case"windows":case"unix":case"linux":D=["shift","alt"]}var B=S.a.Model.extend({keysForToggle:D,keyForCtrlToggle:"ctrl",ariaHiddenSymbols:j,defaults:{type:"write"},initialize:function initialize(){this.createDisplayableShortcut(),this.on("change:shortcut",this.createDisplayableShortcut,this)},createDisplayableShortcut:function createDisplayableShortcut(){var t=L.a.clone(this.get("shortcut"));"toggle"===L.a.first(t)&&(t=L.a.union(this.keysForToggle,L.a.rest(t,1))),"ctrl"===L.a.first(t)&&(t=L.a.union(["ctrl"],L.a.rest(t))),t&&t[0]===this.get("title")&&(t=[]),this.set("displayableShortcut",t)},renderLabelAsLatex:function renderLabelAsLatex(){var t=this.get("label_latex");return L.a.isBoolean(t)?t:this.get("label").indexOf("\\")>-1},isPlaceholder:function isPlaceholder(){return""===this.get("id")},isFunctional:function isFunctional(){return!("addmatrixcol"===this.get("name")||"addmatrixrow"===this.get("name"))&&"keystroke"===this.get("type")},hasOwnStyle:function hasOwnStyle(){return!!this.get("style")},isAria:function isAria(t){return L.a.contains(j,t)}});r.a=S.a.Collection.extend({model:B,get:function get(t){return S.a.Collection.prototype.get.apply(this,arguments)||this.find((function(r){return L.a.contains(r.get("aliases"),t)}))},add:function add(t){this.isUnique(t)&&S.a.Collection.prototype.add.apply(this,arguments)},isUnique:function isUnique(t){var r=t.aliases&&L.a.union(t.aliases,t.id)||[];return!this.any((function(a){return t.id===a.id||L.a.intersection(r,a.get("aliases")).length}))},getShortcutsMap:function getShortcutsMap(){var t={};return this.each((function(r){var a=r.get("shortcut");"toggle"===L.a.first(a)&&(t[a[1]]=r)})),t},getGroups:function getGroups(){var t=L.a.unique(this.pluck("group")),r=this;return L.a.map(t,(function(t){return r.where({group:t})}))},getFirstInEachGroup:function getFirstInEachGroup(){return L.a.map(this.getGroups(),L.a.first)}})},170:function(t,r,a){"use strict";a.d(r,"a",(function(){return D}));var l=a(0),S=a.n(l),O=a(2),L=a(13);function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}var E="spokenmathWorker";var D=new(function(){function SingletonWorker(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,SingletonWorker),this._loading=!1,this._collections=[],this._resolveCollections=this._resolveCollections.bind(this),this.getPostMessage=r.getPostMessage.bind(this),this.processReceivedMessage=r.processReceivedMessage.bind(this)}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(SingletonWorker,[{key:"process",value:function process(t){var r=this,a=this._collections;return new O.default((function(l){a.push({data:t,resolve:l}),r._loading||r._loadWorker()}))}},{key:"_loadWorker",value:function _loadWorker(){var t=this;this._loading=!0,function loadWorker(t){return new O.default((function(r){L.a.getExposedExternalBundle(t)().then((function(t){r(t)}))}))}(E).then((function(r){var a=new r,l=t._collections,O=S.a.pluck(l,"data");a.postMessage(t.getPostMessage(O)),a.addEventListener("message",(function(r){var S=r.data;a.terminate(),t._loading=!1,t._resolveCollections(t.processReceivedMessage(S)),l.length&&t._loadWorker()}))}))}},{key:"_resolveCollections",value:function _resolveCollections(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=this._collections;t.length&&r.length;){var a=r.shift(),l=a.resolve;l(t.shift())}}}]),SingletonWorker}())(E,{getPostMessage:function getPostMessage(t){return{latexes:t}},processReceivedMessage:function processReceivedMessage(t){return t.value}})},175:function(t,r,a){"use strict";var l=a(1),S=a.n(l),O=a(0),L=a.n(O),E=function ScaleCompensator(t,r){var a=this;this.id=L.a.uniqueId("lrn_scale_compensator_"),this.$el=t,this.opts=r,this.scale=L.a.debounce((function(){var t=L.a.bind(a.scaleAndPosition,a);window.requestAnimationFrame?window.requestAnimationFrame(t):t()}),r.debounceTime)};L.a.extend(E.prototype,{start:function start(t){return S()(window).on("resize."+this.id+" orientationchange."+this.id+" scroll."+this.id,this.scale),this},stop:function stop(){S()(window).off("."+this.id)},scaleAndPosition:function scaleAndPosition(){var t=document.documentElement.clientWidth,r=document.documentElement.clientHeight,a=window.innerWidth,l=window.innerHeight,S=a/t,O="scale("+S+") translateX("+window.pageXOffset/S+"px) translateY("+-(r-(window.pageYOffset+l))/S+"px)";S>.99?(this.$el.removeClass("lrn_scalable"),O=""):this.$el.addClass("lrn_scalable"),this.setTransform(O),this.opts.onUpdate(S)},setTransform:function setTransform(t){return this.$el.css({transform:t,"-moz-transform":t,"-o-transform":t,"-webkit-transform":t,"-ms-transform":t}),this},destroy:function destroy(){this.stop(),this.setTransform("").$el.removeClass("lrn_scalable"),this.$el=this.opts=null}}),r.a=E},176:function(t,r,a){"use strict";var l=a(5),S=a.n(l),O=a(126),L=a.n(O),E=a(129),D=a.n(E),j=a(159);function _extends(){return(_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var B=function(){function CustomDropdown(t,r){var a=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,CustomDropdown),_defineProperty(this,"on",S.a.Events.on),_defineProperty(this,"once",S.a.Events.once),_defineProperty(this,"off",S.a.Events.off),_defineProperty(this,"trigger",S.a.Events.trigger),_defineProperty(this,"_selectedIndex",-1),_defineProperty(this,"_value",null),_defineProperty(this,"_onChange",(function(t){var r=t.index,l=t.value;a._selectedIndex=r,a._value=l,a.trigger("change",{value:l,selectedIndex:r})})),_defineProperty(this,"_onBlur",(function(){a.trigger("blur")})),_defineProperty(this,"_onUpdateComplete",(function(){a.trigger("updateComplete")})),this.el=t,this.menuOptions=r,this.options=l,this._render()}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(CustomDropdown,[{key:"open",value:function open(t){this.component.open(t)}},{key:"close",value:function close(){this.component.close()}},{key:"isOpen",value:function isOpen(){return this.component.isOpen()}},{key:"_render",value:function _render(){var t=this.menuOptions,r=this.options;this.component=D.a.render(L.a.createElement(j.a,_extends({},r,{containerClass:"lrn_theme_primary",menuOptions:t,onChange:this._onChange,onBlur:this._onBlur,updateComplete:this._onUpdateComplete,selectedIndex:this.selectedIndex})),this.el)}},{key:"selectedIndex",get:function get(){return this._selectedIndex},set:function set(t){this._selectedIndex=t,this.component.setSelectedIndex(t)}},{key:"value",get:function get(){return this._value}}]),CustomDropdown}();r.a=B},192:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=["syntax","argument"],L=["stringMatch"];String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),r.a={processSpec:function processSpec(t){var r,a,l;if(S.a.isObject(t)&&"equivSyntax"===t.method)return S.a.isObject(t.options)&&S.a.isString(t.options.syntax)&&""!==t.options.syntax||!t.value?("\\number",l={method:"equivSyntax",value:""},a=t.options.syntax||"\\number",l.value="\\format{"+a,S.a.isNumber(t.options.argument)&&(l.value+="{"+t.options.argument+"}"),l.value+="}",S.a.isBoolean(t.options.ignoreText)&&(l.options={ignoreText:t.options.ignoreText}),l):t;for(r=0;r<O.length;r++)S.a.isObject(t.options)&&!S.a.isUndefined(t.options[O[r]])&&delete t.options[O[r]];return t},useMathCore:function useMathCore(t){return!(S.a.isObject(t)&&-1!==S.a.indexOf(L,t.method))},validate:function validate(t,r){var a,l,O,L,E,D={errorCode:0,location:void 0,message:"Normal completion",result:!1};return S.a.isObject(t)&&S.a.isString(r)&&"stringMatch"===t.method&&S.a.isString(t.value)&&(a=t.value.replace(/\\\s/g," "),l=r.replace(/\\\s/g," "),L=!S.a.isObject(t.options)||S.a.isObject(t.options)&&!1!==t.options.ignoreLeadingAndTrailingSpaces,E=!S.a.isObject(t.options)||S.a.isObject(t.options)&&!1!==t.options.treatMultipleSpacesAsOne,O=S.a.isObject(t.options)&&!0===t.options.inverseResult,L&&(a=a.trim(),l=l.trim()),E&&(a=a.replace(/\s+/g," "),l=l.replace(/\s+/g," ")),D.result=a===l,O&&(D.result=!D.result)),D}}},196:function(t,r,a){"use strict";a.d(r,"d",(function(){return getSpellCheckValue})),a.d(r,"a",(function(){return getAutoCapitalizeValue})),a.d(r,"b",(function(){return getAutoCompleteValue})),a.d(r,"c",(function(){return getAutoCorrectValue}));var l=a(0),S=a.n(l);function getSpellCheckValue(t){return S.a.isBoolean(t)?t:!!S.a.isString(t)&&"true"===t}function getAutoCapitalizeValue(t){return defaultCheck(t)}function getAutoCompleteValue(t){return defaultCheck(t)}function getAutoCorrectValue(t){return defaultCheck(t)}function defaultCheck(t){return S.a.isString(t)?"true"===t?"on":"off":S.a.isBoolean(t)&&t?"on":"off"}},199:function(t,r,a){"use strict";var l=a(1),S=a.n(l),O=a(0),L=a.n(O),E=a(307),D=a.n(E);a(327);function ownKeys(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.push.apply(a,l)}return a}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(a),!0).forEach((function(r){_defineProperty(t,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))}))}return t}function _defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var j=[],B={lineNumbers:!0,language:"javascript",readOnly:!1},q={},G=["<script","</script","<iframe","</iframe","onclick"],X=function transformText(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return G.forEach((function(a){var l=r?a:a.toUpperCase(),S=r?a.toUpperCase():a;t=t.replace(new RegExp(l,"gi"),S)})),t};r.a={parse:function parse(t){var r=S()("<div />").html(t);return r.find('[data-lrn-wysihtml-widget="codeEditorWidget"]').each((function(){var t=S()(this);if(!t.attr("data-lrn-code-editor-id")){var r=L.a.uniqueId();t.attr("data-lrn-code-editor-id",r).attr("contenteditable",!1),j.push(r)}})),r.html()},render:function render(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;L.a.each(j,(function(a){var l=S()('[data-lrn-code-editor-id="'.concat(a,'"]'));if(l.length){var O=l.find("textarea"),E=X(O.val()||"\n\n",!1);O.remove(),q[a]=D()(l.get(0),_objectSpread(_objectSpread({},B),{},{value:E,autofocus:!0,readOnly:t.readOnly})),q[a].on("keyHandled",(function(t,a,S){L.a.isEmpty(t.getValue())&&8===S.which&&(O.remove(),l.remove(),r&&r.focus())}))}})),j=[]},getData:function getData(t){var r=t.getAttribute("data-lrn-code-editor-id"),a=q[r];if(a){var l=S()('<div data-lrn-wysihtml-widget="codeEditorWidget" contenteditable="false"/>'),O=S()("<textarea />"),L=a.getValue();return O.html(L),l.append(O),X(l.get(0).outerHTML,!0)}return""}}},200:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(18),L={jpg:{jpg:"image/jpeg",jpeg:"image/jpeg",jfif:"image/jpeg"},png:"image/png",gif:"image/gif",bmp:"image/bmp",pdf:"application/pdf",csv:"text/csv",rtf:"application/rtf",txt:"text/plain",xps:"application/vnd.ms-xpsdocument",ms_word:{doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docm:"application/vnd.ms-word.document.macroenabled.12",dotm:"application/vnd.ms-word.template.macroenabled.12"},ms_excel:{xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12"},ms_powerpoint:{ppt:"application/vnd.ms-powerpoint",pps:"application/vnd.ms-powerpoint",pot:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",potm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppsm:"application/vnd.ms-powerpoint.slideshow.macroenabled.12"},ms_publisher:{pub:"application/vnd.ms-publisher"},open_office:{odf:"application/vnd.oasis.opendocument.formula",odt:"application/vnd.oasis.opendocument.text",ods:"application/vnd.oasis.opendocument.spreadsheet",odp:"application/vnd.oasis.opendocument.presentation"},video:{mp4:"video/mp4",mov:"video/quicktime",webm:"video/webm",avi:"video/avi",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv"},zip:"application/zip",matlab:{m:"text/plain",fig:"application/octet-stream",mat:"application/octet-stream"},altera_quartus:{bdf:"text/plain",bsf:"text/plain"},verilog:{sv:"text/plain"},c:"text/plain",h:"text/plain",s:"text/plain",v:"text/plain",cpp:"text/plain",assembly:{asm:"text/plain"}},E={createBasePath:function createBasePath(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new Date(t.get("security").getTimestamp()),l=a.getUTCFullYear(),S=new Date(Date.UTC(l,0,1)),O=Math.ceil((a-S)/864e5),L=t.get("consumer"),E=L.get("id"),D=t.get("user_id"),j=r?"userupload/":"";return"".concat(j).concat(E,"/questionresponse/").concat(l,"/").concat(O,"/").concat(E,"_").concat(D)},createFullPath:function createFullPath(t,r,a,l){var S=this.createBasePath(t,l),L=O.a.v4(),E=this.getValidExtension(a);return"".concat(S,"_").concat(r,"/").concat(L,".").concat(E)},getValidExtension:function getValidExtension(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=this.getFlattenedExtensions(),a=t.lastIndexOf(".")+1,l=a>0?t.slice(a).toLowerCase():"";return r[l]?l:""},getFlattenedExtensions:function getFlattenedExtensions(){var t={};return S.a.mapObject(L,(function buildExtensionMime(r,a){S.a.isString(r)?t[a]=r:S.a.isObject(r)&&S.a.mapObject(r,buildExtensionMime)})),t},getExtensions:function getExtensions(t){var r=L[t],a=[];return S.a.isString(r)?a.push(t):S.a.isObject(r)&&(a=S.a.keys(r)),a},getMimeTypeByExtension:function getMimeTypeByExtension(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=this.getFlattenedExtensions(),a=r[t.toLowerCase()];return a||""}};r.a=E},201:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(165);r.a=function getOrderedListBasedOnQuestion(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(!r.shuffle_options)return S.a.deepClone(t);if(!S.a.isString(a))throw new Error("getOrderedListBasedOnQuestion requires a seed");return Object(O.a)({seed:a,exclusions:t,questionMetadata:r.metadata,originalOrder:t})}},205:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(5),L=a.n(O),E=a(208),D=(a(2),a(9),a(6)),j=a(200),B="".concat(D.a.apiHost,"/asset/view"),q="".concat(D.a.apiHost,"/asset/viewProcessed"),G={uploading:"uploading",failed:"failed",complete:"complete"};r.a=L.a.Model.extend({UPLOAD_STATUS:G,initialize:function initialize(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.file,l=r.eventBus,O=r.activity,L=r.securityObject,E=r.hasVideoSupport,D=r.hasVideoRecordingSupport,j=r.assetExtension,B=r.assetMimeType,q=r.assetPath,X=r.responseId;if(this.options=r,this.eventBus=l,this.activity=O,this.securityToken=this._uriEncodeObject(L),this.responseId=X,this.hasVideoSupport=E,this.hasVideoRecordingSupport=D,this.set("id",S.a.uniqueId()),!S.a.isUndefined(a)&&this.validateFile(a)){if(this.file=a,this.set({name:a.name,originalName:a.name,extension:j,size:a.size,mimetype:B||a.type,status:G.uploading,hasUploaded:this.hasUploaded(),description:"",hasFailed:!1,hasNotifiedFailure:!0,assetPath:q}),(D||E)&&this.isVideoFile()){var $=q.substr(0,q.lastIndexOf(".")),Z=this.get("name").substr(0,this.get("name").lastIndexOf("."));this.set({assetProcessedPath:"".concat($,".").concat("mp4"),extension:"mp4",name:"".concat(Z,".").concat("mp4")})}this.uploadAndHandle()}else this.set({status:G.complete,hasUploaded:!0});this.set("colorClass",this.getIconColorClass(this.get("extension")))},validateFile:function validateFile(t){return t instanceof File||t instanceof Blob&&!!t.name},hasUploaded:function hasUploaded(){return this.get("status")===G.complete},upload:function upload(){return E.a.upload({file:this.file,activity:this.activity,responseId:this.responseId,extension:this.get("extension"),mimeType:this.get("mimetype"),assetPath:this.get("assetPath"),assetProcessedPath:this.get("assetProcessedPath"),hasVideoSupport:this.hasVideoSupport})},uploadAndHandle:function uploadAndHandle(){var t=this;return this.upload().then((function(){t.handleUploadSuccess()})).catch((function(){t.handleUploadFail()}))},abortUpload:function abortUpload(){E.a.abort(this.get("assetPath"))},isSubmitPractice:function isSubmitPractice(){return this.options.activity.get("type")===this.activity.TYPE.SUBMIT_PRACTICE},isVideoFile:function isVideoFile(){var t=j.a.getExtensions("video"),r=this.get("extension");return S.a.contains(t,r)},handleUploadSuccess:function handleUploadSuccess(){var t=this.options.onUploadSuccess;this.set({status:G.complete,hasUploaded:!0,hasNotifiedFailure:!0}),S.a.isUndefined(this.eventBus)||this.eventBus.trigger("fileUploaded",this),t&&t()},handleUploadFail:function handleUploadFail(){var t=this.options.onUploadError;this.set({status:G.failed,hasFailed:!0,hasNotifiedFailure:!1}),S.a.isUndefined(this.eventBus)||this.eventBus.trigger("fileUploadFailed",this),t&&t()},getViewUrl:function getViewUrl(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={assetPath:this.get("assetPath")},a=B;this.get("assetProcessedPath")&&(r.assetProcessedPath=this.get("assetProcessedPath"),r.assetOriginalName=this.get("originalName"),a=q),t&&(r.assetName=this.get("name"));var l=this._uriEncodeObject(r);return"".concat(a,"?action=get&security=").concat(this.securityToken,"&usrequest=").concat(l)},retryUpload:function retryUpload(){this.get("hasFailed")&&(this.set({hasFailed:!1,status:G.uploading}),this.uploadAndHandle())},clearFailNotification:function clearFailNotification(){this.set("hasNotifiedFailure",!0)},getIconColorClass:function getIconColorClass(t){var r="default";switch(t){case"png":case"gif":case"pdf":case"csv":case"rtf":case"txt":case"xps":r=t;break;case"jpg":case"jpeg":r="jpg";break;case"doc":case"docx":case"dot":case"dotx":case"docm":case"dotm":r="word";break;case"xls":case"xlsx":case"xlt":case"xltm":case"xlsm":r="excel";break;case"ppt":case"pps":case"pot":case"pptx":case"pptm":case"potx":case"potm":case"ppsx":case"ppsm":r="powerpoint";break;case"pub":r="publisher";break;case"odf":case"odt":case"ods":case"odp":r="open-office";break;case"mp4":case"mov":case"avi":r="video"}return"".concat("lrn-file-").concat(r)},updateDescription:function updateDescription(t){this.set({description:t})},_uriEncodeObject:function _uriEncodeObject(t){return encodeURIComponent(JSON.stringify(t))}})},207:function(t,r,a){"use strict";a(5);var l=a(0),S=a.n(l),O=a(17),L=a.n(O),E=a(52),D=a(217),j=a.n(D),B=a(136);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=_getPrototypeOf(t);if(r){var S=_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var q=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(ClozeAssociationScorer,t);var r=_createSuper(ClozeAssociationScorer);function ClozeAssociationScorer(){return _classCallCheck(this,ClozeAssociationScorer),r.apply(this,arguments)}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(ClozeAssociationScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ClozeAssociationScorer}(B.a);function clozeinlinetext_scoring_typeof(t){return(clozeinlinetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozeinlinetext_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function clozeinlinetext_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function clozeinlinetext_scoring_setPrototypeOf(t,r){return(clozeinlinetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function clozeinlinetext_scoring_createSuper(t){var r=function clozeinlinetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=clozeinlinetext_scoring_getPrototypeOf(t);if(r){var S=clozeinlinetext_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return clozeinlinetext_scoring_possibleConstructorReturn(this,a)}}function clozeinlinetext_scoring_possibleConstructorReturn(t,r){return!r||"object"!==clozeinlinetext_scoring_typeof(r)&&"function"!=typeof r?function clozeinlinetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function clozeinlinetext_scoring_getPrototypeOf(t){return(clozeinlinetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var G=function(t){!function clozeinlinetext_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&clozeinlinetext_scoring_setPrototypeOf(t,r)}(ClozeInlinetextScorer,t);var r=clozeinlinetext_scoring_createSuper(ClozeInlinetextScorer);function ClozeInlinetextScorer(){return clozeinlinetext_scoring_classCallCheck(this,ClozeInlinetextScorer),r.apply(this,arguments)}return function clozeinlinetext_scoring_createClass(t,r,a){return r&&clozeinlinetext_scoring_defineProperties(t.prototype,r),a&&clozeinlinetext_scoring_defineProperties(t,a),t}(ClozeInlinetextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!0}}}]),ClozeInlinetextScorer}(B.a);function clozedropdown_scoring_typeof(t){return(clozedropdown_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozedropdown_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function clozedropdown_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function clozedropdown_scoring_setPrototypeOf(t,r){return(clozedropdown_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function clozedropdown_scoring_createSuper(t){var r=function clozedropdown_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=clozedropdown_scoring_getPrototypeOf(t);if(r){var S=clozedropdown_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return clozedropdown_scoring_possibleConstructorReturn(this,a)}}function clozedropdown_scoring_possibleConstructorReturn(t,r){return!r||"object"!==clozedropdown_scoring_typeof(r)&&"function"!=typeof r?function clozedropdown_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function clozedropdown_scoring_getPrototypeOf(t){return(clozedropdown_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var X=function(t){!function clozedropdown_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&clozedropdown_scoring_setPrototypeOf(t,r)}(ClozeDropdownScorer,t);var r=clozedropdown_scoring_createSuper(ClozeDropdownScorer);function ClozeDropdownScorer(){return clozedropdown_scoring_classCallCheck(this,ClozeDropdownScorer),r.apply(this,arguments)}return function clozedropdown_scoring_createClass(t,r,a){return r&&clozedropdown_scoring_defineProperties(t.prototype,r),a&&clozedropdown_scoring_defineProperties(t,a),t}(ClozeDropdownScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1,strictEquality:!0,trimWhiteSpace:!0}}}]),ClozeDropdownScorer}(B.a);function clozetext_scoring_typeof(t){return(clozetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function clozetext_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function clozetext_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function clozetext_scoring_setPrototypeOf(t,r){return(clozetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function clozetext_scoring_createSuper(t){var r=function clozetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=clozetext_scoring_getPrototypeOf(t);if(r){var S=clozetext_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return clozetext_scoring_possibleConstructorReturn(this,a)}}function clozetext_scoring_possibleConstructorReturn(t,r){return!r||"object"!==clozetext_scoring_typeof(r)&&"function"!=typeof r?function clozetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function clozetext_scoring_getPrototypeOf(t){return(clozetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $=function(t){!function clozetext_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&clozetext_scoring_setPrototypeOf(t,r)}(ClozeTextScorer,t);var r=clozetext_scoring_createSuper(ClozeTextScorer);function ClozeTextScorer(){return clozetext_scoring_classCallCheck(this,ClozeTextScorer),r.apply(this,arguments)}return function clozetext_scoring_createClass(t,r,a){return r&&clozetext_scoring_defineProperties(t.prototype,r),a&&clozetext_scoring_defineProperties(t,a),t}(ClozeTextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!0}}}]),ClozeTextScorer}(B.a);function imageclozeassociation_scoring_typeof(t){return(imageclozeassociation_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozeassociation_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function imageclozeassociation_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function imageclozeassociation_scoring_setPrototypeOf(t,r){return(imageclozeassociation_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function imageclozeassociation_scoring_createSuper(t){var r=function imageclozeassociation_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=imageclozeassociation_scoring_getPrototypeOf(t);if(r){var S=imageclozeassociation_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return imageclozeassociation_scoring_possibleConstructorReturn(this,a)}}function imageclozeassociation_scoring_possibleConstructorReturn(t,r){return!r||"object"!==imageclozeassociation_scoring_typeof(r)&&"function"!=typeof r?function imageclozeassociation_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function imageclozeassociation_scoring_getPrototypeOf(t){return(imageclozeassociation_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Z=function(t){!function imageclozeassociation_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&imageclozeassociation_scoring_setPrototypeOf(t,r)}(ImageClozeAssociationScorer,t);var r=imageclozeassociation_scoring_createSuper(ImageClozeAssociationScorer);function ImageClozeAssociationScorer(){return imageclozeassociation_scoring_classCallCheck(this,ImageClozeAssociationScorer),r.apply(this,arguments)}return function imageclozeassociation_scoring_createClass(t,r,a){return r&&imageclozeassociation_scoring_defineProperties(t.prototype,r),a&&imageclozeassociation_scoring_defineProperties(t,a),t}(ImageClozeAssociationScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeAssociationScorer}(B.a);function imageclozedropdown_scoring_typeof(t){return(imageclozedropdown_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozedropdown_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function imageclozedropdown_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function imageclozedropdown_scoring_setPrototypeOf(t,r){return(imageclozedropdown_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function imageclozedropdown_scoring_createSuper(t){var r=function imageclozedropdown_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=imageclozedropdown_scoring_getPrototypeOf(t);if(r){var S=imageclozedropdown_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return imageclozedropdown_scoring_possibleConstructorReturn(this,a)}}function imageclozedropdown_scoring_possibleConstructorReturn(t,r){return!r||"object"!==imageclozedropdown_scoring_typeof(r)&&"function"!=typeof r?function imageclozedropdown_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function imageclozedropdown_scoring_getPrototypeOf(t){return(imageclozedropdown_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Q=function(t){!function imageclozedropdown_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&imageclozedropdown_scoring_setPrototypeOf(t,r)}(ImageClozeDropdownScorer,t);var r=imageclozedropdown_scoring_createSuper(ImageClozeDropdownScorer);function ImageClozeDropdownScorer(){return imageclozedropdown_scoring_classCallCheck(this,ImageClozeDropdownScorer),r.apply(this,arguments)}return function imageclozedropdown_scoring_createClass(t,r,a){return r&&imageclozedropdown_scoring_defineProperties(t.prototype,r),a&&imageclozedropdown_scoring_defineProperties(t,a),t}(ImageClozeDropdownScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeDropdownScorer}(B.a);function imageclozetext_scoring_typeof(t){return(imageclozetext_scoring_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function imageclozetext_scoring_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function imageclozetext_scoring_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function imageclozetext_scoring_setPrototypeOf(t,r){return(imageclozetext_scoring_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function imageclozetext_scoring_createSuper(t){var r=function imageclozetext_scoring_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=imageclozetext_scoring_getPrototypeOf(t);if(r){var S=imageclozetext_scoring_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return imageclozetext_scoring_possibleConstructorReturn(this,a)}}function imageclozetext_scoring_possibleConstructorReturn(t,r){return!r||"object"!==imageclozetext_scoring_typeof(r)&&"function"!=typeof r?function imageclozetext_scoring_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function imageclozetext_scoring_getPrototypeOf(t){return(imageclozetext_scoring_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ee=function(t){!function imageclozetext_scoring_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&imageclozetext_scoring_setPrototypeOf(t,r)}(ImageClozeTextScorer,t);var r=imageclozetext_scoring_createSuper(ImageClozeTextScorer);function ImageClozeTextScorer(){return imageclozetext_scoring_classCallCheck(this,ImageClozeTextScorer),r.apply(this,arguments)}return function imageclozetext_scoring_createClass(t,r,a){return r&&imageclozetext_scoring_defineProperties(t.prototype,r),a&&imageclozetext_scoring_defineProperties(t,a),t}(ImageClozeTextScorer,[{key:"flags",get:function get(){return{stripWhiteSpaceForMath:!1}}}]),ImageClozeTextScorer}(B.a),te=a(4),ne=a(155);r.a=E.a.extend({imageTemplate:j.a,RESPONSE_MARKER_REGEXP:"{{response}}",initialize:function initialize(){E.a.prototype.initialize.apply(this,arguments),this.updateValidationObject()},validateStartup:function validateStartup(){E.a.prototype.validateStartup.call(this),this.get("question").template&&(this.get("question").template=L.a.sanitizeHTML(this.get("question").template))},processResponseValue:function processResponseValue(t){this.hasResponse()||this.set({response:{value:[],type:this.RESPONSE_TYPE.ARRAY}},{silent:!0}),this.get("response").value=t},isDefaultValidResponseValue:function isDefaultValidResponseValue(t){return 0===S.a.filter(t,(function(t){return t||0===t})).length},getScorerClass:function getScorerClass(){var t,r=this.TYPE;switch(this.get("type")){case r.CLOZETEXT:t=$;break;case r.CLOZEASSOCIATION:t=q;break;case r.CLOZEDROPDOWN:t=X;break;case r.CLOZEINLINETEXT:t=G;break;case r.IMAGECLOZEASSOCIATION:t=Z;break;case r.IMAGECLOZEDROPDOWN:t=Q;break;case r.IMAGECLOZETEXT:t=ee}return t},validateResponse:function validateResponse(){var t=this.getScorer(),r=t.error();if(!r)return t.validateIndividualResponses();if("MathQuestionException"!==r.name)throw r;"user"!==r.location&&te.a.exception({code:10019,detail:r.message,i18n:this.activity.get("i18n")})},isImageCloze:function isImageCloze(){var t=this.TYPE;return S.a.include([t.IMAGECLOZETEXT,t.IMAGECLOZEASSOCIATION,t.IMAGECLOZEDROPDOWN,t.IMAGECLOZEFORMULA,t.IMAGECLOZECHEMISTRY],this.get("type"))},getDynamicShuffleSeed:function getDynamicShuffleSeed(){return new ne.a(this).getDynamicSeed()},getContentTemplate:function getContentTemplate(){if(this.isImageCloze()){var t=j.a,r=this.get("question"),a={img_alt:!!r.img_alt&&r.img_alt,img_title:!!r.img_title&&r.img_title,img_src:r.img_src,response_positions:r.response_positions,response_container:r.response_container,padding:!!r.padding&&r.padding,question_type:this.get("type")};return r.image&&(r.image.src&&(a.img_src=r.image.src),r.image.alt&&(a.img_alt=r.image.alt),r.image.title&&(a.img_title=r.image.title)),t({displayLogic:a})}return this.get("question").template},getImageClozeAriaLabels:function getImageClozeAriaLabels(){if(this.isImageCloze())return S.a.isUndefined(this._ariaLabels)&&(this._ariaLabels=S.a.map(this.get("question").aria_labels,(function(t){return S.a.escape(t)}))),this._ariaLabels},updateValidationObject:function updateValidationObject(){var t=this.get("question");if(t.hasOwnProperty("valid_responses")){var r,a,l,O=[],L=[],E=!0;S.a.each(t.valid_responses,(function(t,D){O[D]=[],L[D]=[],S.a.each(t,(function(t,j){a=S.a.isUndefined(t.value)?null:t.value,null!==(l=S.a.isUndefined(t.score)?null:t.score)&&(l=parseInt(l,10)),O[D].push(a),L[D].push(l),S.a.isUndefined(r)?r=l:E&=r===l}))})),delete t.valid_responses,t.validation={valid_responses:O},r=E?r:L,S.a.isNull(r)||(t.validation.valid_score=r),this.set({question:t},{silent:!0}),this.trackEvent("Updated pre v1.24.0 question object.")}},getCorrectByIndex:function getCorrectByIndex(t){if(this.canValidateResponse())return this.getValidResponse().value[t]},isVerticalTopContainer:function isVerticalTopContainer(){return S.a.isUndefined(this._verticalTop)&&(this._verticalTop=!!this.isImageCloze()&&!!S.a.getNested(this.get("question"),"response_container.vertical_top")),this._verticalTop},getIgnoreLeadingAndTrailingSpaces:function getIgnoreLeadingAndTrailingSpaces(){var t=this.get("question").ignore_leading_and_trailing_spaces;return!S.a.isBoolean(t)||t}})},208:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=(a(244),a(2)),L=(a(18),a(9));function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}var E=function(){function S3(){var t=this;!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,S3),this.promise=new O.default((function(r,a){t.resolve=r,t.reject=a}))}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(S3,[{key:"request",value:function request(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.send(t),this.promise}},{key:"handleSuccess",value:function handleSuccess(t){t.target.status<400?this.resolve(t):this.handleFailure(t)}},{key:"handleFailure",value:function handleFailure(t){this.reject(t.target.status)}},{key:"send",value:function send(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=new FormData,l=r.data.data.file,O="".concat(r.data.data.name,".").concat(r.data.data.extension),L=new XMLHttpRequest,E=l.slice(0,l.size,l.type),D=0;S.a.each(r.formInputs,(function(t,r){a.append(r,t)})),a.append("file",E,O),L.addEventListener("load",(function(r){t.handleSuccess(r)})),L.addEventListener("error",(function(r){t.handleFailure(r)})),L.upload.addEventListener("progress",(function(t){D=t.loaded})),L.open(r.formAttributes.method,r.formAttributes.action),L.send(a),r.onSendStart&&r.onSendStart({abort:function abort(){return L.abort()},getUploadedBytes:function getUploadedBytes(){return D}})}}]),S3}(),D=a(7),j=(D.a.isMicrosoft,[]),B=[],q=!1,G=[],X={MAX_ATTEMPTS:3,RETRY_DELAY:8e3,upload:function upload(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.validate(r);var a=r.activity,l=r.extension,S=r.file,L=r.assetPath,E=r.mimeType,D=a.get("security"),j={extension:l,file:S,assetPath:L,mimeType:E};return new O.default((function(r,a){var l={security:D.getRequestParameters(),data:j,success:function success(){t.removeFromQueue(l),t.resumeQueue(),r(j)},failure:function failure(r){t.removeFromQueue(l),t.resumeQueue(),a(r)}};t.addToQueue(l)}))},validate:function validate(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.file)throw new Error("FileUpload missing file");if(!S.a.isObject(t.activity))throw new Error("FileUpload missing activity");if(!S.a.isString(t.responseId))throw new Error("FileUpload missing responseId");if(!S.a.isString(t.extension))throw new Error("FileUpload missing file extension")},addToQueue:function addToQueue(t){if(this.getQueueItem(t.data.assetPath))throw new Error("Attempting to add duplicate assetPath to upload queue: ".concat(t.data.assetPath));G.push({config:t,isProcessing:!1,attempts:0}),this.processQueue()},abort:function abort(t){var r=this.getQueueItem(t);if(r){var a=r.config.s3Upload;a&&a.abort(),this.removeFromQueue(r),r.isProcessing&&this.resumeQueue()}},removeFromQueue:function removeFromQueue(t){clearTimeout(t.retryTimeoutId),G=S.a.filter(G,(function(r){return t.data.assetPath!==r.config.data.assetPath}))},resumeQueue:function resumeQueue(){q=!1,this.processQueue()},processQueue:function processQueue(){if(!q){var t=S()(G).find((function(t){return!t.isProcessing}));t&&this.processQueueItem(t)}},processQueueItem:function processQueueItem(t){var r=this,a=t.config,l=a.data,O=l.assetPath,E=l.mimeType;S.a.contains(G,t)&&(q=!0,t.isProcessing=!0,t.attempts++,L.a.request({url:"/asset/uploadform",security:a.security,action:L.a.ACTION.GET,data:{assetPath:O,mimeType:E},success:function success(a){r.handleTokenSuccess(t,a)},failure:function failure(){r.handleFailure(t)}}))},handleTokenSuccess:function handleTokenSuccess(t,r){var a=this,l=t.config;if(S.a.contains(G,t)){var O=new E;S.a.getNested(r,"response.data")?O.request({formAttributes:r.response.data.formAttributes,formInputs:r.response.data.formInputs,data:l,onSendStart:function onSendStart(t){l.s3Upload=t}}).then((function(){l.success()})).catch((function(){a.handleFailure(t)})):this.handleFailure(t)}},handleFailure:function handleFailure(t){var r=this;t.attempts<this.MAX_ATTEMPTS?(clearTimeout(t.retryTimeoutId),t.retryTimeoutId=setTimeout((function(){return r.processQueueItem(t)}),this.RETRY_DELAY)):t.config.failure.call(null,"Could not upload after ".concat(this.MAX_ATTEMPTS," attempts"))},isSafeToUnload:function isSafeToUnload(){var t=S.a.find(G,(function(t){return t.isProcessing}));return!q&&!t},isAssetPathInQueue:function isAssetPathInQueue(t){return S.a.some(G,(function(r){return r.config.data.assetPath===t}))},getQueueItem:function getQueueItem(t){return S()(G).find((function(r){return t===r.config.data.assetPath}))},getUploadStatus:function getUploadStatus(){var t=0,r=0;return S.a.each(B,(function(a){a.each((function(a){r+=a.get("size"),a.get("hasUploaded")&&(t+=a.get("size"))}))})),G.forEach((function(r){var a=r.config.s3Upload;a&&(t+=a.getUploadedBytes())})),{uploadComplete:this.isSafeToUnload(),totalBytes:r,bytesUploaded:t}},hookToActivity:function hookToActivity(t,r){S.a.contains(B,r)||B.push(r),S.a.isEmpty(t)||S.a.contains(j,t)||(t.hooks.unload.push(this.isSafeToUnload),t.hooks.saveProgress.push(S.a.bind(this.getUploadStatus,this)),j.push(t))}};r.a=X},212:function(t,r,a){"use strict";a.d(r,"a",(function(){return applySelectiveFontBoost}));var l=a(235),S=a.n(l);function applySelectiveFontBoost(t,r){t&&!r&&S.a.isWindows&&[].slice.call(t.querySelectorAll(".mq-math-mode span")).filter((function(t){return"−"===t.textContent})).forEach((function(t){t.style.fontSize="120%"}))}},217:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_imagecloze_container"'+(null==(__t=displayLogic.padding?' style="padding: '+displayLogic.padding+'px"':"")?"":__t)+' ><img draggable="false"',displayLogic.img_alt&&(__p+='alt="'+(null==(__t=displayLogic.img_alt)?"":_.escape(__t))+'"'),__p+="",displayLogic.img_title&&(__p+='title="'+(null==(__t=displayLogic.img_title)?"":_.escape(__t))+'"'),__p+='class="lrn_imagecloze_image"src="'+(null==(__t=displayLogic.img_src)?"":_.escape(__t))+'">',_.each(displayLogic.response_positions,(function(t){__p+='<div class="lrn_imagecloze_response" style="left:'+(null==(__t=t.x)?"":__t)+"%;top:"+(null==(__t=t.y)?"":__t)+"%;",displayLogic.response_container&&"imageclozeassociation"===displayLogic.question_type&&(__p+="",displayLogic.response_container.hasOwnProperty("height")&&(__p+="height:"+(null==(__t=displayLogic.response_container.height)?"":__t)+";"),__p+=""),__p+='">{{response}}</div>'})),__p+="</div>";return __p}},234:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(5),L=a.n(O),E=a(205);r.a=L.a.Collection.extend({model:E.a,comparator:"name",ATTRS_FOR_RESPONSE:["name","description","originalName","extension","size","assetPath","assetProcessedPath"],getResponseValueFormat:function getResponseValueFormat(){var t=this,r=this.where({hasUploaded:!0});return S()(r).map((function(r){return r.pick(t.ATTRS_FOR_RESPONSE)}))}})},235:function(t,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=navigator.userAgent.toLowerCase(),S=l.match(/(opera|ie|edge|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],O=S[1],L=parseInt(S[2],10),E="ie"===O&&L<8&&/trident/i.test(l),D=!!l.match(/android|webos|iphone|ipad|ipod|blackBerry|windows phone|opera mini|iemobile/i),j=!!l.match(/applewebkit/),B=/^((?!android|chrome).)*safari/i.test(navigator.userAgent),q=!(!window.chrome||!window.chrome.runtime||"[object Function]"!==Object.prototype.toString.call(window.chrome.runtime.getManifest)),G=!!navigator.platform&&["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,X=l.match(/(iPad)/)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;l.match(/trident.*rv[ :]*11\./)&&(O="ie",L=11),l.match(/edge/)&&(O="edge"),"version"===O&&(O=S[3]);var $={browser:O,version:L,compatibilityMode:E,isMobile:D,isChromeApp:q,isAppleWebKit:j,isValidDOCTYPE:function isValidDOCTYPE(t){return!(!t||!t.doctype||"html"!==t.doctype.name)},isIOS:G,isIPad:X,isMicrosoft:"ie"===O||"edge"===O,isWindows:!(!window.navigator||!window.navigator.platform)&&["Windows","Win32","Win64","WinCE"].indexOf(window.navigator.platform)>-1,isSafari:B};r.default=$},243:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(208),L=a(205),E=a(234),D=a(200),j=a(262);function ownKeys(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.push.apply(a,l)}return a}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(a),!0).forEach((function(r){_defineProperty(t,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))}))}return t}function _defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var B=-90,q=-180,G=-270;function getImageConversionOrientation(t){return t===B?8:t===q?3:t===G?6:void 0}function ImageUploader(t){this.activity=t.activity,this.modelId=t.modelId,this.responseId=t.responseId,this.eventBus=t.eventBus,this.compression=t.compression,this.assets=new E.a,O.a.hookToActivity(this.activity,this.assets)}S.a.extend(ImageUploader.prototype,{compressImage:function compressImage(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=S.a.extend(this.compression,r);var a=.001*Math.min(t.size,r.size),l=parseInt(a-Math.max(.1*a,1),10),O=_objectSpread(_objectSpread({},r),{},{size:Math.abs(l),orientation:getImageConversionOrientation(r.rotation)});return delete O.rotation,j.compressAccurately(t,O).then((function(r){return r.name=t.name,r.lastModified=t.lastModified,r.lastModifiedDate=t.lastModifiedDate,r}))},upload:function upload(t){var r=D.a.createFullPath(this.activity,this.modelId,t.name,!0),a=D.a.getValidExtension(t.name),l=D.a.getMimeTypeByExtension(a);return this.assets.add({file:t},{assetPath:r,assetExtension:a,assetMimeType:l,activity:this.activity,responseId:this.responseId,eventBus:this.eventBus,securityObject:this.getSecurityObject()})},resume:function resume(t){return this.assets.add({assetPath:t},{securityObject:this.getSecurityObject()})},getSecurityObject:function getSecurityObject(){return this.activity.get("security").getRequestParameters()},currentUploadsCount:function currentUploadsCount(){return this.assets.where({status:L.a.prototype.UPLOAD_STATUS.uploading}).length}}),r.a=ImageUploader},244:function(t,r,a){"use strict";r.a={encode:function base64_encode(t){var r,a,l,S,O,L,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",D=0,j=0,B="",q=[];if(!t)return t;do{r=(O=t.charCodeAt(D++)<<16|t.charCodeAt(D++)<<8|t.charCodeAt(D++))>>18&63,a=O>>12&63,l=O>>6&63,S=63&O,q[j++]=E.charAt(r)+E.charAt(a)+E.charAt(l)+E.charAt(S)}while(D<t.length);return B=q.join(""),((L=t.length%3)?B.slice(0,L-3):B)+"===".slice(L||3)},decode:function base64_decode(t){var r,a,l,S,O,L,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",D=0,j=0,B=[];if(!t)return t;t+="";do{r=(L=E.indexOf(t.charAt(D++))<<18|E.indexOf(t.charAt(D++))<<12|(S=E.indexOf(t.charAt(D++)))<<6|(O=E.indexOf(t.charAt(D++))))>>16&255,a=L>>8&255,l=255&L,B[j++]=64===S?String.fromCharCode(r):64===O?String.fromCharCode(r,a):String.fromCharCode(r,a,l)}while(D<t.length);return B.join("")}}},246:function(t,r,a){"use strict";a.d(r,"a",(function(){return mathAccessibility}));var l=a(0),S=a.n(l);function mathAccessibility(t,r){t.processAccessibility=S.a.wrap(t.processAccessibility,(function(r,a){(a=a||{}).getSourceText=function(t){return t.find(".lrn-spokenmath").text()},r.call(t,a)})),t.activity.get("state")===t.activity.STATE.REVIEW&&(t.processAccessibility=S.a.wrap(t.processAccessibility,(function(a,l){var O=r(),L=0;S.a.each(O,(function(r){var S=r.mathEvents;t.listenToOnce(S,S.EVENT.EDITOR_SPOKENMATH_UPDATED,(function(){++L===O.length&&a.call(t,l)}))}))})))}},262:function(t,r,a){const l=a(0);t.exports=function(t){var r={};function n(a){if(r[a])return r[a].exports;var l=r[a]={i:a,l:!1,exports:{}};return t[a].call(l.exports,l,l.exports,n),l.l=!0,l.exports}return n.m=t,n.c=r,n.d=function(t,r,a){n.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,r){if(1&r&&(t=n(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var l in t)n.d(a,l,function(r){return t[r]}.bind(null,l));return a},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="",n(n.s=0)}([function(t,r,a){"use strict";var S;function o(t){return["image/png","image/jpeg","image/gif"].some((function(r){return r===t}))}function u(t,r,a){return void 0===r&&(r=.92),void 0===a&&(a=S.JPEG),function(t,r,a,l){return new(a||(a=Promise))((function(S,O){function i(t){try{c(l.next(t))}catch(t){O(t)}}function u(t){try{c(l.throw(t))}catch(t){O(t)}}function c(t){var r;t.done?S(t.value):(r=t.value,r instanceof a?r:new a((function(t){t(r)}))).then(i,u)}c((l=l.apply(t,r||[])).next())}))}(this,void 0,void 0,(function(){return function(t,r){var a,l,S,O,L={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return O={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(O[Symbol.iterator]=function(){return this}),O;function u(O){return function(E){return function(O){if(a)throw new TypeError("Generator is already executing.");for(;L;)try{if(a=1,l&&(S=2&O[0]?l.return:O[0]?l.throw||((S=l.return)&&S.call(l),0):l.next)&&!(S=S.call(l,O[1])).done)return S;switch(l=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return L.label++,{value:O[1],done:!1};case 5:L.label++,l=O[1],O=[0];continue;case 7:O=L.ops.pop(),L.trys.pop();continue;default:if(!((S=(S=L.trys).length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){L=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){L.label=O[1];break}if(6===O[0]&&L.label<S[1]){L.label=S[1],S=O;break}if(S&&L.label<S[2]){L.label=S[2],L.ops.push(O);break}S[2]&&L.ops.pop(),L.trys.pop();continue}O=r.call(t,L)}catch(t){O=[6,t],l=0}finally{a=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,E])}}}(this,(function(l){return o(a)||(a=S.JPEG),[2,t.toDataURL(a,r)]}))}))}function c(t,r,a){return void 0===r&&(r=.92),void 0===a&&(a=S.JPEG),new Promise((function(l){return t.toBlob((function(t){return l(t)}),a,r)}))}function f(t,r){return function(t,r,a,l){return new(a||(a=Promise))((function(S,O){function i(t){try{c(l.next(t))}catch(t){O(t)}}function u(t){try{c(l.throw(t))}catch(t){O(t)}}function c(t){var r;t.done?S(t.value):(r=t.value,r instanceof a?r:new a((function(t){t(r)}))).then(i,u)}c((l=l.apply(t,r||[])).next())}))}(this,void 0,void 0,(function(){var a,l,S,O,L;return function(t,r){var a,l,S,O,L={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return O={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(O[Symbol.iterator]=function(){return this}),O;function u(O){return function(E){return function(O){if(a)throw new TypeError("Generator is already executing.");for(;L;)try{if(a=1,l&&(S=2&O[0]?l.return:O[0]?l.throw||((S=l.return)&&S.call(l),0):l.next)&&!(S=S.call(l,O[1])).done)return S;switch(l=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return L.label++,{value:O[1],done:!1};case 5:L.label++,l=O[1],O=[0];continue;case 7:O=L.ops.pop(),L.trys.pop();continue;default:if(!((S=(S=L.trys).length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){L=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){L.label=O[1];break}if(6===O[0]&&L.label<S[1]){L.label=S[1],S=O;break}if(S&&L.label<S[2]){L.label=S[2],L.ops.push(O);break}S[2]&&L.ops.pop(),L.trys.pop();continue}O=r.call(t,L)}catch(t){O=[6,t],l=0}finally{a=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,E])}}}(this,(function(E){for(a=t.split(","),l=a[0].match(/:(.*?);/)[1],S=atob(a[1]),O=S.length,L=new Uint8Array(O);O--;)L[O]=S.charCodeAt(O);return o(r)&&(l=r),[2,new Blob([L],{type:l})]}))}))}function h(t){return new Promise((function(r,a){var l=new Image;l.onload=function(){return r(l)},l.onerror=function(){return a(new Error("dataURLtoImage(): dataURL is illegal"))},l.src=t}))}function d(t,r){var a=document.createElement("a");a.href=window.URL.createObjectURL(t),a.download=r||Date.now().toString(36),document.body.appendChild(a);var l=document.createEvent("MouseEvents");l.initEvent("click",!1,!1),a.dispatchEvent(l),document.body.removeChild(a)}function p(t){return new Promise((function(r){var a=new FileReader;a.onloadend=function(t){return r(t.target.result)},a.readAsDataURL(t)}))}a.r(r),a.d(r,"canvastoDataURL",(function(){return u})),a.d(r,"canvastoFile",(function(){return c})),a.d(r,"dataURLtoFile",(function(){return f})),a.d(r,"dataURLtoImage",(function(){return h})),a.d(r,"downloadFile",(function(){return d})),a.d(r,"filetoDataURL",(function(){return p})),a.d(r,"imagetoCanvas",(function(){return g})),a.d(r,"urltoBlob",(function(){return v})),a.d(r,"urltoImage",(function(){return m})),a.d(r,"compress",(function(){return k})),a.d(r,"compressAccurately",(function(){return I})),a.d(r,"EImageType",(function(){return S})),function(t){t.PNG="image/png",t.JPEG="image/jpeg",t.GIF="image/gif"}(S||(S={}));var b=function(){return(b=l.extend||function(t){for(var r,a=1,l=arguments.length;a<l;a++)for(var S in r=arguments[a])Object.prototype.hasOwnProperty.call(r,S)&&(t[S]=r[S]);return t}).apply(this,arguments)};function g(t,r){return void 0===r&&(r={}),function(t,r,a,l){return new(a||(a=Promise))((function(S,O){function i(t){try{c(l.next(t))}catch(t){O(t)}}function u(t){try{c(l.throw(t))}catch(t){O(t)}}function c(t){var r;t.done?S(t.value):(r=t.value,r instanceof a?r:new a((function(t){t(r)}))).then(i,u)}c((l=l.apply(t,r||[])).next())}))}(this,void 0,void 0,(function(){var a,l,S,O,L,E,D;return function(t,r){var a,l,S,O,L={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return O={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(O[Symbol.iterator]=function(){return this}),O;function u(O){return function(E){return function(O){if(a)throw new TypeError("Generator is already executing.");for(;L;)try{if(a=1,l&&(S=2&O[0]?l.return:O[0]?l.throw||((S=l.return)&&S.call(l),0):l.next)&&!(S=S.call(l,O[1])).done)return S;switch(l=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return L.label++,{value:O[1],done:!1};case 5:L.label++,l=O[1],O=[0];continue;case 7:O=L.ops.pop(),L.trys.pop();continue;default:if(!((S=(S=L.trys).length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){L=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){L.label=O[1];break}if(6===O[0]&&L.label<S[1]){L.label=S[1],S=O;break}if(S&&L.label<S[2]){L.label=S[2],L.ops.push(O);break}S[2]&&L.ops.pop(),L.trys.pop();continue}O=r.call(t,L)}catch(t){O=[6,t],l=0}finally{a=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,E])}}}(this,(function(j){for(E in a=b({},r),l=document.createElement("canvas"),S=l.getContext("2d"),a)Object.prototype.hasOwnProperty.call(a,E)&&(a[E]=Number(a[E]));switch(a.scale?(D=a.scale>0&&a.scale<10?a.scale:1,L=t.width*D,O=t.height*D):(L=a.width||a.height*t.width/t.height||t.width,O=a.height||a.width*t.height/t.width||t.height),[5,6,7,8].some((function(t){return t===a.orientation}))?(l.height=L,l.width=O):(l.height=O,l.width=L),a.orientation){case 3:S.rotate(180*Math.PI/180),S.drawImage(t,-l.width,-l.height,l.width,l.height);break;case 6:S.rotate(90*Math.PI/180),S.drawImage(t,0,-l.width,l.height,l.width);break;case 8:S.rotate(270*Math.PI/180),S.drawImage(t,-l.height,0,l.height,l.width);break;case 2:S.translate(l.width,0),S.scale(-1,1),S.drawImage(t,0,0,l.width,l.height);break;case 4:S.translate(l.width,0),S.scale(-1,1),S.rotate(180*Math.PI/180),S.drawImage(t,-l.width,-l.height,l.width,l.height);break;case 5:S.translate(l.width,0),S.scale(-1,1),S.rotate(90*Math.PI/180),S.drawImage(t,0,-l.width,l.height,l.width);break;case 7:S.translate(l.width,0),S.scale(-1,1),S.rotate(270*Math.PI/180),S.drawImage(t,-l.height,0,l.height,l.width);break;default:S.drawImage(t,0,0,l.width,l.height)}return[2,l]}))}))}function v(t){return fetch(t).then((function(t){return t.blob()}))}function m(t){return new Promise((function(r,a){var l=new Image;l.onload=function(){return r(l)},l.onerror=function(){return a(new Error("urltoImage(): Image failed to load, please check the image URL"))},l.src=t}))}var x=function(t,r,a,l){return new(a||(a=Promise))((function(S,O){function i(t){try{c(l.next(t))}catch(t){O(t)}}function u(t){try{c(l.throw(t))}catch(t){O(t)}}function c(t){var r;t.done?S(t.value):(r=t.value,r instanceof a?r:new a((function(t){t(r)}))).then(i,u)}c((l=l.apply(t,r||[])).next())}))},P=function(t,r){var a,l,S,O,L={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return O={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(O[Symbol.iterator]=function(){return this}),O;function u(O){return function(E){return function(O){if(a)throw new TypeError("Generator is already executing.");for(;L;)try{if(a=1,l&&(S=2&O[0]?l.return:O[0]?l.throw||((S=l.return)&&S.call(l),0):l.next)&&!(S=S.call(l,O[1])).done)return S;switch(l=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return L.label++,{value:O[1],done:!1};case 5:L.label++,l=O[1],O=[0];continue;case 7:O=L.ops.pop(),L.trys.pop();continue;default:if(!((S=(S=L.trys).length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){L=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){L.label=O[1];break}if(6===O[0]&&L.label<S[1]){L.label=S[1],S=O;break}if(S&&L.label<S[2]){L.label=S[2],L.ops.push(O);break}S[2]&&L.ops.pop(),L.trys.pop();continue}O=r.call(t,L)}catch(t){O=[6,t],l=0}finally{a=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,E])}}};function k(t,r){return void 0===r&&(r={}),x(this,void 0,void 0,(function(){var a,O,L,E;return P(this,(function(D){switch(D.label){case 0:if(!(t instanceof Blob))throw new Error("compress(): First arg must be a Blob object or a File object.");return"object"!=typeof r&&(r=l.extend({quality:r})),r.quality=Number(r.quality),l.isNaN(r.quality)?[2,t]:[4,p(t)];case 1:return a=D.sent(),O=a.split(",")[0].match(/:(.*?);/)[1],L=S.JPEG,o(r.type)&&(L=r.type,O=r.type),[4,h(a)];case 2:return[4,g(D.sent(),l.extend({},r))];case 3:return[4,u(D.sent(),r.quality,L)];case 4:return[4,f(D.sent(),O)];case 5:return(E=D.sent()).size>t.size?[2,t]:[2,E]}}))}))}function I(t,r){return void 0===r&&(r={}),x(this,void 0,void 0,(function(){var a,O,L,E,D,j,B,q,G,X,$,Z;return P(this,(function(Q){switch(Q.label){case 0:if(!(t instanceof Blob))throw new Error("compressAccurately(): First arg must be a Blob object or a File object.");return"object"!=typeof r&&(r=l.extend({size:r})),r.size=Number(r.size),l.isNaN(r.size)||1024*r.size>t.size?[2,t]:(r.accuracy=Number(r.accuracy),(!r.accuracy||r.accuracy<.8||r.accuracy>.99)&&(r.accuracy=.95),a={max:r.size*(2-r.accuracy)*1024,accurate:1024*r.size,min:r.size*r.accuracy*1024},[4,p(t)]);case 1:return O=Q.sent(),L=O.split(",")[0].match(/:(.*?);/)[1],E=S.JPEG,o(r.type)&&(E=r.type,L=r.type),[4,h(O)];case 2:return[4,g(Q.sent(),l.extend({},r))];case 3:D=Q.sent(),j=.75,B=.5,G=[null,null],X=1,Q.label=4;case 4:return X<=7?[4,u(D,B,E)]:[3,7];case 5:if(q=Q.sent(),$=q.length*j,7===X)return(a.max<$||a.min>$)&&(q=function(){for(var t=0,r=0,a=arguments.length;r<a;r++)t+=arguments[r].length;var l=Array(t),S=0;for(r=0;r<a;r++)for(var O=arguments[r],L=0,E=O.length;L<E;L++,S++)l[S]=O[L];return l}([q],G).filter((function(t){return t})).sort((function(t,r){return Math.abs(t.length*j-a.accurate)-Math.abs(r.length*j-a.accurate)}))[0]),[3,7];if(a.max<$)G[1]=q,B-=Math.pow(.5,X+1);else{if(!(a.min>$))return[3,7];G[0]=q,B+=Math.pow(.5,X+1)}Q.label=6;case 6:return X++,[3,4];case 7:return[4,f(q,L)];case 8:return(Z=Q.sent()).size>t.size?[2,t]:[2,Z]}}))}))}}])},269:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_bubble lrn_charactermap"><div class="lrn_charactermap_title">'+(null==(__t=labels.characterMapTitle)?"":__t)+"</div>",_.each(characters,(function(t,r){__p+='<button class="lrn_btn_grid lrn_characterbutton" type="button" unselectable="on" tabindex="0" data-character-btn-index="'+(null==(__t=r)?"":__t)+'">'+(null==(__t=t)?"":__t)+"</button>"})),__p+="</div>";return __p}},270:function(t,r,a){"use strict";var l=a(1),S=a.n(l),O=a(0),L=a.n(O),E=a(53),D=a(321),j=a.n(D),B=a(247),q=a.n(B),G=a(11),X=a(24),$=(a(7),E.a.extend({template:j.a,responseMarkerRegExp:void 0,responseValue:[],showingValidationUI:!1,previousResponseValue:[],readOnly:!1,validGap:11,pointLeftRightGap:1.4,pointerWidth:20,pointerTopBottomHeight:25,pointerLeftRightHeight:36,pointerHeight:"10px",RESPONSE_CONTAINER_DEFAULT_DATA:{defaultData:{bottom:"0px",width:"96px",height:"2.3em"},imageclozeassociation:{width:"20px"},imageclozedropdown:{width:"50px"}},responseContainerDefaultInputType:"text",responseContainerInputTypes:["text","number"],incorrectAnswerBubbleTemplate:q.a,initialize:function initialize(){var t,r;E.a.prototype.initialize.call(this),this.jqNamespace=".lrn-cloze-".concat(this.cid),this.events=L.a.extend({},$.prototype.events,this.events),this.activity=this.options.activity,this.i18n=this.activity.get("i18n"),this.responseMarkerRegExp=new RegExp(this.model.RESPONSE_MARKER_REGEXP,"g"),t=this.model.getContentTemplate().match(this.responseMarkerRegExp),this.responseValue=[],this.responseValue.length=t?t.length:0;for(var a=0;a<this.responseValue.length;a++)this.responseValue[a]=null;this.activity.get("state")===this.activity.STATE.RESUME&&this.model.hasResponse()&&(this.responseValue=this.model.getResponseValue()||[]),this.responseContainerDefaultData=L.a.extend({},this.RESPONSE_CONTAINER_DEFAULT_DATA.defaultData),(r=this.RESPONSE_CONTAINER_DEFAULT_DATA[this.model.get("type")])&&L.a.extend(this.responseContainerDefaultData,r),this.readOnly=this.activity.get("state")===this.activity.STATE.REVIEW||this.activity.get("state")===this.activity.STATE.PREVIEW,this.displayLogic={},this.addRenderingLogic(),this.render(),this.initialisationCompleted()},render:function render(t){var r,a=this.model,l=this,O=a.get("question"),E=a.isVerticalTopContainer();function resizeImage(){var t=function setWidth(){return Object(X.a)(l.$el,(function(){l.setImageWidth()}))};t(),l.isListeningToWindowResize||(S()(window).on("resize"+l.jqNamespace,t),l.isListeningToWindowResize=!0)}function resizeImageOnLoad(){var t=l.$(".lrn_imagecloze_image");t.prop("complete")?resizeImage():t.on("load",resizeImage)}return r=t||this.template({questionResponse:a,displayLogic:this.displayLogic,labels:this.i18n.labels}),this.renderViewContent(r,this.extraClasses),this.displayLogic.isReviewState&&this.renderValidatableUI(),this.$el.toggleClass("lrn_cloze_vertical_top_none",!E),this.displayLogic.isMath&&a.isImageCloze()&&L.a.hasProperty(O,"ui_style.possibility_list_position")&&("left"===O.ui_style.possibility_list_position||"right"===O.ui_style.possibility_list_position)?this.mathquillRendering()?(this.renderMathquill(),resizeImageOnLoad()):G.a.once(G.a.EVENT.RENDERED,resizeImageOnLoad):resizeImageOnLoad(),this},setImageWidth:function setImageWidth(){var t=this.$(".lrn_imagecloze_image"),r=this.$(".lrn_possibilityList"),a=this.$(".lrn_imagecloze_container"),l=this.$(".lrn_cloze_response_container"),S=this.$(".lrn_response_input"),O=this.$(".lrn_response_innerbody");l.add(O).add(a).add(t).css({maxWidth:"",width:""});var E,D,j,B,q,G,X=2*parseFloat(S.css("padding-left"),10)||0,$=O.innerWidth(),Z=r.length,Q=this.getScaledWidth(t.width());return t.css({width:Q}),l.css({"max-width":$,display:"block"}),Z&&(D=r.css("position"),r.css("position","absolute"),j=this.model.get("question"),G=L.a.hasProperty(j,"ui_style.possibility_list_position")&&("left"===j.ui_style.possibility_list_position||"right"===j.ui_style.possibility_list_position),E=this.$(".lrn_response_innerbody"),B=S.outerWidth(),q=0,r.css("position",D),G&&(q=r.outerWidth()),l.css({width:this.getScaledWidth(B+q+X)}),E.css({"max-width":$,width:this.getScaledWidth(B+q+X)})),a.css({width:t.width()}),Q},getScaledWidth:function getScaledWidth(t){return this.displayLogic.imageScale?t/this.model.FONTSIZE_MAP[this.model.FONTSIZE.NORMAL]+"em":t},addRenderingLogic:function addRenderingLogic(){E.a.prototype.addRenderingLogic.call(this);var t=this,r=this.model.get("question"),a=this.activity.get("state")===this.activity.STATE.REVIEW;this.displayLogic.readOnly=a||this.activity.get("state")===this.activity.STATE.PREVIEW,this.displayLogic.multipleResponses=this.responseValue&&this.responseValue.length>1,this.displayLogic.isMath=!!r.is_math,L.a.isObject(this.displayLogic.responseContainer)||(this.displayLogic.responseContainer={}),this.displayLogic.responseContainer.inputType=this.responseContainerDefaultInputType,L.a.isObject(r.response_container)&&(r.response_container.hasOwnProperty("width")&&(this.displayLogic.responseContainer.width=r.response_container.width,r.response_container.width.indexOf("%")>0&&(this.displayLogic.responseContainer.fluid_width=!0)),r.response_container.hasOwnProperty("height")&&(this.displayLogic.responseContainer.height=r.response_container.height,r.response_container.height.indexOf("%")>0&&(this.displayLogic.responseContainer.fluid_height=!0)),r.response_container.hasOwnProperty("placeholder")&&(this.displayLogic.responseContainer.placeholder=r.response_container.placeholder,this.displayLogic.responseContainer.showPlaceholder=!L.a.isEmpty(r.response_container.placeholder)&&!this.displayLogic.readOnly),r.response_container.hasOwnProperty("pointer")&&(this.displayLogic.responseContainer.pointer=r.response_container.pointer),r.response_container.hasOwnProperty("wordwrap")&&(this.displayLogic.responseContainer.wordwrap=r.response_container.wordwrap),L.a.contains(this.responseContainerInputTypes,r.response_container.input_type)&&(this.displayLogic.responseContainer.inputType=r.response_container.input_type)),r.image&&(this.displayLogic.imageScale=r.image.scale),this.extraClasses="lrn_cloze";var l=this.model.getContentTemplate(),S=-1;l=l.replace(this.responseMarkerRegExp,(function(){return S++,t.getResponseInputHTML(S,t.getPointerVars(S))})),this.displayLogic.processedTemplate=l,this.displayLogic.extraContentHTML=this.getExtraContentHTML()},getResponseInputHTML:function getResponseInputHTML(t){return"{replacedInput"+t+"}"},getExtraContentHTML:function getExtraContentHTML(){return null},showCorrectAnswer:function showCorrectAnswer(){this.showCorrectAnswerList()},showCorrectAnswersHover:function showCorrectAnswersHover(){throw new Error("Unimplemented function showCorrectAnswersHover for question type:"+this.model.get("type"))},getResponseContainerFor:function getResponseContainerFor(t){var r=this.model.get("question"),a=L.a.extend({},this.displayLogic.responseContainer);return L.a.isArray(r.response_containers)&&L.a.isObject(r.response_containers[t])&&(L.a.extend(a,r.response_containers[t]),L.a.contains(this.responseContainerInputTypes,r.response_containers[t].input_type)&&(a.inputType=r.response_containers[t].input_type),a.showPlaceholder=!L.a.isEmpty(a.placeholder)&&!this.displayLogic.readOnly),a},getImageClozeAriaLabelFor:function getImageClozeAriaLabelFor(t){var r=this.model.getImageClozeAriaLabels();if(L.a.isArray(r))return r[t]},getPointerVars:function getPointerVars(t){if(!this.model.isImageCloze())return{};var r=this.model.getFontSize(),a=this.getResponseContainerFor(t),l=this.getPixel(a.width||this.responseContainerDefaultData.width,r),S=this.getPixel(a.height||this.responseContainerDefaultData.height,r),O=this.getPixel(a.height||this.responseContainerDefaultData.bottom,r),L=(this.getPixel(this.pointerHeight,r),{position:a.pointer});switch(this.model.get("type")===this.model.TYPE.IMAGECLOZEDROPDOWN&&(this.validGap=0),this.model.get("type")===this.model.TYPE.IMAGECLOZETEXT&&(this.responseContainerDefaultHeight="24px"),a.pointer){case"top":L.top=S/2+this.getPointLeftRightGap()+"px",L.left=this.getEm(-1*(Math.ceil((l-this.pointerWidth)/2)+2));break;case"right":L.right=this.pointerWidth/2+this.getPointLeftRightGap()+"px",L.top=this.getEm(-1*Math.floor((S-this.pointerLeftRightHeight)/2));break;case"bottom":L.bottom=O+this.getPointLeftRightGap()/2+"px",L.left=this.getEm(-1*(Math.ceil((l-this.pointerWidth)/2)+2));break;case"left":L.left=this.pointerWidth*this.pointLeftRightGap+this.getPointLeftRightGap()+"px",L.top=this.getEm(-1*Math.floor((S-this.pointerLeftRightHeight)/2));break;default:L={}}return L},getPointLeftRightGap:function getPointLeftRightGap(){if(!this._pointLeftRightGap){var t=this.model.getFontSize();this._pointLeftRightGap=this.pointLeftRightGap*t}return this._pointLeftRightGap},getPixel:function getPixel(t,r){var a=(t=t.toString()).substr(-2),l=parseFloat(t.substr(0,t.length-2));return"em"===a?l*r:l},getEm:function getEm(t,r,a){var l=t/(a?this.model.FONTSIZE_MAP.normal:this.model.getFontSize());return r?l:l+"em"},remove:function remove(){S()(window).off(this.jqNamespace),E.a.prototype.remove.call(this)}}));r.a=$},276:function(t,r,a){"use strict";a(1);var l=a(0),S=a.n(l),O=a(8).a.extend({DEFAULT_FORMATTING_OPTIONS:["bold","italic","underline","|","unorderedList","orderedList"],SHOW_WORD_LIMITS:{ALWAYS:"always",ON:"on-limit",OFF:"off"},MAX_WORD_LENGTH:1e4,processResponseValue:function processResponseValue(t){this.hasResponse()||this.set({response:{value:"",wordCount:0,type:this.RESPONSE_TYPE.STRING}},{silent:!0}),this.get("response").value=t.value,this.get("response").wordCount=t.wordCount},getFormattingOptions:function getFormattingOptions(){if(!this._formattingOptions){var t=this.get("question").formatting_options;S.a.isArray(t)||(t=this.DEFAULT_FORMATTING_OPTIONS);var r=this.getCharacterMap(),a=t.indexOf("charactermap");S.a.isArray(r)||!1!==r?a<0&&t.push("charactermap"):!1===r&&a>=0&&Array.prototype.splice.call(t,a,1),this._formattingOptions=t}return this._formattingOptions},getMaxLength:function getMaxLength(){if(!this._maxLength){var t=this.get("question").max_length;(!S.a.isNumber(t)||t<0||t>this.MAX_WORD_LENGTH)&&(t=this.MAX_WORD_LENGTH),this._maxLength=t}return this._maxLength},getWordCount:function getWordCount(){return this.hasResponse()?this.get("response").wordCount:0},getShowWordCount:function getShowWordCount(){if(S.a.isUndefined(this._showWordCount)){var t=this.get("question").show_word_count;this._showWordCount=!S.a.isBoolean(t)||t}return this._showWordCount},getPlaceholder:function getPlaceholder(){return this.get("question").placeholder},getBrowserSpellCheck:function getBrowserSpellCheck(){if(S.a.isUndefined(this._spellCheck)){var t=this.get("question").spellcheck;this._spellCheck=S.a.isBoolean(t)?t:"false"!==t}return this._spellCheck},disableAutoLink:function disableAutoLink(){return this.activity.get("disable_auto_link")||S.a.getNested(this.get("question"),"disable_auto_link")},getCharacterMap:function getCharacterMap(){if(S.a.isUndefined(this._characterMap)){var t=this.get("question"),r=t.character_map,a=S.a.isArray(t.formatting_options)?t.formatting_options:[],l=(S.a.isUndefined(r)||S.a.isArray(r)&&!r.length)&&a.indexOf("charactermap")>=0;this._characterMap=!!l||!(!S.a.isArray(r)&&!S.a.isBoolean(r))&&r}return this._characterMap},getShowWordLimit:function getShowWordLimit(){if(S.a.isUndefined(this._showWordLimit)){var t=this.get("question").show_word_limit,r=this.SHOW_WORD_LIMITS;this._showWordLimit=S.a.contains(r,t)?t:r.ALWAYS}return this._showWordLimit},getUIStyle:function getUIStyle(){return S.a.isUndefined(this._uiStyle)&&(this._uiStyle=S.a.getNested(this.get("question"),"ui_style")||{}),this._uiStyle},isMaxLengthDefined:function isMaxLengthDefined(){return S.a.isUndefined(this._isMaxLengthDefined)&&(this._isMaxLengthDefined=!!this.get("question").max_length),this._isMaxLengthDefined},wordCountExceeded:function wordCountExceeded(){return this.getWordCount()>this.getMaxLength()},hasAllowedResponse:function hasAllowedResponse(){return!(this.hasResponse()&&!this.get("question").submit_over_limit&&this.wordCountExceeded())}});r.a=O},283:function(t,r,a){"use strict";a.d(r,"a",(function(){return trapFocus}));var l=a(0),S=a.n(l),O=a(1),L=a.n(O),E=a(7),D=["a[href]",'input:not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','[tabindex]:not([tabindex="-1"])',"[contenteditable]","area[href]","iframe","object","embed"].join();function trapFocus(t,r){var a=document.activeElement,l=L()(t).find(D).filter(":visible"),O=S.a.first(l),j=S.a.last(l);if(l.length){var B=function handler(t){9===t.keyCode&&(t.shiftKey?document.activeElement===O&&(t.preventDefault(),j.focus()):document.activeElement===j&&(t.preventDefault(),O.focus()))};return(r&&S.a.isFunction(r.focus)?r:O).focus(),t.addEventListener("keydown",B),t.setAttribute("role","dialog"),E.a.isSafari||t.setAttribute("aria-modal","true"),function restore(r){t.removeEventListener("keydown",B),t.removeAttribute("role"),t.removeAttribute("aria-modal"),(r&&S.a.isFunction(r.focus)?r:a).focus()}}}},284:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(35),L=a(10);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=_getPrototypeOf(t);if(r){var S=_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E=["exactMatch"],D=function isDefaultValidResponseValue(t){return 0===S.a.filter(t,(function(t){return t&&(t.value||t.method||0===t.value)})).length},j=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(MathScorer,t);var r=_createSuper(MathScorer);function MathScorer(){return _classCallCheck(this,MathScorer),r.apply(this,arguments)}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(MathScorer,[{key:"reset",value:function reset(t){var r=JSON.stringify(t),a=this.validateSingleSpec||this.cachedValidateSingleSpec;if(this.serializedData!==r){try{this.scoringData=function getScoringData(t,r){if(!function canValidateResponse(t){if(!1===S.a.getNested(t,"validation.automarkable"))return!1;var r=t.validation||t;return!(S.a.isEmpty(r)||!(r.valid_responses||r.valid_response&&!D(r.valid_response.value)))}(t.question))return{automarkable:!1};t.response=t.response||{};var a,l,O=t.response&&t.response.value,j=[];t.question.equiv_literal_legacy&&(t=L.a.processCompatibility(t));if(l=!!t.question.validation.allow_negative_scores,t.response=t.response||{},t.question.validation.scoring_type){if(!S.a.contains(E,t.question.validation.scoring_type))throw new L.a.InvalidScoringTypeException(t.question.type,t.question.validation.scoring_type);t.question.validation.valid_response&&j.push(t.question.validation.valid_response),t.question.validation.alt_responses&&(j=j.concat(t.question.validation.alt_responses)),a=Math.abs(S.a.isNumber(t.question.validation.penalty)?t.question.validation.penalty:0)}else j=t.question.validation&&t.question.validation.valid_responses||[];var B=L.a.validateMathLists(O,j,r,1,a);void 0===B.scoreWithFullPenalty?B.score=null:B.score=l?B.scoreWithFullPenalty:Math.max(0,B.scoreWithFullPenalty);return B}(t,a),L.a.normalizeScores(this.scoringData,t)}catch(t){this.scoringData={error:t}}this.serializedData=r}return this.cachedValidateSingleSpec=a,this}}]),MathScorer}(O.a);r.a=j},285:function(t,r,a){"use strict";var l=a(339),S=a.n(l),O=a(192);r.a=function validateSingleSpec(t,r){return O.a.useMathCore(t)?S.a.evaluateVerbose(t,r):O.a.validate(t,r)}},286:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(541),L=a.n(O);function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var E=function(){function Fraction(t,r,a){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,Fraction),this.integer=isNaN(parseFloat(a))?0:parseFloat(a),this.numerator=0,this.denominator=null,(t||r)&&this.set(t,r)}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(Fraction,[{key:"normalize",value:function normalize(t){var r,a,l,S,O=this.denominator?this.denominator:1;if(!0===t?(l=this.numerator,S=O):(a=Fraction.gcd(this.numerator,O),l=this.numerator/a,S=O/a),Math.abs(l)>=Math.abs(S)){if(1===S)return this.integer+=l,this.numerator=0,this.denominator=null,this;r=l<0?-Math.floor(-l/S):Math.floor(l/S),this.integer<0?this.integer-=r:this.integer+=r,l-=r*S}return this.set(l,S)}},{key:"clone",value:function clone(){return new Fraction(this)}},{key:"set",value:function set(t,r){if(t instanceof Fraction)this.integer=t.integer,this.numerator=t.numerator,this.denominator=t.denominator;else if(S.a.isUndefined(t)||S.a.isNull(t)||S.a.isUndefined(r)||S.a.isNull(r))if(S.a.isUndefined(r)||S.a.isNull(r))if(S.a.isString(t)){var a=Fraction.IMPROPER_REG_EXP.exec(t),l=Fraction.MIXED_REG_EXP.exec(t);l&&4===l.length?(this.integer=parseInt(l[1],10),this.numerator=parseInt(l[2],10),this.denominator=parseInt(l[3],10)):a&&3===a.length?(this.numerator=parseInt(a[1],10),this.denominator=parseInt(a[2],10)):(this.integer=parseFloat(t),this.numerator=0,this.denominator=null)}else S.a.isNumber(t)?(this.integer=t,this.numerator=0,this.denominator=null):(this.integer=0,this.numerator=0,this.denominator=null);else S.a.isUndefined(r)||S.a.isNull(r)?(this.integer=0,this.numerator=0,this.denominator=null):(this.integer=0,this.numerator=0,(S.a.isNumber(r)||S.a.isString(r))&&(this.denominator=parseInt(r,10),this.denominator||(this.denominator=null)));else(S.a.isNumber(t)||S.a.isString(t))&&(this.numerator=parseInt(t,10)),(S.a.isNumber(r)||S.a.isString(r))&&(this.denominator=parseInt(r,10)),this.denominator||(this.denominator=null);return this.setCorrectSign(),this}},{key:"convertToDenominator",value:function convertToDenominator(t){var r,a,l=this.denominator?this.denominator:1,O=this.numerator,L=this.integer;return S.a.isNumber(t)||(t=(a=new Fraction(t)).denominator?a.denominator:1),S.a.isNumber(t)&&l!==t&&(r=t/l,0===(O=this.numerator*r)&&(O=L*t,L=0)),new Fraction(O,t,L)}},{key:"add",value:function add(t){var r,a,l,S;return t=new Fraction(t),r=this.getImproperFraction(),a=t.getImproperFraction(),l=Fraction.lcm(r.denominator?r.denominator:1,a.denominator?a.denominator:1),(S=new Fraction(l/(r.denominator?r.denominator:1)*r.numerator+l/(a.denominator?a.denominator:1)*a.numerator,l)).normalize(!0),S}},{key:"subtract",value:function subtract(t){return t=new Fraction(t),this.add(t.multiply(-1))}},{key:"inverse",value:function inverse(){var t=this.getImproperFraction();return new Fraction(t.denominator,t.numerator)}},{key:"multiply",value:function multiply(t){var r,a;return t=new Fraction(t),r=this.getImproperFraction(),a=t.getImproperFraction(),new Fraction(r.numerator*a.numerator,(r.denominator?r.denominator:0)*(a.denominator?a.denominator:0))}},{key:"divide",value:function divide(t){return t=new Fraction(t),this.multiply(t.inverse())}},{key:"getProperFraction",value:function getProperFraction(){var t=new Fraction(this);return t.normalize(!0),new Fraction(t.integer<0&&t.numerator>0?-t.numerator:t.numerator,this.denominator)}},{key:"getImproperFraction",value:function getImproperFraction(){var t,r;return this.numerator&&this.denominator?(t=this.integer<0?this.integer*this.denominator-this.numerator:this.integer*this.denominator+this.numerator,r=this.denominator):this.denominator?(r=this.denominator,this.integer&&(t=this.integer*this.denominator)):this.integer&&(t=this.integer,r=1),new Fraction(t,r)}},{key:"getSimpleFraction",value:function getSimpleFraction(){return new Fraction(this.integer<0?-this.numerator:this.numerator,this.denominator)}},{key:"toInteger",value:function toInteger(){return~~this.toDecimal()}},{key:"toDecimal",value:function toDecimal(){return this.denominator&&0!==this.denominator?this.integer&&this.integer<0?this.integer-this.numerator/this.denominator:this.numerator/this.denominator+this.integer:this.integer}},{key:"setCorrectSign",value:function setCorrectSign(){this.numerator&&this.numerator<0&&this.denominator&&this.denominator<0?(this.numerator=-this.numerator,this.denominator=-this.denominator):this.integer&&this.integer<0&&this.numerator&&this.numerator<0?this.numerator=-this.numerator:this.integer&&this.integer<0&&this.denominator&&this.denominator<0?this.denominator=-this.denominator:this.numerator&&this.numerator<0?this.integer&&(this.integer=-this.integer,this.numerator=-this.numerator):this.denominator&&this.denominator<0&&(this.integer?(this.integer=-this.integer,this.denominator=-this.denominator):(this.numerator=-this.numerator,this.denominator=-this.denominator))}},{key:"toSimpleString",value:function toSimpleString(){var t=0;return 0===this.integer&&0===this.numerator&&null===this.denominator?"0":!this.integer||this.numerator||this.denominator?(this.integer&&this.denominator&&(t=this.integer<0?-this.integer*this.denominator:this.integer*this.denominator),this.numerator&&(t+=this.numerator),this.denominator?(this.integer<0?"-":"")+t+"/"+this.denominator:""):""+this.integer}},{key:"toSimpleHtml",value:function toSimpleHtml(t,r){var a={integer:"",simpleFraction:this.getImproperFraction(),allowZeroNumerator:!0};return this.toMixedHtml(t,a,r)}},{key:"toMixedParams",value:function toMixedParams(){var t=this.getSimpleFraction();return 0===t.toDecimal()?t=null:this.integer<0&&(t=t.multiply(-1)),{integer:this.integer,simpleFraction:t,allowZeroNumerator:!1}}},{key:"toMixedString",value:function toMixedString(){var t=this.toMixedParams(),r=(t.integer?t.integer:"")+(t.simpleFraction?" "+t.simpleFraction.toSimpleString():"");return r?r.trim():"0"}},{key:"toMixedHtml",value:function toMixedHtml(t,r,a){var l,S,O,L=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Fraction.fractionClass,E="",D="";return D=(r=r||this.toMixedParams()).integer,r.simpleFraction?(S=r.simpleFraction.numerator,O=r.simpleFraction.denominator):(S=0,O=0),S<0&&(S=-S,""===D||0===D?D="-":D>0&&(D=-D)),0!==S?(E+=S,O&&(E+="<hr/>"+O)):r.allowZeroNumerator&&O&&(E+="0<hr/>"+O),t&&(D=t+" "+D),""===E&&""===D&&(D=0),l={fractionClass:L,proper:E,integer:0===D&&""!==E?"":""+D},!0===a?l:Fraction.mixedFractionTemplate(l)}}]),Fraction}();_defineProperty(E,"IMPROPER_REG_EXP",/(\-?\d+)\s*\/\s*([1-9]\d*)/),_defineProperty(E,"MIXED_REG_EXP",/(\-?\d+)\s+(\d+)\s*\/\s*([1-9]\d*)/),_defineProperty(E,"fractionClass","lrn-numberline-fraction"),_defineProperty(E,"mixedFractionTemplate",L.a),_defineProperty(E,"gcd",(function(t,r){return r?E.gcd(r,t%r):t})),_defineProperty(E,"lcm",(function(t,r){var a=E.gcd(t,r);return Math.abs(t)/a*Math.abs(r)})),_defineProperty(E,"isNumber",(function(t){return!isNaN(parseFloat(t))&&isFinite(t)})),_defineProperty(E,"isFraction",(function(t){var r=E.IMPROPER_REG_EXP.exec(t),a=E.MIXED_REG_EXP.exec(t);return!!(a&&4===a.length||r&&3===r.length)})),_defineProperty(E,"isMixedFraction",(function(t){var r=E.MIXED_REG_EXP.exec(t);return!(!r||4!==r.length)})),_defineProperty(E,"isParsable",(function(t){return E.isNumber(t)||E.isFraction(t)})),_defineProperty(E,"areEqual",(function(t,r){return t.toDecimal()===r.toDecimal()})),_defineProperty(E,"areIdentical",(function(t,r){return t.numerator===r.numerator&&t.denominator===r.denominator&&t.integer===r.integer})),_defineProperty(E,"decimalToFraction",(function(t){if(t===parseInt(t))return{top:parseInt(t),bottom:1,display:parseInt(t)+"/1"};var r=-1!==t.toString().indexOf(".")?t.toString().replace(/\d+[.]/,""):0,a=Math.pow(10,r.toString().replace("-","").length);t>=1?r=+r+Math.floor(t)*a:t<=-1&&(r=+r+Math.ceil(t)*a);var l=Math.abs(E.gcd(r,a));return{top:r/l,bottom:a/l}})),r.a=E},287:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(151),L=a(126),E=a.n(L),D=a(130),j=a(128),B=a(127),q=a.n(B),G=a(147),X=a(143),$=a(153),Z=a(186);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _extends(){return(_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=_getPrototypeOf(t);if(r){var S=_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?_assertThisInitialized(t):r}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function modalWithToggle(t){return function(r){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(_temp,r);var a=_createSuper(_temp);function _temp(){var t;_classCallCheck(this,_temp);for(var r=arguments.length,l=new Array(r),S=0;S<r;S++)l[S]=arguments[S];return _defineProperty(_assertThisInitialized(t=a.call.apply(a,[this].concat(l))),"state",{modalIsOpen:!1}),_defineProperty(_assertThisInitialized(t),"closeModal",(function(){(0,t.props.onModal)(null),t.setState({modalIsOpen:!1})})),_defineProperty(_assertThisInitialized(t),"toggleModal",(function(){var r=t.props.onModal,a=!t.state.modalIsOpen;r(a),t.setState({modalIsOpen:a})})),t}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(_temp,[{key:"render",value:function render(){var r=this.props,a=this.state,l=r.isActive,S=r.visible,O=r.onApply,L=r.getContainer,D=a.modalIsOpen,j=q()({hide:!S});return E.a.createElement(E.a.Fragment,null,E.a.createElement($.a.Button,_extends({},r,{isActive:l,className:j,onClick:this.toggleModal})),E.a.createElement(t,_extends({},r,{relativeNode:L,modalIsOpen:D,onRequestClose:this.closeModal,onApply:O})))}}]),_temp}(E.a.Component)}var Q=a(154);function create_typeof(t){return(create_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function create_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function create_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function create_setPrototypeOf(t,r){return(create_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function create_createSuper(t){var r=function create_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=create_getPrototypeOf(t);if(r){var S=create_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return create_possibleConstructorReturn(this,a)}}function create_possibleConstructorReturn(t,r){return!r||"object"!==create_typeof(r)&&"function"!=typeof r?create_assertThisInitialized(t):r}function create_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function create_getPrototypeOf(t){return(create_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function create_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var ee=function(t){!function create_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&create_setPrototypeOf(t,r)}(CreateTableModal,t);var r=create_createSuper(CreateTableModal);function CreateTableModal(){var t;create_classCallCheck(this,CreateTableModal);for(var a=arguments.length,l=new Array(a),S=0;S<a;S++)l[S]=arguments[S];return create_defineProperty(create_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"state",{cols:3,rows:2}),create_defineProperty(create_assertThisInitialized(t),"onChange",(function(r,a){t.setState(create_defineProperty({},r,a))})),create_defineProperty(create_assertThisInitialized(t),"onApply",(function(r){var a=t.props,l=a.onApply,S=a.onRequestClose,O=t.state;l({cols:O.cols,rows:O.rows}),S(),r.preventDefault()})),create_defineProperty(create_assertThisInitialized(t),"onCloseWithoutApply",(function(){var r=t.props,a=r.onApply,l=r.onRequestClose;a(null),l()})),t}return function create_createClass(t,r,a){return r&&create_defineProperties(t.prototype,r),a&&create_defineProperties(t,a),t}(CreateTableModal,[{key:"render",value:function render(){var t=this,r=this.props,a=r.i18n,l=r.relativeNode,S=r.modalIsOpen,O=r.responseId,L=a.labels.editor.modals,D=this.state,j=D.cols,B=D.rows,q=j>0&&B>0&&j<100&&B<100;return E.a.createElement(Q.a,{getRef:function getRef(r){return t.el=r},title:L.tableTitle,parentNode:l,modalIsOpen:S,onRequestClose:this.onCloseWithoutApply},E.a.createElement("div",{className:"lrn_clearfix"},E.a.createElement("div",{className:"lrn-wysihtml-modal-section"},E.a.createElement("label",{htmlFor:"".concat(O,"-table-columns")},E.a.createElement("span",{className:"lrn-label-title"},L.columns),E.a.createElement("input",{type:"number",id:"".concat(O,"-table-columns"),className:"lrn-editor-input",defaultValue:j,min:"1",max:"99",onChange:function onChange(r){return t.onChange("cols",r.target.value)}}))),E.a.createElement("div",{className:"lrn-wysihtml-modal-section"},E.a.createElement("label",{htmlFor:"".concat(O,"-table-rows")},E.a.createElement("span",{className:"lrn-label-title"},L.rows),E.a.createElement("input",{type:"number",id:"".concat(O,"-table-rows"),className:"lrn-editor-input",defaultValue:B,min:"1",max:"99",onChange:function onChange(r){return t.onChange("rows",r.target.value)}})))),E.a.createElement("hr",null),E.a.createElement("div",{className:"lrn-wysihtml-modal-controls"},E.a.createElement("button",{className:"lrn_btn lrn_btn_blue","data-lrn-action":"apply",onClick:this.onApply,disabled:!q,type:"button"},L.apply)))}}]),CreateTableModal}(E.a.Component);function edit_typeof(t){return(edit_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function edit_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function edit_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function edit_setPrototypeOf(t,r){return(edit_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function edit_createSuper(t){var r=function edit_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=edit_getPrototypeOf(t);if(r){var S=edit_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return edit_possibleConstructorReturn(this,a)}}function edit_possibleConstructorReturn(t,r){return!r||"object"!==edit_typeof(r)&&"function"!=typeof r?edit_assertThisInitialized(t):r}function edit_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function edit_getPrototypeOf(t){return(edit_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function edit_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var te=function(t){!function edit_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&edit_setPrototypeOf(t,r)}(EditTableModal,t);var r=edit_createSuper(EditTableModal);function EditTableModal(){var t;edit_classCallCheck(this,EditTableModal);for(var a=arguments.length,l=new Array(a),S=0;S<a;S++)l[S]=arguments[S];return edit_defineProperty(edit_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"onApply",(function(r,a){var l=t.props,S=l.onApply,O=l.onRequestClose;S(a),O(),r.preventDefault()})),t}return function edit_createClass(t,r,a){return r&&edit_defineProperties(t.prototype,r),a&&edit_defineProperties(t,a),t}(EditTableModal,[{key:"render",value:function render(){var t=this,r=this.props,a=r.i18n,l=r.relativeNode,S=r.modalIsOpen,O=r.onRequestClose,L=a.labels.editor.modals;return E.a.createElement(Q.a,{getRef:function getRef(r){return t.el=r},title:L.tableTitle,parentNode:l,className:"lrn-wysihtml-modal-table-edit",modalIsOpen:S,onRequestClose:O},E.a.createElement("div",{className:"lrn_clearfix"},E.a.createElement("div",{className:"lrn-wysihtml-modal-section"},E.a.createElement("div",null,E.a.createElement("span",{className:"lrn-label-title"},L.columns)),E.a.createElement("ul",null,E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"addTableCells",params:"before"})}},L.insertColumnBefore)),E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"addTableCells",params:"after"})}},L.insertColumnAfter)),E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"deleteTableCells",params:"column"})}},L.deleteColumn)))),E.a.createElement("div",{className:"lrn-wysihtml-modal-section"},E.a.createElement("div",null,E.a.createElement("span",{className:"lrn-label-title"},L.rows)),E.a.createElement("ul",null,E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"addTableCells",params:"above"})}},L.insertRowAbove)),E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"addTableCells",params:"below"})}},L.insertRowBelow)),E.a.createElement("li",null,E.a.createElement("button",{type:"button",className:"lrn_btn",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"deleteTableCells",params:"row"})}},L.deleteRow))))),E.a.createElement("hr",null),E.a.createElement("div",{className:"lrn-wysihtml-modal-controls"},E.a.createElement("button",{type:"button",className:"lrn_btn  lrn_btn_danger",onMouseDown:function onMouseDown(r){return t.onApply(r,{type:"deleteTable"})}},L.deleteTable)))}}]),EditTableModal}(E.a.Component),ne={CreateTableButton:modalWithToggle(ee),EditTableButton:modalWithToggle(te)},re=a(306),oe=a.n(re),ie=a(204),ae=a(132);function imagePropsUtil_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function generateImageAttributes(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{className:"class"},a=t.url,l=t.size,S=t.naturalWidth,O=t.naturalHeight,L=imagePropsUtil_defineProperty({src:a,width:getImageWidthFromSize(l,S,O)},r.className,q()(imagePropsUtil_defineProperty({},"lrn-size-".concat(l),!!l)));return t.assetPath&&(L["data-asset-path"]=t.assetPath),L}function getImageWidthFromSize(t,r,a){var l,S=r<a,O=S?a:r;((l=t===X.e.SMALL?Math.min(O,X.d.SMALL):t===X.e.MEDIUM?Math.min(O,X.d.MEDIUM):t===X.e.LARGE?Math.min(O,X.d.LARGE):Math.min(O,X.d.FULL_SIZE))||(l=0),S)&&(l=parseInt(l*(r/a),10));return l}var se=a(260);function editor_extends(){return(editor_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function _slicedToArray(t,r){return function _arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function _iterableToArrayLimit(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],l=!0,S=!1,O=void 0;try{for(var L,E=t[Symbol.iterator]();!(l=(L=E.next()).done)&&(a.push(L.value),!r||a.length!==r);l=!0);}catch(t){S=!0,O=t}finally{try{l||null==E.return||E.return()}finally{if(S)throw O}}return a}(t,r)||function _unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return _arrayLikeToArray(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _arrayLikeToArray(t,r)}(t,r)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,l=new Array(r);a<r;a++)l[a]=t[a];return l}function ImageSizeSelection(t){var r=t.naturalWidth,a=t.naturalHeight,l=t.labels,O=t.size,L=t.responseId,D=function getAvailableSizes(t,r){var a=t<r?r:t;if(a<=X.d.SMALL)return null;var l=[X.e.SMALL];return a>X.d.MEDIUM&&l.push(X.e.MEDIUM),a>X.d.LARGE&&l.push(X.e.LARGE),l.push(X.e.FULL_SIZE),l}(r,a);if(!D)return null;var j=S.a.mapObject(l.imageSize,(function(t,l){return function getImageSizeLabel(t){var r=t.label,a=t.size,l=t.naturalWidth,S=t.naturalHeight,O=l/S,L=getImageWidthFromSize(a,l,S)||l,E=parseInt(L/O,10);return Object(ae.a)(r,{width:L,height:E})}({label:t,size:l,naturalWidth:r,naturalHeight:a})}));return E.a.createElement("div",{className:"lrn-image-properties"},E.a.createElement("div",{className:"lrn-image-properties-inner"},E.a.createElement("label",{htmlFor:"".concat(L,"-image-size")},E.a.createElement("span",{className:"lrn-label-title lrn-display-block"},l.imageSize.title),E.a.createElement("select",{id:"".concat(L,"-image-size"),value:O,className:"lrn-editor-input",onChange:function onChange(l){return function onSizeChange(l){t.onChange({size:l,width:getImageWidthFromSize(l,r,a)})}(l.target.value)},onBlur:S.a.noop},S.a.map(D,(function(t){return E.a.createElement("option",{key:t,value:t},j[t])}))))))}function ZoomableImage(t){var r=t.naturalWidth,a=t.naturalHeight,l=t.containerDimensions.height,S=r>l&&a>l,O=_slicedToArray(Object(L.useState)(!1),2),D=O[0],j=O[1],B={onClick:function onClick(){return j(S&&!D)}},G=generateImageAttributes(t,{className:"className"});return G.className=q()({"lrn-img-zoom-in":S&&D,"lrn-img-zoom-out":S&&!D},G.className),E.a.createElement("img",editor_extends({alt:""},B,G))}function ImageEditor(t){var r=t.children,a=Object(L.useRef)(null),l=_slicedToArray(Object(L.useState)(0),2),S=l[0],O=l[1];return Object(L.useLayoutEffect)((function(){a.current&&a.current.clientHeight!==S&&O(a.current.clientHeight)})),E.a.createElement("div",null,E.a.createElement("div",{className:"lrn-image-uploader-preview",ref:a},E.a.createElement(ZoomableImage,editor_extends({containerDimensions:{height:S}},t))),r,E.a.createElement(ImageSizeSelection,t))}var le=a(326),ce={fileDialog:a.n(le).a},ue=a(21),pe={LONGTEXTV2_UPDATE_WORD_COUNT:"longtextv2:update:wordcount",LONGTEXTV2_UPDATE_WORD_COUNT_EXCEEDED:"longtextv2:update:wordcountexceeded",LONGTEXTV2_UPDATE_WORD_LIMIT_VISIBILITY:"longtextv2:update:wordlimitvisibility",LONGTEXTV2_DISABLE_EDITOR:"longtextv2:disable:editor"};var de={actionTypes:pe,compressImage:function compressImage(t,r){return function(a,l,S){return S.dataService.compressImage(t,r)}},uploadImage:function actions_uploadImage(t,r){return function(a,l,S){return S.dataService.uploadImage(t,r)}},updateValue:function updateValue(t){return function(r,a,l){var S=l.dataService.getResponse();if((S&&S.value)!==(t=l.dataService.formatValue(t))){r({type:pe.LONGTEXTV2_UPDATE_WORD_COUNT,payload:{value:t}});var O=a().longTextV2.footer.wordCount;r(ue.a.updateResponseValue({value:t,wordCount:O}));var L=l.dataService.getWordCountExceeded();r({type:pe.LONGTEXTV2_UPDATE_WORD_COUNT_EXCEEDED,payload:{value:L}});var E=l.dataService.getWordLimitVisibility();r({type:pe.LONGTEXTV2_UPDATE_WORD_LIMIT_VISIBILITY,payload:{value:E}})}}},disableEditor:function disableEditor(t){return{type:pe.LONGTEXTV2_DISABLE_EDITOR,payload:{value:t}}}};function uploadModal_typeof(t){return(uploadModal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.push.apply(a,l)}return a}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(a),!0).forEach((function(r){uploadModal_defineProperty(t,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))}))}return t}function uploadModal_extends(){return(uploadModal_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function uploadModal_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function uploadModal_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function uploadModal_setPrototypeOf(t,r){return(uploadModal_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function uploadModal_createSuper(t){var r=function uploadModal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=uploadModal_getPrototypeOf(t);if(r){var S=uploadModal_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return uploadModal_possibleConstructorReturn(this,a)}}function uploadModal_possibleConstructorReturn(t,r){return!r||"object"!==uploadModal_typeof(r)&&"function"!=typeof r?uploadModal_assertThisInitialized(t):r}function uploadModal_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uploadModal_getPrototypeOf(t){return(uploadModal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uploadModal_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var fe={url:null,width:0,naturalWidth:0,naturalHeight:0,size:X.e.FULL_SIZE,rotation:0,loading:!1,error:null,warning:null},he=function(t){!function uploadModal_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&uploadModal_setPrototypeOf(t,r)}(UploadImageModal,t);var r=uploadModal_createSuper(UploadImageModal);function UploadImageModal(){var t;uploadModal_classCallCheck(this,UploadImageModal);for(var a=arguments.length,l=new Array(a),O=0;O<a;O++)l[O]=arguments[O];return uploadModal_defineProperty(uploadModal_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"file",null),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"state",S.a.extend({},fe)),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"reset",(function(){t.setState(fe)})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"cleanUpAndClose",(function(){t.file=null,t.props.onRequestClose(),t.reset()})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"onImageRotationClick",(function(){var r=uploadModal_assertThisInitialized(t),a=r.file,l=r.state,S=r.props,O=l.rotation;return O>-270?O-=90:O=0,t.setState({loading:!0}),S.compressImage(a,{rotation:O}).then(ie.c).then((function(r){t.setState({loading:!1,url:r.src,width:r.width,naturalWidth:r.width,naturalHeight:r.height,rotation:O})}))})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"startImageSelection",(function(){t.uploadAborted=!1,ce.fileDialog({multiple:!1,accept:X.b}).then((function(r){t.processSelectedImage(r[0])}))})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"onImageEditorChanged",(function(r){var a=r.width,l=r.size;t.setState({width:a,size:l})})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"onCancelButtonClicked",(function(){t.uploadAborted=!0,t.cleanUpAndClose()})),uploadModal_defineProperty(uploadModal_assertThisInitialized(t),"onUploadButtonClicked",(function(r){var a=t.state,l=a.rotation,S=a.naturalWidth,O=t.props.uploadImage,L={rotation:l};return S>X.d.FULL_SIZE&&(L.width=X.d.FULL_SIZE),r.preventDefault(),r.stopPropagation(),t.setState({loading:!0}),O(t.file,L).then((function(r){t.uploadAborted||t.insertImage(r)})).catch((function(){t.showProcessingImageError()}))})),t}return function uploadModal_createClass(t,r,a){return r&&uploadModal_defineProperties(t.prototype,r),a&&uploadModal_defineProperties(t,a),t}(UploadImageModal,[{key:"componentDidUpdate",value:function componentDidUpdate(t){var r=this.props,a=r.modalIsOpen,l=r.selectedFile;t.selectedFile!==l&&(this.file=null,this.uploadAborted=!1,l&&a&&this.processSelectedImage(l))}},{key:"render",value:function render(){var t=this,r=this.props,a=r.i18n,l=r.relativeNode,O=r.responseId,L=r.modalIsOpen,D=this.state,j=D.url,B=D.loading,q=D.warning,G=D.error,X=!(!L||!(this.file||B||G||q)),$=a.labels.editor.modals;return E.a.createElement(Q.a,{className:"lrn-full-width",getRef:function getRef(r){return t.el=r},title:$.imageTitle,parentNode:l,modalIsOpen:X,onRequestClose:this.onCancelButtonClicked},E.a.createElement("div",{className:"lrn-image-editor-wrapper"},this.getMessage(),G&&E.a.createElement("div",{className:"lrn-config-btn-upload-wrapper"},E.a.createElement("button",{className:"btn lrn_btn_blue lrn-imageupload-config-btn-upload",type:"button",onClick:this.startImageSelection},$.uploadText)),j&&E.a.createElement(ImageEditor,uploadModal_extends({},this.state,{labels:$,responseId:O,onChange:this.onImageEditorChanged}),E.a.createElement("button",{className:"lrn_btn lrn-btn-outline image-editor-replace-btn",onClick:this.startImageSelection,disabled:B},E.a.createElement("span",{className:"lrn-icon-image image-editor-replace-span"}),$.imageReplace),E.a.createElement("button",{className:"lrn_btn lrn-btn-outline image-editor-rotate-btn",onClick:this.onImageRotationClick,disabled:B},E.a.createElement("span",{className:"lrn-icon-image-rotation image-editor-rotate-span"}),$.imageRotate)),B&&E.a.createElement("div",{className:"lrn-loader-wrapper"},E.a.createElement(se.a,null))),E.a.createElement("hr",null),E.a.createElement("div",{className:"lrn-wysihtml-modal-controls"},E.a.createElement("button",{className:"lrn_btn lrn_btn_blue image-editor-upload-button","data-lrn-action":"upload",onClick:this.onUploadButtonClicked,disabled:S.a.isEmpty(j)||B,type:"button"},$.upload),E.a.createElement("button",{className:"lrn_btn",onClick:this.onCancelButtonClicked,type:"button"},$.cancel)))}},{key:"getMessage",value:function getMessage(){var t=this.state,r=t.error,a=t.warning;if(!r&&!a)return null;var l=this.props.i18n.labels.editor.messages,S=r?"error":"warning",O=r?l.failedLoadingImage:l.imageHasBeenOptimized;return E.a.createElement(oe.a,{className:"upload-modal-message",type:S,iconClassMapping:{warning:"lrn-icon-warning",error:"lrn-icon-info"},ariaHidden:!0},O)}},{key:"showProcessingImageError",value:function showProcessingImageError(){this.file=null,this.uploadAborted=!1,this.setState({loading:!1,url:null,error:!0})}},{key:"processSelectedImage",value:function processSelectedImage(t){var r,a=this;return this.setState({loading:!0,error:!1}),Object(ie.c)(t).then((function(a){return r=a.width,t})).then((function processImage(){return a.shouldCompress(t,r)?(a.setState({warning:a.shouldShowWarning(t,r)}),r>X.d.FULL_SIZE&&(l={width:X.d.FULL_SIZE}),a.props.compressImage(t,{rotation:0,compressOptions:l})):(a.setState({warning:null,error:null}),Promise.resolve(t));var l})).then((function(t){return a.file=t,Object(ie.c)(t)})).then((function(t){return a.setState({loading:!1,url:t.src,width:t.width,naturalWidth:t.width,naturalHeight:t.height,rotation:0})})).catch((function(){a.showProcessingImageError()}))}},{key:"insertImage",value:function insertImage(t){var r=t.url,a=t.assetPath;(0,this.props.onApply)(generateImageAttributes(_objectSpread(_objectSpread({},this.state),{},{url:r,assetPath:a}))),this.cleanUpAndClose()}},{key:"shouldCompress",value:function shouldCompress(t,r){return t.size>this.props.maxFileSize||r>X.d.FULL_SIZE}},{key:"shouldShowWarning",value:function shouldShowWarning(t,r){return t.size>this.props.warningFileSize||r>X.d.FULL_SIZE}}]),UploadImageModal}(E.a.PureComponent),ge=j.b((function(t){return{maxFileSize:t.longTextV2.maxFileSize,warningFileSize:t.longTextV2.warningFileSize}}),(function(t){return{compressImage:D.b(de.compressImage,t),uploadImage:D.b(de.uploadImage,t)}}))(he);function insertImageButton_extends(){return(insertImageButton_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function insertImageButton_slicedToArray(t,r){return function insertImageButton_arrayWithHoles(t){if(Array.isArray(t))return t}(t)||function insertImageButton_iterableToArrayLimit(t,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],l=!0,S=!1,O=void 0;try{for(var L,E=t[Symbol.iterator]();!(l=(L=E.next()).done)&&(a.push(L.value),!r||a.length!==r);l=!0);}catch(t){S=!0,O=t}finally{try{l||null==E.return||E.return()}finally{if(S)throw O}}return a}(t,r)||function insertImageButton_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return insertImageButton_arrayLikeToArray(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return insertImageButton_arrayLikeToArray(t,r)}(t,r)||function insertImageButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function insertImageButton_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,l=new Array(r);a<r;a++)l[a]=t[a];return l}function editorModal_typeof(t){return(editorModal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function editorModal_extends(){return(editorModal_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function editorModal_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function editorModal_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function editorModal_setPrototypeOf(t,r){return(editorModal_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function editorModal_createSuper(t){var r=function editorModal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=editorModal_getPrototypeOf(t);if(r){var S=editorModal_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return editorModal_possibleConstructorReturn(this,a)}}function editorModal_possibleConstructorReturn(t,r){return!r||"object"!==editorModal_typeof(r)&&"function"!=typeof r?editorModal_assertThisInitialized(t):r}function editorModal_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function editorModal_getPrototypeOf(t){return(editorModal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function editorModal_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var me={url:null,align:"",width:0,naturalWidth:0,size:X.e.FULL_SIZE},ye={InsertImageButton:function InsertImageButton(t){var r=insertImageButton_slicedToArray(Object(L.useState)(!1),2),a=r[0],l=r[1],O=insertImageButton_slicedToArray(Object(L.useState)(null),2),D=O[0],j=O[1],B=t.isActive,G=t.visible,Z=t.onApply,Q=t.getContainer,ee=t.onModal,te=t.editableElementSelector,ne=q()({hide:!G}),re=S.a.debounce((function(){j(null),ce.fileDialog({multiple:!1,accept:X.b}).then((function(t){ee(!0),l(!0),j(t[0])}))}),10,!0),oe=function(){var t=Q();if(t){var r=t.querySelector(te),a=r&&r.querySelectorAll("img");return!!(a&&a.length>=X.f)}return!1}();return E.a.createElement(E.a.Fragment,null,E.a.createElement($.a.Button,insertImageButton_extends({},t,{isActive:B,disabled:oe,className:ne,onClick:re})),E.a.createElement(ge,insertImageButton_extends({},t,{selectedFile:D,relativeNode:Q,modalIsOpen:a,onRequestClose:function closeModal(){ee(null),j(null),l(!1)},onApply:Z})))},EditImageButton:modalWithToggle(function(t){!function editorModal_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&editorModal_setPrototypeOf(t,r)}(ImageEditorModal,t);var r=editorModal_createSuper(ImageEditorModal);function ImageEditorModal(){var t;editorModal_classCallCheck(this,ImageEditorModal);for(var a=arguments.length,l=new Array(a),O=0;O<a;O++)l[O]=arguments[O];return editorModal_defineProperty(editorModal_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"state",S.a.extend({},me)),editorModal_defineProperty(editorModal_assertThisInitialized(t),"cleanUpAndClose",(function(){t.setState(me),t.props.onRequestClose()})),editorModal_defineProperty(editorModal_assertThisInitialized(t),"onImageEditorChanged",(function(r){var a=r.width,l=r.size;t.setState({width:a,size:l})})),editorModal_defineProperty(editorModal_assertThisInitialized(t),"onApply",(function(r){var a=t.props.onApply,l=generateImageAttributes(t.state);r.preventDefault(),r.stopPropagation(),a(l),t.cleanUpAndClose()})),t}return function editorModal_createClass(t,r,a){return r&&editorModal_defineProperties(t.prototype,r),a&&editorModal_defineProperties(t,a),t}(ImageEditorModal,[{key:"componentDidUpdate",value:function componentDidUpdate(){var t=this.props,r=t.image;t.modalIsOpen&&r&&this.state.url!==r.url&&this.setState(S.a.extend({},me,r))}},{key:"render",value:function render(){var t=this,r=this.state.url,a=this.props,l=a.i18n,S=a.relativeNode,O=a.responseId,L=a.modalIsOpen,D=l.labels.editor.modals;return E.a.createElement(E.a.Fragment,null,E.a.createElement(Q.a,{className:"lrn-full-width",getRef:function getRef(r){return t.el=r},title:D.imageTitle,parentNode:S,modalIsOpen:L,onRequestClose:this.cleanUpAndClose},r&&E.a.createElement(E.a.Fragment,null,E.a.createElement(ImageEditor,editorModal_extends({},this.state,{labels:D,responseId:O,onChange:this.onImageEditorChanged})),E.a.createElement("hr",null),E.a.createElement("div",{className:"lrn-wysihtml-modal-controls"},E.a.createElement("button",{className:"lrn_btn lrn_btn_blue editor-modal-blue-button","data-lrn-action":"apply",onClick:this.onApply,type:"button"},D.apply),E.a.createElement("button",{className:"lrn_btn","data-lrn-action":"cancel",onClick:this.cleanUpAndClose,type:"button"},D.cancel)))))}}]),ImageEditorModal}(E.a.PureComponent))};function subToolbar_extends(){return(subToolbar_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}var ve=function getImageFromProps(t){var r=S.a.findWhere(t.activeActions,{action:"insertImage"}),a=r&&r.target;return a?function getImageProps(t){var r,a,l,S=t.naturalWidth,O=t.naturalHeight,L=t.width,E=t.src,D=t.className;return{naturalWidth:S,naturalHeight:O,url:E,width:L||0,size:(r=D,a="lrn-size-(\\S+)",l=new RegExp(a,"g").exec(r),(l&&l.length>=2?l[1]:"")||X.e.FULL_SIZE)}}(a):null};function ImageEditorSubControl(t){var r=t.image,a=t.i18n,l=t.onClick,S=t.onModal,O=a.labels.editor.toolbar,L=!!r;return E.a.createElement(E.a.Fragment,null,E.a.createElement(ye.EditImageButton,subToolbar_extends({},t,{name:"editImage",image:r,getImage:function getImage(){return r},icon:X.a.image.icons.edit,label:O.editImage,isActive:!1,visible:!0,disabled:!L,onApply:function onApply(t){return l({type:"insertImage",params:t})},onModal:function onModal(t){return S(t?"editImage":null)}})),E.a.createElement($.a.Button,subToolbar_extends({},t,{name:"preview",icon:X.a.image.icons.preview,label:O.previewImage,disabled:!L,onClick:function onClick(){return l({type:"previewImage",url:r.url})}})),E.a.createElement($.a.Button,subToolbar_extends({},t,{name:"delete",icon:X.a.image.icons.delete,label:O.deleteImage,disabled:!L,onClick:function onClick(){return l({type:"deleteImage"})}})))}function SubToolbar(t){var r=ve(t),a=q()({in:!!r},"lrn-sub-toolbar lrn-wysihtml-toolbar lrn-animation-dropdown");return E.a.createElement("div",{className:a},S.a.contains(t.formattingOptions,"image")&&E.a.createElement(ImageEditorSubControl,subToolbar_extends({},t,{image:r})))}var be=a(290);function toolbar_typeof(t){return(toolbar_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function toolbar_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function toolbar_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function toolbar_setPrototypeOf(t,r){return(toolbar_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function toolbar_createSuper(t){var r=function toolbar_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=toolbar_getPrototypeOf(t);if(r){var S=toolbar_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return toolbar_possibleConstructorReturn(this,a)}}function toolbar_possibleConstructorReturn(t,r){return!r||"object"!==toolbar_typeof(r)&&"function"!=typeof r?toolbar_assertThisInitialized(t):r}function toolbar_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function toolbar_getPrototypeOf(t){return(toolbar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function toolbar_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return toolbar_arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function toolbar_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return toolbar_arrayLikeToArray(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return toolbar_arrayLikeToArray(t,r)}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function toolbar_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,l=new Array(r);a<r;a++)l[a]=t[a];return l}function toolbar_extends(){return(toolbar_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}var _e="ArrowRight",we="ArrowLeft";function getControls(t,r){return S.a.reduce(t.formattingOptions,(function(a,l){var S=X.a[l],O=a.length,L={control:S,key:l,index:O,props:t,selectedIndex:r};if(S&&(a.push(getControl(L)),"table"===l)){var E={control:X.a.editTable,key:"editTable",index:O+1,props:t,selectedIndex:r};a.push(getControl(E))}return a}),[])}function getControl(t){var r=t.control,a=t.key,l=t.index,O=t.props,L=t.selectedIndex,D=O.i18n,j=O.isChemistry,B=O.disabled,q=O.activeModal,G=O.formulaEditorHorizontalLayout,X=O.formulaEditorNumberPad,Q=O.formulaEditorSymbols,ee=O.formulaEditorTextBlocks,te=O.modalData,re=O.activeActions,oe=O.onClick,ie=O.onModal,ae=O.onMouseEnter,se=O.onMouseLeave,le=O.characterMapModalClassName,ce=O.focusButtonInsideToolbar,ue=O.disableSpokenmathUserInputs,pe=D.labels.ariaLabel,de=r.icon,fe=r.type,he=D.labels.editor.toolbar[a],ge=!!S.a.findWhere(re,{action:a}),me="".concat(a).concat(l),ve=l===L?0:-1;switch(fe){case"divider":return E.a.createElement($.a.Divider,{key:me,name:fe});case"button":return E.a.createElement($.a.Button,toolbar_extends({},O,{key:me,name:a,icon:de,label:he,tabIndex:ve,isActive:ge,disabled:B,onClick:function onClick(){return oe({type:a})}}));case"charactermap":var _e=O.characterMap,we=!0===_e?_toConsumableArray(D.labels.characterMapCharacters):_e;return E.a.createElement(Z.a.CharacterMapButton,{key:me,label:D.labels.characterMapIcon,title:D.labels.characterMapTitle,disabled:B,characters:we,className:"lrn-wysihtml-toolbar",modalClassName:le,tabIndex:ve,recoverFocus:ce,onMouseEnter:function onMouseEnter(){return ae(D.labels.characterMapTitle)},onMouseLeave:se,onSelect:function onSelect(t){return oe({type:"characterMap",params:t})}});case"characterMathMap":var xe=_toConsumableArray(D.labels.characterMapMathCharacters);return(E.a.createElement(Z.a.CharacterMapButton,{key:me,label:D.labels.characterMapMathIcon,title:D.labels.characterMathMapTitle,onMouseEnter:function onMouseEnter(){return ae(D.labels.characterMathMapTitle)},onMouseLeave:se,disabled:B,characters:xe,tabIndex:ve,recoverFocus:ce,className:"lrn-wysihtml-toolbar",modalClassName:le,onSelect:function onSelect(t){return oe({type:"characterMap",params:t})}}));case"createTable":var Ce=S.a.findWhere(re,{action:"editTable"});return(E.a.createElement(ne.CreateTableButton,toolbar_extends({},O,{key:me,name:a,icon:de,tabIndex:ve,label:he,disabled:B,visible:!Ce,onApply:function onApply(t){return oe({type:"createTable",params:t})},onModal:function onModal(t){return ie(t?"createTable":null)}})));case"editTable":return E.a.createElement(ne.EditTableButton,toolbar_extends({},O,{key:me,name:a,icon:de,tabIndex:ve,label:D.labels.editor.editTable,isActive:ge,visible:ge,disabled:B,onApply:function onApply(t){return oe({type:t.type,params:t.params})},onModal:function onModal(t){return ie(t?"editTable":null)}}));case"insertImage":return E.a.createElement(ye.InsertImageButton,{i18n:D,getContainer:O.getContainer,editableElementSelector:O.editableElementSelector,responseId:O.responseId,key:me,name:"insertImage",icon:de,tabIndex:ve,label:he,visible:!0,onMouseEnter:ae,onMouseLeave:se,onApply:function onApply(t){return oe({type:"insertImage",params:t})},onModal:function onModal(t){return ie(t?"insertImage":null)}});case"formulaEditor":return E.a.createElement(be.a.FormulaEditorButton,{activeModal:q,className:"lrn-wysihtml-toolbar",disabled:B,getContainer:O.getContainer,disableSpokenmathUserInputs:ue,horizontalLayout:G,i18n:D,icon:de,isActive:ge,isChemistry:j,key:me,modalData:te,onApply:function onApply(t){return oe(t)},onModal:ie,onMouseEnter:function onMouseEnter(){return ae(pe.mathKeyboard.title)},onMouseLeave:se,tabIndex:ve,symbols:Q,textBlocks:ee,numberPad:X,title:pe.mathKeyboard.title});default:return null}}function lrnToolbar_extends(){return(lrnToolbar_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}var xe={WYSIHTML:function withWYSIHTML(t){return function(r){return r.isReviewState?null:E.a.createElement(t,lrnToolbar_extends({},r,{className:"lrn-wysihtml-toolbar",activeClassName:"wysihtml-command-active",role:"group"}))}}(function(t){!function toolbar_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&toolbar_setPrototypeOf(t,r)}(Toolbar,t);var r=toolbar_createSuper(Toolbar);function Toolbar(){var t;toolbar_classCallCheck(this,Toolbar);for(var a=arguments.length,l=new Array(a),S=0;S<a;S++)l[S]=arguments[S];return toolbar_defineProperty(toolbar_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"state",{index:0}),toolbar_defineProperty(toolbar_assertThisInitialized(t),"handleKeyDown",(function(r){r.stopPropagation();var a=r.key;if(a===we||a===_e){var l=t.rovingTabIndex(a);t.setState({index:l})}})),toolbar_defineProperty(toolbar_assertThisInitialized(t),"rovingTabIndex",(function(r){for(var a=toolbar_assertThisInitialized(t),l=a.props,S=a.state,O=getControls(l,S.index),L=t.moveIndex(S.index,r,O.length);"divider"===O[L].props.name||"editTable"===O[L].props.name;)L=t.moveIndex(L,r,O.length);return L})),toolbar_defineProperty(toolbar_assertThisInitialized(t),"moveIndex",(function(t,r,a){var l=t;return r===we?l--:r===_e&&l++,Math.max(Math.min(l,a-1),0)})),t}return function toolbar_createClass(t,r,a){return r&&toolbar_defineProperties(t.prototype,r),a&&toolbar_defineProperties(t,a),t}(Toolbar,[{key:"componentDidUpdate",value:function componentDidUpdate(t,r){this.state.index!==r.index&&this.props.focusButtonInsideToolbar()}},{key:"render",value:function render(){var t=this.props,r=this.state,a=t.i18n.labels.ariaLabel,l=getControls(t,r.index),S=q()({"lrn-toolbar-rtl":t.toolbarRtlEditingMode},t.className,"lrn_clearfix");return E.a.createElement("div",{className:"lrn-toolbar"},E.a.createElement("div",{ref:t.toolbarRef,onKeyDown:this.handleKeyDown,className:S,role:"toolbar","aria-label":a.longTextV2.toolbar},l),E.a.createElement(SubToolbar,t))}}]),Toolbar}(E.a.Component))};function preview_typeof(t){return(preview_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function preview_ownKeys(t,r){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);r&&(l=l.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),a.push.apply(a,l)}return a}function preview_objectSpread(t){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?preview_ownKeys(Object(a),!0).forEach((function(r){preview_defineProperty(t,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):preview_ownKeys(Object(a)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))}))}return t}function preview_extends(){return(preview_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function preview_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function preview_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function preview_createClass(t,r,a){return r&&preview_defineProperties(t.prototype,r),a&&preview_defineProperties(t,a),t}function preview_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&preview_setPrototypeOf(t,r)}function preview_setPrototypeOf(t,r){return(preview_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function preview_createSuper(t){var r=function preview_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=preview_getPrototypeOf(t);if(r){var S=preview_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return preview_possibleConstructorReturn(this,a)}}function preview_possibleConstructorReturn(t,r){return!r||"object"!==preview_typeof(r)&&"function"!=typeof r?preview_assertThisInitialized(t):r}function preview_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function preview_getPrototypeOf(t){return(preview_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function preview_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var Ce={fullSize:!1,scrollPosition:null,zoomable:!1,imageSizeText:""},Se=function(t){preview_inherits(ImagePreview,t);var r=preview_createSuper(ImagePreview);function ImagePreview(){var t;preview_classCallCheck(this,ImagePreview);for(var a=arguments.length,l=new Array(a),S=0;S<a;S++)l[S]=arguments[S];return preview_defineProperty(preview_assertThisInitialized(t=r.call.apply(r,[this].concat(l))),"state",preview_objectSpread({},Ce)),preview_defineProperty(preview_assertThisInitialized(t),"onImageClick",(function(r){if(r.preventDefault(),r.stopPropagation(),t.state.fullSize)t.onToggleFullSize();else{var a=r.currentTarget.getBoundingClientRect(),l=(r.clientX-a.left)/a.width,S=(r.clientY-a.top)/a.height;t.setState({fullSize:!0},(function(){t.scrollToPosition(l,S)}))}})),preview_defineProperty(preview_assertThisInitialized(t),"validateImageSize",(function(){if(t.image&&t.imageWrapper){var r=t.props.labels,a=t.image,l=a.naturalWidth,S=a.naturalHeight,O=t.imageWrapper.getBoundingClientRect();t.setState({imageSizeText:Object(ae.a)(r.imagePreviewText,{width:l,height:S}),zoomable:l>O.width||S>O.height})}})),preview_defineProperty(preview_assertThisInitialized(t),"close",(function(){t.setState(Ce),t.props.onClose()})),preview_defineProperty(preview_assertThisInitialized(t),"onToggleFullSize",(function(){t.setState({fullSize:!t.state.fullSize})})),t}return preview_createClass(ImagePreview,[{key:"render",value:function render(){var t=this,r=this.props,a=this.state,l=r.url,S=r.labels,O=a.fullSize,L=a.zoomable,D=a.imageSizeText;if(!l)return null;var j=q()({"full-size":O,zoomable:L}),B=L?{onClick:this.onImageClick}:{};return E.a.createElement("div",{className:"lrn-image-preview"},E.a.createElement("div",{className:"lrn-image-preview-toolbar"},E.a.createElement("div",{className:"lrn-image-preview-size-label"},D),E.a.createElement("div",{className:"lrn-image-preview-control"},E.a.createElement("a",{className:"lrn_btn lrn-btn-outline snow-theme",href:l,target:"_blank"},S.openImageURL),L&&E.a.createElement("button",{className:"lrn_btn lrn-btn-outline snow-theme",onClick:this.onToggleFullSize,type:"button"},O?S.zoomOut:S.zoomIn)),E.a.createElement("div",{className:"close-button"},E.a.createElement("button",{className:"lrn_btn lrn-btn-outline snow-theme lrn-btn-close",type:"button",onClick:this.close},E.a.createElement("span",{className:"lrn-icon-clear"})))),E.a.createElement("div",{className:"lrn-image-wrapper-container"},E.a.createElement("div",{className:"lrn-image-wrapper",ref:function ref(r){return t.imageWrapper=r}},E.a.createElement("img",preview_extends({src:l,className:j,onLoad:this.validateImageSize,ref:function ref(r){return t.image=r},alt:S.imageTitle},B)))))}},{key:"scrollToPosition",value:function scrollToPosition(t,r){var a=this.image.getBoundingClientRect(),l=a.width,S=a.height,O=this.imageWrapper.getBoundingClientRect(),L=parseInt(t*l-O.width/2,10),E=parseInt(r*S-O.height/2,10);this.imageWrapper.scrollTop=E,this.imageWrapper.scrollLeft=L}}]),ImagePreview}(E.a.PureComponent),Oe=function withImageClickDetection(t){return function(r){preview_inherits(_temp,r);var a=preview_createSuper(_temp);function _temp(){var t;preview_classCallCheck(this,_temp);for(var r=arguments.length,l=new Array(r),S=0;S<r;S++)l[S]=arguments[S];return preview_defineProperty(preview_assertThisInitialized(t=a.call.apply(a,[this].concat(l))),"state",{url:null}),preview_defineProperty(preview_assertThisInitialized(t),"onContainerClick",(function(r){r.preventDefault(),r.stopPropagation(),"IMG"===r.target.tagName&&(t.setState({url:r.target.src}),t.props.onOpen())})),preview_defineProperty(preview_assertThisInitialized(t),"onClose",(function(){t.setState({url:null}),t.props.onClose()})),t}return preview_createClass(_temp,[{key:"componentDidMount",value:function componentDidMount(){this.container=this.props.getContainer(),this.container.addEventListener("click",this.onContainerClick)}},{key:"componentDidUpdate",value:function componentDidUpdate(t,r){r.url!==this.state.url&&(this.state.url?this.container.removeEventListener("click",this.onContainerClick):this.container.addEventListener("click",this.onContainerClick))}},{key:"render",value:function render(){return E.a.createElement(t,preview_extends({},this.props,{url:this.state.url,onClose:this.onClose}))}}]),_temp}(E.a.PureComponent)}(Se),Te=a(274);function Tooltip(t){var r=t.disabled,a=t.activeAction;return r?null:E.a.createElement("span",null,a)}function LengthIndicator(t){var r=t.wordCountExceeded,a="lrn_length_indicator  ".concat(r?"lrn_wordcount_warning_label":"");return E.a.createElement("span",{className:a}," ",E.a.createElement(WordCount,t),E.a.createElement(WordStatic,t),E.a.createElement(WordLimit,t),E.a.createElement(AccessibleCounter,t))}function WordCount(t){var r=t.wordCountVisible,a=t.wordCount;return r?E.a.createElement("span",{className:"lrn_word_count"},a):null}function AccessibleCounter(t){var r=t.textToAnnounce;return(E.a.createElement("span",{className:"sr-only","aria-live":"polite","aria-atomic":"true"},r))}function WordStatic(t){var r=t.wordStaticVisible,a=t.wordCountVisible,l=t.i18n.labels.word;return r&&a?E.a.createElement("span",{className:"lrn_static_words"},l):null}function WordLimit(t){var r=t.wordLimitVisible,a=t.wordCountVisible,l=t.wordMaxLength,S=a?" /":"",O=t.i18n.labels.wordLength,L="".concat(S," ").concat(l," ").concat(O);return r?E.a.createElement("span",{className:"lrn_word_limit"},L):null}var Pe=function Footer(t){return E.a.createElement("footer",{className:"lrn-toolbar-footer  lrn_clearfix"},E.a.createElement("div",{className:"lrn_toolbar_footer_left"},E.a.createElement(Tooltip,t)),E.a.createElement("div",{className:"lrn_toolbar_footer_right"},E.a.createElement(LengthIndicator,t)))},Le=a(32);function longTextV2_typeof(t){return(longTextV2_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function longTextV2_extends(){return(longTextV2_extends=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t}).apply(this,arguments)}function longTextV2_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function longTextV2_createClass(t,r,a){return r&&longTextV2_defineProperties(t.prototype,r),a&&longTextV2_defineProperties(t,a),t}function longTextV2_setPrototypeOf(t,r){return(longTextV2_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function longTextV2_createSuper(t){var r=function longTextV2_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=longTextV2_getPrototypeOf(t);if(r){var S=longTextV2_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return longTextV2_possibleConstructorReturn(this,a)}}function longTextV2_possibleConstructorReturn(t,r){return!r||"object"!==longTextV2_typeof(r)&&"function"!=typeof r?longTextV2_assertThisInitialized(t):r}function longTextV2_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function longTextV2_getPrototypeOf(t){return(longTextV2_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function longTextV2_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var ke=function(t){!function longTextV2_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&longTextV2_setPrototypeOf(t,r)}(LongTextV2,t);var r=longTextV2_createSuper(LongTextV2);function LongTextV2(t){var a;return function longTextV2_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,LongTextV2),longTextV2_defineProperty(longTextV2_assertThisInitialized(a=r.call(this,t)),"state",{toolbarActiveActions:[],toolbarRtlEditingMode:Le.a.isRtl(),footerActiveAction:null,isPreviewingImage:!1,previewingImageUrl:null,actionToDo:null,activeModal:null,modalData:null,container:null,textToAnnounce:""}),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"toolbarRef",E.a.createRef()),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"setContainerElement",(function(t){return a.el=t})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"getContainerElement",(function(){return a.el})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onImagePreviewOpened",(function(){return a.setState({isPreviewingImage:!0})})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onImagePreviewClosed",(function(){return a.setState({isPreviewingImage:!1,previewingImageUrl:null})})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"focusButtonInsideToolbar",(function(){var t=a.toolbarRef.current.querySelector("[tabIndex='0']");t&&t.focus()})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onToolbarControlHover",(function(t){a.setState({footerActiveAction:t})})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onToolbarActionToDo",(function(t){t&&"previewImage"===t.type?(a.setState({previewingImageUrl:t.url}),a.onImagePreviewOpened()):a.setState({actionToDo:t})})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onEditorActionDone",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=r.type,O=S()([X.c.EDIT_FORMULA,X.c.CREATE_FORMULA]).contains(l);O&&a.props.renderMath(),a.setState(S.a.extend(getToolbarState(t),{actionToDo:null}))})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onEditorInteraction",(function(t){a.setState(getToolbarState(t))})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onEditorValueChange",(function(t){a.props.longTextV2Actions.updateValue(t),a.updateAriaLiveText()})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onMathWidgetPaste",(function(){a.props.renderMath()})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onMathWidgetSelect",(function(t){a.onModal(X.g.FORMULA_EDITOR,t)})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"updateAriaLiveText",(function(){var t=a.getWordLimitText();setTimeout((function(){return!a._unmounted&&a.setState({textToAnnounce:t})}),500)})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"getWordLimitText",(function(){var t=a.props.longTextV2.footer,r=t.wordCount,l=t.wordMaxLength,S=t.wordCountVisible,O=t.wordLimitVisible,L="of ".concat(l," allowed");return S?"".concat(r," words written ").concat(O?L:""):""})),longTextV2_defineProperty(longTextV2_assertThisInitialized(a),"onModal",(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a.setState({modalData:r,activeModal:t})})),a.onEditorValueChange=S.a.debounce(a.onEditorValueChange,500).bind(longTextV2_assertThisInitialized(a)),a.updateAriaLiveText=S.a.debounce(a.updateAriaLiveText,500),a}return longTextV2_createClass(LongTextV2,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return!this._unmounted}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._unmounted=!0}}]),longTextV2_createClass(LongTextV2,[{key:"render",value:function render(){var t=this,r=this.props,a=r.base,l=r.longTextV2,O=r.canInsertImage,L=a.isReviewState,D=a.isPreviewState,j=a.readOnly,B=a.disabled,X=a.i18n,$=a.fontSizeClass,Z=a.responseId,Q=l.wordCountExceeded,ee=l.disableAutoLink,te=this.state,ne=te.toolbarActiveActions,re=te.toolbarRtlEditingMode,oe=te.isPreviewingImage,ie=te.previewingImageUrl,ae=te.footerActiveAction,se=te.actionToDo,le=te.activeModal,ce=te.modalData,ue=te.container,pe=te.textToAnnounce,de=q()({lrn_texteditor_inactive:le,lrn_hide:oe},"lrn_texteditor"),fe=B||j,he="chemistryessayV2"===a.questionType,ge=a.disableSpokenmathUserInputs,me=l.toolbar.formattingOptions,ye=!S.a.contains(me,"image"),ve=!S.a.contains(me,"formulaEditor"),be=X.labels.longTextV2,_e=be.invalidExternalImageWarning,we=be.invalidExternalMathWarning;return E.a.createElement(G.a,{responsive:O},E.a.createElement("div",{className:"lrn_response_input_wrapper"},E.a.createElement("div",{className:de,ref:this.setContainerElement},E.a.createElement(xe.WYSIHTML,longTextV2_extends({},l.toolbar,{toolbarRtlEditingMode:re,isReviewState:L,isPreviewState:D,disableSpokenmathUserInputs:ge,i18n:X,isChemistry:he,characterMapModalClassName:$,disabled:fe||le,activeActions:ne,activeModal:le,modalData:ce,responseId:Z,getContainer:function getContainer(){return ue},editableElementSelector:".".concat("lrn_longtextinput"),onMouseEnter:this.onToolbarControlHover,onMouseLeave:function onMouseLeave(){return t.onToolbarControlHover(null)},onClick:this.onToolbarActionToDo,onModal:this.onModal,focusButtonInsideToolbar:this.focusButtonInsideToolbar,toolbarRef:this.toolbarRef})),E.a.createElement(Te.a.WYSIHTML,longTextV2_extends({},l.lrnEditor,{isReviewState:L,readOnly:j,className:"lrn_longtextinput",disabled:fe,inactive:!!le,i18n:X,wordCountExceeded:Q,actionToDo:se,focusButtonInsideToolbar:this.focusButtonInsideToolbar,onInteraction:this.onEditorInteraction,onValueChange:this.onEditorValueChange,onActionDone:this.onEditorActionDone,onMathWidgetSelect:this.onMathWidgetSelect,onMathWidgetPaste:this.onMathWidgetPaste,disableAutoLink:ee,invalidExternalImageWarning:_e,invalidExternalMathWarning:we,stripExternalPastedImages:ye,stripExternalPastedMath:ve})),E.a.createElement(Pe,longTextV2_extends({},l.footer,{textToAnnounce:pe,i18n:X,disabled:fe,wordCountExceeded:Q,activeAction:ae}))),j&&E.a.createElement(Oe,{labels:X.labels.editor.modals,getContainer:this.getContainerElement,onOpen:this.onImagePreviewOpened,onClose:this.onImagePreviewClosed}),!j&&O&&E.a.createElement(Se,{url:ie,labels:X.labels.editor.modals,visible:oe,getContainer:this.getContainerElement,onOpen:this.onImagePreviewOpened,onClose:this.onImagePreviewClosed})))}},{key:"componentDidMount",value:function componentDidMount(){this.setState({container:this.el})}}]),LongTextV2}(E.a.Component);function getToolbarState(t){return{toolbarActiveActions:t,toolbarRtlEditingMode:S.a.isEmpty(t)?Le.a.isRtl():S.a.some(t,{action:"textDirectionRtl"})}}var Me=j.b((function(t){return{base:t.base,longTextV2:t.longTextV2,canInsertImage:S.a.contains(t.longTextV2.toolbar.formattingOptions,"image")}}),(function(t){return{longTextV2Actions:D.b(de,t),renderMath:D.b(ue.a.renderMathIfRequired,t)}}))(ke),Ee=a(26),Ie=a(211),Ae=a(196),Ne=a(261),De=a(199);function dataService_arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var a=0,l=new Array(r);a<r;a++)l[a]=t[a];return l}function dataService_typeof(t){return(dataService_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dataService_defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}function _get(t,r,a){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,a){var l=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=dataService_getPrototypeOf(t)););return t}(t,r);if(l){var S=Object.getOwnPropertyDescriptor(l,r);return S.get?S.get.call(a):S.value}})(t,r,a||t)}function dataService_setPrototypeOf(t,r){return(dataService_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function dataService_createSuper(t){var r=function dataService_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=dataService_getPrototypeOf(t);if(r){var S=dataService_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return dataService_possibleConstructorReturn(this,a)}}function dataService_possibleConstructorReturn(t,r){return!r||"object"!==dataService_typeof(r)&&"function"!=typeof r?dataService_assertThisInitialized(t):r}function dataService_assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dataService_getPrototypeOf(t){return(dataService_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Re=function(t){!function dataService_inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&dataService_setPrototypeOf(t,r)}(LongTextV2DataService,t);var r=dataService_createSuper(LongTextV2DataService);function LongTextV2DataService(t,a){var l;return function dataService_classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,LongTextV2DataService),l=r.call(this,t,a),Object(Ie.a)(dataService_assertThisInitialized(l)),Object(Ne.a)(dataService_assertThisInitialized(l)),l}return function dataService_createClass(t,r,a){return r&&dataService_defineProperties(t.prototype,r),a&&dataService_defineProperties(t,a),t}(LongTextV2DataService,[{key:"getInitialState",value:function getInitialState(){var t=_get(dataService_getPrototypeOf(LongTextV2DataService.prototype),"getInitialState",this).call(this),r=this.placeholder,a=this.browserSpellCheck,l=Object(Ae.a)(a),O=Object(Ae.b)(a),L=Object(Ae.c)(a),E=this.isReviewState?this.getReviewResponseValue():this.responseValue,D=this.uiStyle,j=this.wordCount,B=this.wordCountExceeded,q=this.wordCountVisible,G=this.wordLimitVisibility,X=G.wordStatic,$=G.wordLimit,Z=this.wordMaxLength,Q=this.formattingOptions,ee=this.characterMap,te=this.disableAutoLink,ne=this.formulaEditorHorizontalLayout,re=this.formulaEditorSymbols,oe=this.formulaEditorTextBlocks,ie=this.formulaEditorNumberPad;return S.a.extend(t,{longTextV2:{wordCountExceeded:B,disableAutoLink:te,maxFileSize:this.maxFileSize,warningFileSize:this.warningFileSize,toolbar:{formattingOptions:Q,characterMap:ee,formulaEditorHorizontalLayout:ne,formulaEditorNumberPad:ie,formulaEditorSymbols:re,formulaEditorTextBlocks:oe},lrnEditor:{placeholder:r,spellCheck:a,autocapitalize:l,autocomplete:O,autocorrect:L,responseValue:E,uiStyle:D},footer:{wordCount:j,wordCountVisible:q,wordStaticVisible:X,wordLimitVisible:$,wordMaxLength:Z}}})}},{key:"getWordLimitVisibility",value:function getWordLimitVisibility(){return this.wordLimitVisibility}},{key:"getWordCountExceeded",value:function getWordCountExceeded(){return this.wordCountExceeded}},{key:"formatValue",value:function formatValue(t){return t=(t||"").replace(/<p[^>]*>\s?<\/p>/gi,"")}},{key:"getReviewResponseValue",value:function getReviewResponseValue(){var t=this.responseValue;return De.a.parse(t)}},{key:"wordLimitVisibility",get:function get(){var t,r,a=this.model,l=a.SHOW_WORD_LIMITS,S=a.getShowWordLimit();return S===l.ALWAYS||S===l.ON&&this.wordCountExceeded?(r=!0,t=!1):(r=!1,t=!0),{wordLimit:r,wordStatic:t}}},{key:"placeholder",get:function get(){return this.model.getPlaceholder()}},{key:"browserSpellCheck",get:function get(){return this.model.getBrowserSpellCheck()}},{key:"disableAutoLink",get:function get(){return this.model.disableAutoLink()}},{key:"formulaEditorHorizontalLayout",get:function get(){return!!this.question.horizontal_layout}},{key:"formulaEditorNumberPad",get:function get(){return this.question.numberPad}},{key:"formulaEditorSymbols",get:function get(){return this.question.symbols}},{key:"formulaEditorTextBlocks",get:function get(){return this.question.text_blocks}},{key:"responseValue",get:function get(){var t=this.getResponse();return S.a.getNested(t,"value")}},{key:"uiStyle",get:function get(){var t=S.a.extend({},this.model.getUIStyle());return t.minHeight=t.min_height||"",t.maxHeight=t.max_height||"",delete t.min_height,delete t.max_height,t}},{key:"wordCount",get:function get(){return this.model.getWordCount()}},{key:"wordCountExceeded",get:function get(){return this.model.wordCountExceeded()}},{key:"wordCountVisible",get:function get(){return this.model.getShowWordCount()}},{key:"wordMaxLength",get:function get(){return this.model.getMaxLength()}},{key:"formattingOptions",get:function get(){return this.model.getFormattingOptions()}}]),LongTextV2DataService}(Ee.a);Re.prototype.EXPOSED_METHODS=[].concat(function dataService_toConsumableArray(t){return function dataService_arrayWithoutHoles(t){if(Array.isArray(t))return dataService_arrayLikeToArray(t)}(t)||function dataService_iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function dataService_unsupportedIterableToArray(t,r){if(!t)return;if("string"==typeof t)return dataService_arrayLikeToArray(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return dataService_arrayLikeToArray(t,r)}(t)||function dataService_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Re.prototype.EXPOSED_METHODS),["getWordLimitVisibility","getWordCountExceeded","formatValue"]);var ze,Fe=Re,We=a(25),je=a(213);function reducer_defineProperty(t,r,a){return r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t}var He=Object(je.a)("[\\p{L}\\p{N}]"),Ve=de.actionTypes,Be=(reducer_defineProperty(ze={},Ve.LONGTEXTV2_UPDATE_WORD_COUNT,(function(t,r){var a=t.footer,l=function getWordCount(t){if(!S.a.isString(t)||S.a.isEmpty(t))return 0;return t=t.replace(/( | )/," ").replace(/[\n\r]/g," ").replace(/&nbsp;/g," ").replace(/<\/p>/g," ").replace(/<\/blockquote>/g," ").replace(/<\/li>/g," ").replace(/<\/div>/g," ").replace(/<br>/g," ").replace(/<br \/>/g," ").replace(/<.*?>/g,""),S.a.reduce(t.split(/\s+/),(function(t,r){return r.length>0&&He.test(r)?t+1:t}),0)}(r.value);return{footer:S.a.extend({},a,{wordCount:l})}})),reducer_defineProperty(ze,Ve.LONGTEXTV2_UPDATE_WORD_COUNT_EXCEEDED,(function(t,r){return{wordCountExceeded:r.value}})),reducer_defineProperty(ze,Ve.LONGTEXTV2_UPDATE_WORD_LIMIT_VISIBILITY,(function(t,r){var a=t.footer,l=r.value;return{footer:S.a.extend({},a,{wordStaticVisible:l.wordStatic,wordLimitVisible:l.wordLimit})}})),reducer_defineProperty(ze,Ve.LONGTEXTV2_DISABLE_EDITOR,(function(t,r){return{disabled:r.value}})),ze);var Ue=Object(We.a)(Be,{imageUrl:null,error:null});r.a=O.a.extend({maskable:!1,ViewComponent:Me,DataService:Fe,getReducers:function getReducers(){var t=O.a.prototype.getReducers.apply(this,arguments);return S.a.extend(t,{longTextV2:Ue})}})},291:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(17),L=a.n(O),E=a(155);r.a={getShuffleOption:function getShuffleOption(){return this.shuffleOption||(this.shuffleOption=new E.a(this)),this.shuffleOption},usingPossibleGroupingResponses:function usingPossibleGroupingResponses(){return!!this.get("question").group_possible_responses},getPossibleResponseGroups:function getPossibleResponseGroups(){var t=this.getShuffleOption(),r=S.a.map(this.get("question").possible_response_groups,(function(r){return{title:r.title,responses:t.getOrderedData(r.responses)}}));return S.a.each(r,(function(t){S.a.isString(t.title)?t.title=L.a.stripHTML(L.a.createImageDescriptions(t.title),!0):t.title=""})),r},getPossibleResponseGroupResponses:function getPossibleResponseGroupResponses(){var t,r;return t=this.getPossibleResponseGroups(),S.a.isArray(t)&&t.length&&(r=[],S.a.each(t,(function(t,a){S.a.each(t.responses,(function(t){r.push({value:t,groupIndex:a})}))}))),r},getPossibleResponses:function getPossibleResponses(){var t=this.getShuffleOption().getOrderedData(this.get("question").possible_responses);return S.a.map(t,(function(t){return{value:t}}))}}},307:function(t,r,a){t.exports=function(){"use strict";var t=navigator.userAgent,r=navigator.platform,a=/gecko\/\d/i.test(t),l=/MSIE \d/.test(t),S=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(t),O=/Edge\/(\d+)/.exec(t),L=l||S||O,E=L&&(l?document.documentMode||6:+(O||S)[1]),D=!O&&/WebKit\//.test(t),j=D&&/Qt\/\d+\.\d+/.test(t),B=!O&&/Chrome\//.test(t),q=/Opera\//.test(t),G=/Apple Computer/.test(navigator.vendor),X=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(t),$=/PhantomJS/.test(t),Z=G&&(/Mobile\/\w+/.test(t)||navigator.maxTouchPoints>2),Q=/Android/.test(t),ee=Z||Q||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(t),te=Z||/Mac/.test(r),ne=/\bCrOS\b/.test(t),re=/win/i.test(r),oe=q&&t.match(/Version\/(\d*\.\d*)/);oe&&(oe=Number(oe[1])),oe&&oe>=15&&(q=!1,D=!0);var ie=te&&(j||q&&(null==oe||oe<12.11)),ae=a||L&&E>=9;function classTest(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var se,rmClass=function(t,r){var a=t.className,l=classTest(r).exec(a);if(l){var S=a.slice(l.index+l[0].length);t.className=a.slice(0,l.index)+(S?l[1]+S:"")}};function removeChildren(t){for(var r=t.childNodes.length;r>0;--r)t.removeChild(t.firstChild);return t}function removeChildrenAndAdd(t,r){return removeChildren(t).appendChild(r)}function elt(t,r,a,l){var S=document.createElement(t);if(a&&(S.className=a),l&&(S.style.cssText=l),"string"==typeof r)S.appendChild(document.createTextNode(r));else if(r)for(var O=0;O<r.length;++O)S.appendChild(r[O]);return S}function eltP(t,r,a,l){var S=elt(t,r,a,l);return S.setAttribute("role","presentation"),S}function contains(t,r){if(3==r.nodeType&&(r=r.parentNode),t.contains)return t.contains(r);do{if(11==r.nodeType&&(r=r.host),r==t)return!0}while(r=r.parentNode)}function activeElt(){var t;try{t=document.activeElement}catch(r){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function addClass(t,r){var a=t.className;classTest(r).test(a)||(t.className+=(a?" ":"")+r)}function joinClasses(t,r){for(var a=t.split(" "),l=0;l<a.length;l++)a[l]&&!classTest(a[l]).test(r)&&(r+=" "+a[l]);return r}se=document.createRange?function(t,r,a,l){var S=document.createRange();return S.setEnd(l||t,a),S.setStart(t,r),S}:function(t,r,a){var l=document.body.createTextRange();try{l.moveToElementText(t.parentNode)}catch(t){return l}return l.collapse(!0),l.moveEnd("character",a),l.moveStart("character",r),l};var selectInput=function(t){t.select()};function bind(t){var r=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,r)}}function copyObj(t,r,a){for(var l in r||(r={}),t)!t.hasOwnProperty(l)||!1===a&&r.hasOwnProperty(l)||(r[l]=t[l]);return r}function countColumn(t,r,a,l,S){null==r&&-1==(r=t.search(/[^\s\u00a0]/))&&(r=t.length);for(var O=l||0,L=S||0;;){var E=t.indexOf("\t",O);if(E<0||E>=r)return L+(r-O);L+=E-O,L+=a-L%a,O=E+1}}Z?selectInput=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:L&&(selectInput=function(t){try{t.select()}catch(t){}});var Delayed=function(){this.id=null,this.f=null,this.time=0,this.handler=bind(this.onTimeout,this)};function indexOf(t,r){for(var a=0;a<t.length;++a)if(t[a]==r)return a;return-1}Delayed.prototype.onTimeout=function(t){t.id=0,t.time<=+new Date?t.f():setTimeout(t.handler,t.time-+new Date)},Delayed.prototype.set=function(t,r){this.f=r;var a=+new Date+t;(!this.id||a<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,t),this.time=a)};var le={toString:function(){return"CodeMirror.Pass"}},ce={scroll:!1},ue={origin:"*mouse"},pe={origin:"+move"};function findColumn(t,r,a){for(var l=0,S=0;;){var O=t.indexOf("\t",l);-1==O&&(O=t.length);var L=O-l;if(O==t.length||S+L>=r)return l+Math.min(L,r-S);if(S+=O-l,l=O+1,(S+=a-S%a)>=r)return l}}var de=[""];function spaceStr(t){for(;de.length<=t;)de.push(lst(de)+" ");return de[t]}function lst(t){return t[t.length-1]}function map(t,r){for(var a=[],l=0;l<t.length;l++)a[l]=r(t[l],l);return a}function nothing(){}function createObj(t,r){var a;return Object.create?a=Object.create(t):(nothing.prototype=t,a=new nothing),r&&copyObj(r,a),a}var fe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function isWordCharBasic(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||fe.test(t))}function isWordChar(t,r){return r?!!(r.source.indexOf("\\w")>-1&&isWordCharBasic(t))||r.test(t):isWordCharBasic(t)}function isEmpty(t){for(var r in t)if(t.hasOwnProperty(r)&&t[r])return!1;return!0}var he=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function isExtendingChar(t){return t.charCodeAt(0)>=768&&he.test(t)}function skipExtendingChars(t,r,a){for(;(a<0?r>0:r<t.length)&&isExtendingChar(t.charAt(r));)r+=a;return r}function findFirst(t,r,a){for(var l=r>a?-1:1;;){if(r==a)return r;var S=(r+a)/2,O=l<0?Math.ceil(S):Math.floor(S);if(O==r)return t(O)?r:a;t(O)?a=O:r=O+l}}var ge=null;function getBidiPartAt(t,r,a){var l;ge=null;for(var S=0;S<t.length;++S){var O=t[S];if(O.from<r&&O.to>r)return S;O.to==r&&(O.from!=O.to&&"before"==a?l=S:ge=S),O.from==r&&(O.from!=O.to&&"before"!=a?l=S:ge=S)}return null!=l?l:ge}var me=function(){var t=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,a=/[LRr]/,l=/[Lb1n]/,S=/[1n]/;function BidiSpan(t,r,a){this.level=t,this.from=r,this.to=a}return function(O,L){var E="ltr"==L?"L":"R";if(0==O.length||"ltr"==L&&!t.test(O))return!1;for(var D,j=O.length,B=[],q=0;q<j;++q)B.push((D=O.charCodeAt(q))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(D):1424<=D&&D<=1524?"R":1536<=D&&D<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(D-1536):1774<=D&&D<=2220?"r":8192<=D&&D<=8203?"w":8204==D?"b":"L");for(var G=0,X=E;G<j;++G){var $=B[G];"m"==$?B[G]=X:X=$}for(var Z=0,Q=E;Z<j;++Z){var ee=B[Z];"1"==ee&&"r"==Q?B[Z]="n":a.test(ee)&&(Q=ee,"r"==ee&&(B[Z]="R"))}for(var te=1,ne=B[0];te<j-1;++te){var re=B[te];"+"==re&&"1"==ne&&"1"==B[te+1]?B[te]="1":","!=re||ne!=B[te+1]||"1"!=ne&&"n"!=ne||(B[te]=ne),ne=re}for(var oe=0;oe<j;++oe){var ie=B[oe];if(","==ie)B[oe]="N";else if("%"==ie){var ae=void 0;for(ae=oe+1;ae<j&&"%"==B[ae];++ae);for(var se=oe&&"!"==B[oe-1]||ae<j&&"1"==B[ae]?"1":"N",le=oe;le<ae;++le)B[le]=se;oe=ae-1}}for(var ce=0,ue=E;ce<j;++ce){var pe=B[ce];"L"==ue&&"1"==pe?B[ce]="L":a.test(pe)&&(ue=pe)}for(var de=0;de<j;++de)if(r.test(B[de])){var fe=void 0;for(fe=de+1;fe<j&&r.test(B[fe]);++fe);for(var he="L"==(de?B[de-1]:E),ge=he==("L"==(fe<j?B[fe]:E))?he?"L":"R":E,me=de;me<fe;++me)B[me]=ge;de=fe-1}for(var ye,ve=[],be=0;be<j;)if(l.test(B[be])){var _e=be;for(++be;be<j&&l.test(B[be]);++be);ve.push(new BidiSpan(0,_e,be))}else{var we=be,xe=ve.length,Ce="rtl"==L?1:0;for(++be;be<j&&"L"!=B[be];++be);for(var Se=we;Se<be;)if(S.test(B[Se])){we<Se&&(ve.splice(xe,0,new BidiSpan(1,we,Se)),xe+=Ce);var Oe=Se;for(++Se;Se<be&&S.test(B[Se]);++Se);ve.splice(xe,0,new BidiSpan(2,Oe,Se)),xe+=Ce,we=Se}else++Se;we<be&&ve.splice(xe,0,new BidiSpan(1,we,be))}return"ltr"==L&&(1==ve[0].level&&(ye=O.match(/^\s+/))&&(ve[0].from=ye[0].length,ve.unshift(new BidiSpan(0,0,ye[0].length))),1==lst(ve).level&&(ye=O.match(/\s+$/))&&(lst(ve).to-=ye[0].length,ve.push(new BidiSpan(0,j-ye[0].length,j)))),"rtl"==L?ve.reverse():ve}}();function getOrder(t,r){var a=t.order;return null==a&&(a=t.order=me(t.text,r)),a}var ye=[],on=function(t,r,a){if(t.addEventListener)t.addEventListener(r,a,!1);else if(t.attachEvent)t.attachEvent("on"+r,a);else{var l=t._handlers||(t._handlers={});l[r]=(l[r]||ye).concat(a)}};function getHandlers(t,r){return t._handlers&&t._handlers[r]||ye}function off(t,r,a){if(t.removeEventListener)t.removeEventListener(r,a,!1);else if(t.detachEvent)t.detachEvent("on"+r,a);else{var l=t._handlers,S=l&&l[r];if(S){var O=indexOf(S,a);O>-1&&(l[r]=S.slice(0,O).concat(S.slice(O+1)))}}}function signal(t,r){var a=getHandlers(t,r);if(a.length)for(var l=Array.prototype.slice.call(arguments,2),S=0;S<a.length;++S)a[S].apply(null,l)}function signalDOMEvent(t,r,a){return"string"==typeof r&&(r={type:r,preventDefault:function(){this.defaultPrevented=!0}}),signal(t,a||r.type,t,r),e_defaultPrevented(r)||r.codemirrorIgnore}function signalCursorActivity(t){var r=t._handlers&&t._handlers.cursorActivity;if(r)for(var a=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),l=0;l<r.length;++l)-1==indexOf(a,r[l])&&a.push(r[l])}function hasHandler(t,r){return getHandlers(t,r).length>0}function eventMixin(t){t.prototype.on=function(t,r){on(this,t,r)},t.prototype.off=function(t,r){off(this,t,r)}}function e_preventDefault(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function e_stopPropagation(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function e_defaultPrevented(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function e_stop(t){e_preventDefault(t),e_stopPropagation(t)}function e_target(t){return t.target||t.srcElement}function e_button(t){var r=t.which;return null==r&&(1&t.button?r=1:2&t.button?r=3:4&t.button&&(r=2)),te&&t.ctrlKey&&1==r&&(r=3),r}var ve,be,_e=function(){if(L&&E<9)return!1;var t=elt("div");return"draggable"in t||"dragDrop"in t}();function zeroWidthElement(t){if(null==ve){var r=elt("span","​");removeChildrenAndAdd(t,elt("span",[r,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(ve=r.offsetWidth<=1&&r.offsetHeight>2&&!(L&&E<8))}var a=ve?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return a.setAttribute("cm-text",""),a}function hasBadBidiRects(t){if(null!=be)return be;var r=removeChildrenAndAdd(t,document.createTextNode("AخA")),a=se(r,0,1).getBoundingClientRect(),l=se(r,1,2).getBoundingClientRect();return removeChildren(t),!(!a||a.left==a.right)&&(be=l.right-a.right<3)}var we,xe=3!="\n\nb".split(/\n/).length?function(t){for(var r=0,a=[],l=t.length;r<=l;){var S=t.indexOf("\n",r);-1==S&&(S=t.length);var O=t.slice(r,"\r"==t.charAt(S-1)?S-1:S),L=O.indexOf("\r");-1!=L?(a.push(O.slice(0,L)),r+=L+1):(a.push(O),r=S+1)}return a}:function(t){return t.split(/\r\n?|\n/)},Ce=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){var r;try{r=t.ownerDocument.selection.createRange()}catch(t){}return!(!r||r.parentElement()!=t)&&0!=r.compareEndPoints("StartToEnd",r)},Se="oncopy"in(we=elt("div"))||(we.setAttribute("oncopy","return;"),"function"==typeof we.oncopy),Oe=null,Te={},Pe={};function defineMode(t,r){arguments.length>2&&(r.dependencies=Array.prototype.slice.call(arguments,2)),Te[t]=r}function resolveMode(t){if("string"==typeof t&&Pe.hasOwnProperty(t))t=Pe[t];else if(t&&"string"==typeof t.name&&Pe.hasOwnProperty(t.name)){var r=Pe[t.name];"string"==typeof r&&(r={name:r}),(t=createObj(r,t)).name=r.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return resolveMode("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return resolveMode("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function getMode(t,r){r=resolveMode(r);var a=Te[r.name];if(!a)return getMode(t,"text/plain");var l=a(t,r);if(Le.hasOwnProperty(r.name)){var S=Le[r.name];for(var O in S)S.hasOwnProperty(O)&&(l.hasOwnProperty(O)&&(l["_"+O]=l[O]),l[O]=S[O])}if(l.name=r.name,r.helperType&&(l.helperType=r.helperType),r.modeProps)for(var L in r.modeProps)l[L]=r.modeProps[L];return l}var Le={};function extendMode(t,r){copyObj(r,Le.hasOwnProperty(t)?Le[t]:Le[t]={})}function copyState(t,r){if(!0===r)return r;if(t.copyState)return t.copyState(r);var a={};for(var l in r){var S=r[l];S instanceof Array&&(S=S.concat([])),a[l]=S}return a}function innerMode(t,r){for(var a;t.innerMode&&(a=t.innerMode(r))&&a.mode!=t;)r=a.state,t=a.mode;return a||{mode:t,state:r}}function startState(t,r,a){return!t.startState||t.startState(r,a)}var StringStream=function(t,r,a){this.pos=this.start=0,this.string=t,this.tabSize=r||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=a};function getLine(t,r){if((r-=t.first)<0||r>=t.size)throw new Error("There is no line "+(r+t.first)+" in the document.");for(var a=t;!a.lines;)for(var l=0;;++l){var S=a.children[l],O=S.chunkSize();if(r<O){a=S;break}r-=O}return a.lines[r]}function getBetween(t,r,a){var l=[],S=r.line;return t.iter(r.line,a.line+1,(function(t){var O=t.text;S==a.line&&(O=O.slice(0,a.ch)),S==r.line&&(O=O.slice(r.ch)),l.push(O),++S})),l}function getLines(t,r,a){var l=[];return t.iter(r,a,(function(t){l.push(t.text)})),l}function updateLineHeight(t,r){var a=r-t.height;if(a)for(var l=t;l;l=l.parent)l.height+=a}function lineNo(t){if(null==t.parent)return null;for(var r=t.parent,a=indexOf(r.lines,t),l=r.parent;l;r=l,l=l.parent)for(var S=0;l.children[S]!=r;++S)a+=l.children[S].chunkSize();return a+r.first}function lineAtHeight(t,r){var a=t.first;e:do{for(var l=0;l<t.children.length;++l){var S=t.children[l],O=S.height;if(r<O){t=S;continue e}r-=O,a+=S.chunkSize()}return a}while(!t.lines);for(var L=0;L<t.lines.length;++L){var E=t.lines[L].height;if(r<E)break;r-=E}return a+L}function isLine(t,r){return r>=t.first&&r<t.first+t.size}function lineNumberFor(t,r){return String(t.lineNumberFormatter(r+t.firstLineNumber))}function Pos(t,r,a){if(void 0===a&&(a=null),!(this instanceof Pos))return new Pos(t,r,a);this.line=t,this.ch=r,this.sticky=a}function cmp(t,r){return t.line-r.line||t.ch-r.ch}function equalCursorPos(t,r){return t.sticky==r.sticky&&0==cmp(t,r)}function copyPos(t){return Pos(t.line,t.ch)}function maxPos(t,r){return cmp(t,r)<0?r:t}function minPos(t,r){return cmp(t,r)<0?t:r}function clipLine(t,r){return Math.max(t.first,Math.min(r,t.first+t.size-1))}function clipPos(t,r){if(r.line<t.first)return Pos(t.first,0);var a=t.first+t.size-1;return r.line>a?Pos(a,getLine(t,a).text.length):function clipToLen(t,r){var a=t.ch;return null==a||a>r?Pos(t.line,r):a<0?Pos(t.line,0):t}(r,getLine(t,r.line).text.length)}function clipPosArray(t,r){for(var a=[],l=0;l<r.length;l++)a[l]=clipPos(t,r[l]);return a}StringStream.prototype.eol=function(){return this.pos>=this.string.length},StringStream.prototype.sol=function(){return this.pos==this.lineStart},StringStream.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},StringStream.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},StringStream.prototype.eat=function(t){var r=this.string.charAt(this.pos);if("string"==typeof t?r==t:r&&(t.test?t.test(r):t(r)))return++this.pos,r},StringStream.prototype.eatWhile=function(t){for(var r=this.pos;this.eat(t););return this.pos>r},StringStream.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},StringStream.prototype.skipToEnd=function(){this.pos=this.string.length},StringStream.prototype.skipTo=function(t){var r=this.string.indexOf(t,this.pos);if(r>-1)return this.pos=r,!0},StringStream.prototype.backUp=function(t){this.pos-=t},StringStream.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},StringStream.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},StringStream.prototype.match=function(t,r,a){if("string"!=typeof t){var l=this.string.slice(this.pos).match(t);return l&&l.index>0?null:(l&&!1!==r&&(this.pos+=l[0].length),l)}var cased=function(t){return a?t.toLowerCase():t};if(cased(this.string.substr(this.pos,t.length))==cased(t))return!1!==r&&(this.pos+=t.length),!0},StringStream.prototype.current=function(){return this.string.slice(this.start,this.pos)},StringStream.prototype.hideFirstChars=function(t,r){this.lineStart+=t;try{return r()}finally{this.lineStart-=t}},StringStream.prototype.lookAhead=function(t){var r=this.lineOracle;return r&&r.lookAhead(t)},StringStream.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};var SavedContext=function(t,r){this.state=t,this.lookAhead=r},Context=function(t,r,a,l){this.state=r,this.doc=t,this.line=a,this.maxLookAhead=l||0,this.baseTokens=null,this.baseTokenPos=1};function highlightLine(t,r,a,l){var S=[t.state.modeGen],O={};runMode(t,r.text,t.doc.mode,a,(function(t,r){return S.push(t,r)}),O,l);for(var L=a.state,loop=function(l){a.baseTokens=S;var E=t.state.overlays[l],D=1,j=0;a.state=!0,runMode(t,r.text,E.mode,a,(function(t,r){for(var a=D;j<t;){var l=S[D];l>t&&S.splice(D,1,t,S[D+1],l),D+=2,j=Math.min(t,l)}if(r)if(E.opaque)S.splice(a,D-a,t,"overlay "+r),D=a+2;else for(;a<D;a+=2){var O=S[a+1];S[a+1]=(O?O+" ":"")+"overlay "+r}}),O),a.state=L,a.baseTokens=null,a.baseTokenPos=1},E=0;E<t.state.overlays.length;++E)loop(E);return{styles:S,classes:O.bgClass||O.textClass?O:null}}function getLineStyles(t,r,a){if(!r.styles||r.styles[0]!=t.state.modeGen){var l=getContextBefore(t,lineNo(r)),S=r.text.length>t.options.maxHighlightLength&&copyState(t.doc.mode,l.state),O=highlightLine(t,r,l);S&&(l.state=S),r.stateAfter=l.save(!S),r.styles=O.styles,O.classes?r.styleClasses=O.classes:r.styleClasses&&(r.styleClasses=null),a===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return r.styles}function getContextBefore(t,r,a){var l=t.doc,S=t.display;if(!l.mode.startState)return new Context(l,!0,r);var O=function findStartLine(t,r,a){for(var l,S,O=t.doc,L=a?-1:r-(t.doc.mode.innerMode?1e3:100),E=r;E>L;--E){if(E<=O.first)return O.first;var D=getLine(O,E-1),j=D.stateAfter;if(j&&(!a||E+(j instanceof SavedContext?j.lookAhead:0)<=O.modeFrontier))return E;var B=countColumn(D.text,null,t.options.tabSize);(null==S||l>B)&&(S=E-1,l=B)}return S}(t,r,a),L=O>l.first&&getLine(l,O-1).stateAfter,E=L?Context.fromSaved(l,L,O):new Context(l,startState(l.mode),O);return l.iter(O,r,(function(a){processLine(t,a.text,E);var l=E.line;a.stateAfter=l==r-1||l%5==0||l>=S.viewFrom&&l<S.viewTo?E.save():null,E.nextLine()})),a&&(l.modeFrontier=E.line),E}function processLine(t,r,a,l){var S=t.doc.mode,O=new StringStream(r,t.options.tabSize,a);for(O.start=O.pos=l||0,""==r&&callBlankLine(S,a.state);!O.eol();)readToken(S,O,a.state),O.start=O.pos}function callBlankLine(t,r){if(t.blankLine)return t.blankLine(r);if(t.innerMode){var a=innerMode(t,r);return a.mode.blankLine?a.mode.blankLine(a.state):void 0}}function readToken(t,r,a,l){for(var S=0;S<10;S++){l&&(l[0]=innerMode(t,a).mode);var O=t.token(r,a);if(r.pos>r.start)return O}throw new Error("Mode "+t.name+" failed to advance stream.")}Context.prototype.lookAhead=function(t){var r=this.doc.getLine(this.line+t);return null!=r&&t>this.maxLookAhead&&(this.maxLookAhead=t),r},Context.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var r=this.baseTokens[this.baseTokenPos+1];return{type:r&&r.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},Context.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Context.fromSaved=function(t,r,a){return r instanceof SavedContext?new Context(t,copyState(t.mode,r.state),a,r.lookAhead):new Context(t,copyState(t.mode,r),a)},Context.prototype.save=function(t){var r=!1!==t?copyState(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new SavedContext(r,this.maxLookAhead):r};var Token=function(t,r,a){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=r||null,this.state=a};function takeToken(t,r,a,l){var S,O,L=t.doc,E=L.mode,D=getLine(L,(r=clipPos(L,r)).line),j=getContextBefore(t,r.line,a),B=new StringStream(D.text,t.options.tabSize,j);for(l&&(O=[]);(l||B.pos<r.ch)&&!B.eol();)B.start=B.pos,S=readToken(E,B,j.state),l&&O.push(new Token(B,S,copyState(L.mode,j.state)));return l?O:new Token(B,S,j.state)}function extractLineClasses(t,r){if(t)for(;;){var a=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!a)break;t=t.slice(0,a.index)+t.slice(a.index+a[0].length);var l=a[1]?"bgClass":"textClass";null==r[l]?r[l]=a[2]:new RegExp("(?:^|\\s)"+a[2]+"(?:$|\\s)").test(r[l])||(r[l]+=" "+a[2])}return t}function runMode(t,r,a,l,S,O,L){var E=a.flattenSpans;null==E&&(E=t.options.flattenSpans);var D,j=0,B=null,q=new StringStream(r,t.options.tabSize,l),G=t.options.addModeClass&&[null];for(""==r&&extractLineClasses(callBlankLine(a,l.state),O);!q.eol();){if(q.pos>t.options.maxHighlightLength?(E=!1,L&&processLine(t,r,l,q.pos),q.pos=r.length,D=null):D=extractLineClasses(readToken(a,q,l.state,G),O),G){var X=G[0].name;X&&(D="m-"+(D?X+" "+D:X))}if(!E||B!=D){for(;j<q.start;)S(j=Math.min(q.start,j+5e3),B);B=D}q.start=q.pos}for(;j<q.pos;){var $=Math.min(q.pos,j+5e3);S($,B),j=$}}var ke=!1,Me=!1;function MarkedSpan(t,r,a){this.marker=t,this.from=r,this.to=a}function getMarkedSpanFor(t,r){if(t)for(var a=0;a<t.length;++a){var l=t[a];if(l.marker==r)return l}}function removeMarkedSpan(t,r){for(var a,l=0;l<t.length;++l)t[l]!=r&&(a||(a=[])).push(t[l]);return a}function stretchSpansOverChange(t,r){if(r.full)return null;var a=isLine(t,r.from.line)&&getLine(t,r.from.line).markedSpans,l=isLine(t,r.to.line)&&getLine(t,r.to.line).markedSpans;if(!a&&!l)return null;var S=r.from.ch,O=r.to.ch,L=0==cmp(r.from,r.to),E=function markedSpansBefore(t,r,a){var l;if(t)for(var S=0;S<t.length;++S){var O=t[S],L=O.marker;if(null==O.from||(L.inclusiveLeft?O.from<=r:O.from<r)||O.from==r&&"bookmark"==L.type&&(!a||!O.marker.insertLeft)){var E=null==O.to||(L.inclusiveRight?O.to>=r:O.to>r);(l||(l=[])).push(new MarkedSpan(L,O.from,E?null:O.to))}}return l}(a,S,L),D=function markedSpansAfter(t,r,a){var l;if(t)for(var S=0;S<t.length;++S){var O=t[S],L=O.marker;if(null==O.to||(L.inclusiveRight?O.to>=r:O.to>r)||O.from==r&&"bookmark"==L.type&&(!a||O.marker.insertLeft)){var E=null==O.from||(L.inclusiveLeft?O.from<=r:O.from<r);(l||(l=[])).push(new MarkedSpan(L,E?null:O.from-r,null==O.to?null:O.to-r))}}return l}(l,O,L),j=1==r.text.length,B=lst(r.text).length+(j?S:0);if(E)for(var q=0;q<E.length;++q){var G=E[q];if(null==G.to){var X=getMarkedSpanFor(D,G.marker);X?j&&(G.to=null==X.to?null:X.to+B):G.to=S}}if(D)for(var $=0;$<D.length;++$){var Z=D[$];null!=Z.to&&(Z.to+=B),null==Z.from?getMarkedSpanFor(E,Z.marker)||(Z.from=B,j&&(E||(E=[])).push(Z)):(Z.from+=B,j&&(E||(E=[])).push(Z))}E&&(E=clearEmptySpans(E)),D&&D!=E&&(D=clearEmptySpans(D));var Q=[E];if(!j){var ee,te=r.text.length-2;if(te>0&&E)for(var ne=0;ne<E.length;++ne)null==E[ne].to&&(ee||(ee=[])).push(new MarkedSpan(E[ne].marker,null,null));for(var re=0;re<te;++re)Q.push(ee);Q.push(D)}return Q}function clearEmptySpans(t){for(var r=0;r<t.length;++r){var a=t[r];null!=a.from&&a.from==a.to&&!1!==a.marker.clearWhenEmpty&&t.splice(r--,1)}return t.length?t:null}function detachMarkedSpans(t){var r=t.markedSpans;if(r){for(var a=0;a<r.length;++a)r[a].marker.detachLine(t);t.markedSpans=null}}function attachMarkedSpans(t,r){if(r){for(var a=0;a<r.length;++a)r[a].marker.attachLine(t);t.markedSpans=r}}function extraLeft(t){return t.inclusiveLeft?-1:0}function extraRight(t){return t.inclusiveRight?1:0}function compareCollapsedMarkers(t,r){var a=t.lines.length-r.lines.length;if(0!=a)return a;var l=t.find(),S=r.find(),O=cmp(l.from,S.from)||extraLeft(t)-extraLeft(r);if(O)return-O;var L=cmp(l.to,S.to)||extraRight(t)-extraRight(r);return L||r.id-t.id}function collapsedSpanAtSide(t,r){var a,l=Me&&t.markedSpans;if(l)for(var S=void 0,O=0;O<l.length;++O)(S=l[O]).marker.collapsed&&null==(r?S.from:S.to)&&(!a||compareCollapsedMarkers(a,S.marker)<0)&&(a=S.marker);return a}function collapsedSpanAtStart(t){return collapsedSpanAtSide(t,!0)}function collapsedSpanAtEnd(t){return collapsedSpanAtSide(t,!1)}function collapsedSpanAround(t,r){var a,l=Me&&t.markedSpans;if(l)for(var S=0;S<l.length;++S){var O=l[S];O.marker.collapsed&&(null==O.from||O.from<r)&&(null==O.to||O.to>r)&&(!a||compareCollapsedMarkers(a,O.marker)<0)&&(a=O.marker)}return a}function conflictingCollapsedRange(t,r,a,l,S){var O=getLine(t,r),L=Me&&O.markedSpans;if(L)for(var E=0;E<L.length;++E){var D=L[E];if(D.marker.collapsed){var j=D.marker.find(0),B=cmp(j.from,a)||extraLeft(D.marker)-extraLeft(S),q=cmp(j.to,l)||extraRight(D.marker)-extraRight(S);if(!(B>=0&&q<=0||B<=0&&q>=0)&&(B<=0&&(D.marker.inclusiveRight&&S.inclusiveLeft?cmp(j.to,a)>=0:cmp(j.to,a)>0)||B>=0&&(D.marker.inclusiveRight&&S.inclusiveLeft?cmp(j.from,l)<=0:cmp(j.from,l)<0)))return!0}}}function visualLine(t){for(var r;r=collapsedSpanAtStart(t);)t=r.find(-1,!0).line;return t}function visualLineNo(t,r){var a=getLine(t,r),l=visualLine(a);return a==l?r:lineNo(l)}function visualLineEndNo(t,r){if(r>t.lastLine())return r;var a,l=getLine(t,r);if(!lineIsHidden(t,l))return r;for(;a=collapsedSpanAtEnd(l);)l=a.find(1,!0).line;return lineNo(l)+1}function lineIsHidden(t,r){var a=Me&&r.markedSpans;if(a)for(var l=void 0,S=0;S<a.length;++S)if((l=a[S]).marker.collapsed){if(null==l.from)return!0;if(!l.marker.widgetNode&&0==l.from&&l.marker.inclusiveLeft&&lineIsHiddenInner(t,r,l))return!0}}function lineIsHiddenInner(t,r,a){if(null==a.to){var l=a.marker.find(1,!0);return lineIsHiddenInner(t,l.line,getMarkedSpanFor(l.line.markedSpans,a.marker))}if(a.marker.inclusiveRight&&a.to==r.text.length)return!0;for(var S=void 0,O=0;O<r.markedSpans.length;++O)if((S=r.markedSpans[O]).marker.collapsed&&!S.marker.widgetNode&&S.from==a.to&&(null==S.to||S.to!=a.from)&&(S.marker.inclusiveLeft||a.marker.inclusiveRight)&&lineIsHiddenInner(t,r,S))return!0}function heightAtLine(t){for(var r=0,a=(t=visualLine(t)).parent,l=0;l<a.lines.length;++l){var S=a.lines[l];if(S==t)break;r+=S.height}for(var O=a.parent;O;O=(a=O).parent)for(var L=0;L<O.children.length;++L){var E=O.children[L];if(E==a)break;r+=E.height}return r}function lineLength(t){if(0==t.height)return 0;for(var r,a=t.text.length,l=t;r=collapsedSpanAtStart(l);){var S=r.find(0,!0);l=S.from.line,a+=S.from.ch-S.to.ch}for(l=t;r=collapsedSpanAtEnd(l);){var O=r.find(0,!0);a-=l.text.length-O.from.ch,a+=(l=O.to.line).text.length-O.to.ch}return a}function findMaxLine(t){var r=t.display,a=t.doc;r.maxLine=getLine(a,a.first),r.maxLineLength=lineLength(r.maxLine),r.maxLineChanged=!0,a.iter((function(t){var a=lineLength(t);a>r.maxLineLength&&(r.maxLineLength=a,r.maxLine=t)}))}var Line=function(t,r,a){this.text=t,attachMarkedSpans(this,r),this.height=a?a(this):1};function cleanUpLine(t){t.parent=null,detachMarkedSpans(t)}Line.prototype.lineNo=function(){return lineNo(this)},eventMixin(Line);var Ee={},Ie={};function interpretTokenStyle(t,r){if(!t||/^\s*$/.test(t))return null;var a=r.addModeClass?Ie:Ee;return a[t]||(a[t]=t.replace(/\S+/g,"cm-$&"))}function buildLineContent(t,r){var a=eltP("span",null,null,D?"padding-right: .1px":null),l={pre:eltP("pre",[a],"CodeMirror-line"),content:a,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};r.measure={};for(var S=0;S<=(r.rest?r.rest.length:0);S++){var O=S?r.rest[S-1]:r.line,L=void 0;l.pos=0,l.addToken=buildToken,hasBadBidiRects(t.display.measure)&&(L=getOrder(O,t.doc.direction))&&(l.addToken=buildTokenBadBidi(l.addToken,L)),l.map=[],insertLineContent(O,l,getLineStyles(t,O,r!=t.display.externalMeasured&&lineNo(O))),O.styleClasses&&(O.styleClasses.bgClass&&(l.bgClass=joinClasses(O.styleClasses.bgClass,l.bgClass||"")),O.styleClasses.textClass&&(l.textClass=joinClasses(O.styleClasses.textClass,l.textClass||""))),0==l.map.length&&l.map.push(0,0,l.content.appendChild(zeroWidthElement(t.display.measure))),0==S?(r.measure.map=l.map,r.measure.cache={}):((r.measure.maps||(r.measure.maps=[])).push(l.map),(r.measure.caches||(r.measure.caches=[])).push({}))}if(D){var E=l.content.lastChild;(/\bcm-tab\b/.test(E.className)||E.querySelector&&E.querySelector(".cm-tab"))&&(l.content.className="cm-tab-wrap-hack")}return signal(t,"renderLine",t,r.line,l.pre),l.pre.className&&(l.textClass=joinClasses(l.pre.className,l.textClass||"")),l}function defaultSpecialCharPlaceholder(t){var r=elt("span","•","cm-invalidchar");return r.title="\\u"+t.charCodeAt(0).toString(16),r.setAttribute("aria-label",r.title),r}function buildToken(t,r,a,l,S,O,D){if(r){var j,B=t.splitSpaces?function splitSpaces(t,r){if(t.length>1&&!/  /.test(t))return t;for(var a=r,l="",S=0;S<t.length;S++){var O=t.charAt(S);" "!=O||!a||S!=t.length-1&&32!=t.charCodeAt(S+1)||(O=" "),l+=O,a=" "==O}return l}(r,t.trailingSpace):r,q=t.cm.state.specialChars,G=!1;if(q.test(r)){j=document.createDocumentFragment();for(var X=0;;){q.lastIndex=X;var $=q.exec(r),Z=$?$.index-X:r.length-X;if(Z){var Q=document.createTextNode(B.slice(X,X+Z));L&&E<9?j.appendChild(elt("span",[Q])):j.appendChild(Q),t.map.push(t.pos,t.pos+Z,Q),t.col+=Z,t.pos+=Z}if(!$)break;X+=Z+1;var ee=void 0;if("\t"==$[0]){var te=t.cm.options.tabSize,ne=te-t.col%te;(ee=j.appendChild(elt("span",spaceStr(ne),"cm-tab"))).setAttribute("role","presentation"),ee.setAttribute("cm-text","\t"),t.col+=ne}else"\r"==$[0]||"\n"==$[0]?((ee=j.appendChild(elt("span","\r"==$[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",$[0]),t.col+=1):((ee=t.cm.options.specialCharPlaceholder($[0])).setAttribute("cm-text",$[0]),L&&E<9?j.appendChild(elt("span",[ee])):j.appendChild(ee),t.col+=1);t.map.push(t.pos,t.pos+1,ee),t.pos++}}else t.col+=r.length,j=document.createTextNode(B),t.map.push(t.pos,t.pos+r.length,j),L&&E<9&&(G=!0),t.pos+=r.length;if(t.trailingSpace=32==B.charCodeAt(r.length-1),a||l||S||G||O||D){var re=a||"";l&&(re+=l),S&&(re+=S);var oe=elt("span",[j],re,O);if(D)for(var ie in D)D.hasOwnProperty(ie)&&"style"!=ie&&"class"!=ie&&oe.setAttribute(ie,D[ie]);return t.content.appendChild(oe)}t.content.appendChild(j)}}function buildTokenBadBidi(t,r){return function(a,l,S,O,L,E,D){S=S?S+" cm-force-border":"cm-force-border";for(var j=a.pos,B=j+l.length;;){for(var q=void 0,G=0;G<r.length&&!((q=r[G]).to>j&&q.from<=j);G++);if(q.to>=B)return t(a,l,S,O,L,E,D);t(a,l.slice(0,q.to-j),S,O,null,E,D),O=null,l=l.slice(q.to-j),j=q.to}}}function buildCollapsedSpan(t,r,a,l){var S=!l&&a.widgetNode;S&&t.map.push(t.pos,t.pos+r,S),!l&&t.cm.display.input.needsContentAttribute&&(S||(S=t.content.appendChild(document.createElement("span"))),S.setAttribute("cm-marker",a.id)),S&&(t.cm.display.input.setUneditable(S),t.content.appendChild(S)),t.pos+=r,t.trailingSpace=!1}function insertLineContent(t,r,a){var l=t.markedSpans,S=t.text,O=0;if(l)for(var L,E,D,j,B,q,G,X=S.length,$=0,Z=1,Q="",ee=0;;){if(ee==$){D=j=B=E="",G=null,q=null,ee=1/0;for(var te=[],ne=void 0,re=0;re<l.length;++re){var oe=l[re],ie=oe.marker;if("bookmark"==ie.type&&oe.from==$&&ie.widgetNode)te.push(ie);else if(oe.from<=$&&(null==oe.to||oe.to>$||ie.collapsed&&oe.to==$&&oe.from==$)){if(null!=oe.to&&oe.to!=$&&ee>oe.to&&(ee=oe.to,j=""),ie.className&&(D+=" "+ie.className),ie.css&&(E=(E?E+";":"")+ie.css),ie.startStyle&&oe.from==$&&(B+=" "+ie.startStyle),ie.endStyle&&oe.to==ee&&(ne||(ne=[])).push(ie.endStyle,oe.to),ie.title&&((G||(G={})).title=ie.title),ie.attributes)for(var ae in ie.attributes)(G||(G={}))[ae]=ie.attributes[ae];ie.collapsed&&(!q||compareCollapsedMarkers(q.marker,ie)<0)&&(q=oe)}else oe.from>$&&ee>oe.from&&(ee=oe.from)}if(ne)for(var se=0;se<ne.length;se+=2)ne[se+1]==ee&&(j+=" "+ne[se]);if(!q||q.from==$)for(var le=0;le<te.length;++le)buildCollapsedSpan(r,0,te[le]);if(q&&(q.from||0)==$){if(buildCollapsedSpan(r,(null==q.to?X+1:q.to)-$,q.marker,null==q.from),null==q.to)return;q.to==$&&(q=!1)}}if($>=X)break;for(var ce=Math.min(X,ee);;){if(Q){var ue=$+Q.length;if(!q){var pe=ue>ce?Q.slice(0,ce-$):Q;r.addToken(r,pe,L?L+D:D,B,$+pe.length==ee?j:"",E,G)}if(ue>=ce){Q=Q.slice(ce-$),$=ce;break}$=ue,B=""}Q=S.slice(O,O=a[Z++]),L=interpretTokenStyle(a[Z++],r.cm.options)}}else for(var de=1;de<a.length;de+=2)r.addToken(r,S.slice(O,O=a[de]),interpretTokenStyle(a[de+1],r.cm.options))}function LineView(t,r,a){this.line=r,this.rest=function visualLineContinued(t){for(var r,a;r=collapsedSpanAtEnd(t);)t=r.find(1,!0).line,(a||(a=[])).push(t);return a}(r),this.size=this.rest?lineNo(lst(this.rest))-a+1:1,this.node=this.text=null,this.hidden=lineIsHidden(t,r)}function buildViewArray(t,r,a){for(var l,S=[],O=r;O<a;O=l){var L=new LineView(t.doc,getLine(t.doc,O),O);l=O+L.size,S.push(L)}return S}var Ae=null,Ne=null;function signalLater(t,r){var a=getHandlers(t,r);if(a.length){var l,S=Array.prototype.slice.call(arguments,2);Ae?l=Ae.delayedCallbacks:Ne?l=Ne:(l=Ne=[],setTimeout(fireOrphanDelayed,0));for(var loop=function(t){l.push((function(){return a[t].apply(null,S)}))},O=0;O<a.length;++O)loop(O)}}function fireOrphanDelayed(){var t=Ne;Ne=null;for(var r=0;r<t.length;++r)t[r]()}function updateLineForChanges(t,r,a,l){for(var S=0;S<r.changes.length;S++){var O=r.changes[S];"text"==O?updateLineText(t,r):"gutter"==O?updateLineGutter(t,r,a,l):"class"==O?updateLineClasses(t,r):"widget"==O&&updateLineWidgets(t,r,l)}r.changes=null}function ensureLineWrapped(t){return t.node==t.text&&(t.node=elt("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),L&&E<8&&(t.node.style.zIndex=2)),t.node}function getLineContent(t,r){var a=t.display.externalMeasured;return a&&a.line==r.line?(t.display.externalMeasured=null,r.measure=a.measure,a.built):buildLineContent(t,r)}function updateLineText(t,r){var a=r.text.className,l=getLineContent(t,r);r.text==r.node&&(r.node=l.pre),r.text.parentNode.replaceChild(l.pre,r.text),r.text=l.pre,l.bgClass!=r.bgClass||l.textClass!=r.textClass?(r.bgClass=l.bgClass,r.textClass=l.textClass,updateLineClasses(t,r)):a&&(r.text.className=a)}function updateLineClasses(t,r){!function updateLineBackground(t,r){var a=r.bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass;if(a&&(a+=" CodeMirror-linebackground"),r.background)a?r.background.className=a:(r.background.parentNode.removeChild(r.background),r.background=null);else if(a){var l=ensureLineWrapped(r);r.background=l.insertBefore(elt("div",null,a),l.firstChild),t.display.input.setUneditable(r.background)}}(t,r),r.line.wrapClass?ensureLineWrapped(r).className=r.line.wrapClass:r.node!=r.text&&(r.node.className="");var a=r.textClass?r.textClass+" "+(r.line.textClass||""):r.line.textClass;r.text.className=a||""}function updateLineGutter(t,r,a,l){if(r.gutter&&(r.node.removeChild(r.gutter),r.gutter=null),r.gutterBackground&&(r.node.removeChild(r.gutterBackground),r.gutterBackground=null),r.line.gutterClass){var S=ensureLineWrapped(r);r.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+r.line.gutterClass,"left: "+(t.options.fixedGutter?l.fixedPos:-l.gutterTotalWidth)+"px; width: "+l.gutterTotalWidth+"px"),t.display.input.setUneditable(r.gutterBackground),S.insertBefore(r.gutterBackground,r.text)}var O=r.line.gutterMarkers;if(t.options.lineNumbers||O){var L=ensureLineWrapped(r),E=r.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?l.fixedPos:-l.gutterTotalWidth)+"px");if(E.setAttribute("aria-hidden","true"),t.display.input.setUneditable(E),L.insertBefore(E,r.text),r.line.gutterClass&&(E.className+=" "+r.line.gutterClass),!t.options.lineNumbers||O&&O["CodeMirror-linenumbers"]||(r.lineNumber=E.appendChild(elt("div",lineNumberFor(t.options,a),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+l.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),O)for(var D=0;D<t.display.gutterSpecs.length;++D){var j=t.display.gutterSpecs[D].className,B=O.hasOwnProperty(j)&&O[j];B&&E.appendChild(elt("div",[B],"CodeMirror-gutter-elt","left: "+l.gutterLeft[j]+"px; width: "+l.gutterWidth[j]+"px"))}}}function updateLineWidgets(t,r,a){r.alignable&&(r.alignable=null);for(var l=classTest("CodeMirror-linewidget"),S=r.node.firstChild,O=void 0;S;S=O)O=S.nextSibling,l.test(S.className)&&r.node.removeChild(S);insertLineWidgets(t,r,a)}function buildLineElement(t,r,a,l){var S=getLineContent(t,r);return r.text=r.node=S.pre,S.bgClass&&(r.bgClass=S.bgClass),S.textClass&&(r.textClass=S.textClass),updateLineClasses(t,r),updateLineGutter(t,r,a,l),insertLineWidgets(t,r,l),r.node}function insertLineWidgets(t,r,a){if(insertLineWidgetsFor(t,r.line,r,a,!0),r.rest)for(var l=0;l<r.rest.length;l++)insertLineWidgetsFor(t,r.rest[l],r,a,!1)}function insertLineWidgetsFor(t,r,a,l,S){if(r.widgets)for(var O=ensureLineWrapped(a),L=0,E=r.widgets;L<E.length;++L){var D=E[L],j=elt("div",[D.node],"CodeMirror-linewidget"+(D.className?" "+D.className:""));D.handleMouseEvents||j.setAttribute("cm-ignore-events","true"),positionLineWidget(D,j,a,l),t.display.input.setUneditable(j),S&&D.above?O.insertBefore(j,a.gutter||a.text):O.appendChild(j),signalLater(D,"redraw")}}function positionLineWidget(t,r,a,l){if(t.noHScroll){(a.alignable||(a.alignable=[])).push(r);var S=l.wrapperWidth;r.style.left=l.fixedPos+"px",t.coverGutter||(S-=l.gutterTotalWidth,r.style.paddingLeft=l.gutterTotalWidth+"px"),r.style.width=S+"px"}t.coverGutter&&(r.style.zIndex=5,r.style.position="relative",t.noHScroll||(r.style.marginLeft=-l.gutterTotalWidth+"px"))}function widgetHeight(t){if(null!=t.height)return t.height;var r=t.doc.cm;if(!r)return 0;if(!contains(document.body,t.node)){var a="position: relative;";t.coverGutter&&(a+="margin-left: -"+r.display.gutters.offsetWidth+"px;"),t.noHScroll&&(a+="width: "+r.display.wrapper.clientWidth+"px;"),removeChildrenAndAdd(r.display.measure,elt("div",[t.node],null,a))}return t.height=t.node.parentNode.offsetHeight}function eventInWidget(t,r){for(var a=e_target(r);a!=t.wrapper;a=a.parentNode)if(!a||1==a.nodeType&&"true"==a.getAttribute("cm-ignore-events")||a.parentNode==t.sizer&&a!=t.mover)return!0}function paddingTop(t){return t.lineSpace.offsetTop}function paddingVert(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function paddingH(t){if(t.cachedPaddingH)return t.cachedPaddingH;var r=removeChildrenAndAdd(t.measure,elt("pre","x","CodeMirror-line-like")),a=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,l={left:parseInt(a.paddingLeft),right:parseInt(a.paddingRight)};return isNaN(l.left)||isNaN(l.right)||(t.cachedPaddingH=l),l}function scrollGap(t){return 50-t.display.nativeBarWidth}function displayWidth(t){return t.display.scroller.clientWidth-scrollGap(t)-t.display.barWidth}function displayHeight(t){return t.display.scroller.clientHeight-scrollGap(t)-t.display.barHeight}function mapFromLineView(t,r,a){if(t.line==r)return{map:t.measure.map,cache:t.measure.cache};for(var l=0;l<t.rest.length;l++)if(t.rest[l]==r)return{map:t.measure.maps[l],cache:t.measure.caches[l]};for(var S=0;S<t.rest.length;S++)if(lineNo(t.rest[S])>a)return{map:t.measure.maps[S],cache:t.measure.caches[S],before:!0}}function measureChar(t,r,a,l){return measureCharPrepared(t,prepareMeasureForLine(t,r),a,l)}function findViewForLine(t,r){if(r>=t.display.viewFrom&&r<t.display.viewTo)return t.display.view[findViewIndex(t,r)];var a=t.display.externalMeasured;return a&&r>=a.lineN&&r<a.lineN+a.size?a:void 0}function prepareMeasureForLine(t,r){var a=lineNo(r),l=findViewForLine(t,a);l&&!l.text?l=null:l&&l.changes&&(updateLineForChanges(t,l,a,getDimensions(t)),t.curOp.forceUpdate=!0),l||(l=function updateExternalMeasurement(t,r){var a=lineNo(r=visualLine(r)),l=t.display.externalMeasured=new LineView(t.doc,r,a);l.lineN=a;var S=l.built=buildLineContent(t,l);return l.text=S.pre,removeChildrenAndAdd(t.display.lineMeasure,S.pre),l}(t,r));var S=mapFromLineView(l,r,a);return{line:r,view:l,rect:null,map:S.map,cache:S.cache,before:S.before,hasHeights:!1}}function measureCharPrepared(t,r,a,l,S){r.before&&(a=-1);var O,D=a+(l||"");return r.cache.hasOwnProperty(D)?O=r.cache[D]:(r.rect||(r.rect=r.view.text.getBoundingClientRect()),r.hasHeights||(function ensureLineHeights(t,r,a){var l=t.options.lineWrapping,S=l&&displayWidth(t);if(!r.measure.heights||l&&r.measure.width!=S){var O=r.measure.heights=[];if(l){r.measure.width=S;for(var L=r.text.firstChild.getClientRects(),E=0;E<L.length-1;E++){var D=L[E],j=L[E+1];Math.abs(D.bottom-j.bottom)>2&&O.push((D.bottom+j.top)/2-a.top)}}O.push(a.bottom-a.top)}}(t,r.view,r.rect),r.hasHeights=!0),(O=function measureCharInner(t,r,a,l){var S,O=nodeAndOffsetInLineMap(r.map,a,l),D=O.node,j=O.start,B=O.end,q=O.collapse;if(3==D.nodeType){for(var G=0;G<4;G++){for(;j&&isExtendingChar(r.line.text.charAt(O.coverStart+j));)--j;for(;O.coverStart+B<O.coverEnd&&isExtendingChar(r.line.text.charAt(O.coverStart+B));)++B;if((S=L&&E<9&&0==j&&B==O.coverEnd-O.coverStart?D.parentNode.getBoundingClientRect():getUsefulRect(se(D,j,B).getClientRects(),l)).left||S.right||0==j)break;B=j,j-=1,q="right"}L&&E<11&&(S=function maybeUpdateRectForZooming(t,r){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function hasBadZoomedRects(t){if(null!=Oe)return Oe;var r=removeChildrenAndAdd(t,elt("span","x")),a=r.getBoundingClientRect(),l=se(r,0,1).getBoundingClientRect();return Oe=Math.abs(a.left-l.left)>1}(t))return r;var a=screen.logicalXDPI/screen.deviceXDPI,l=screen.logicalYDPI/screen.deviceYDPI;return{left:r.left*a,right:r.right*a,top:r.top*l,bottom:r.bottom*l}}(t.display.measure,S))}else{var X;j>0&&(q=l="right"),S=t.options.lineWrapping&&(X=D.getClientRects()).length>1?X["right"==l?X.length-1:0]:D.getBoundingClientRect()}if(L&&E<9&&!j&&(!S||!S.left&&!S.right)){var $=D.parentNode.getClientRects()[0];S=$?{left:$.left,right:$.left+charWidth(t.display),top:$.top,bottom:$.bottom}:Re}for(var Z=S.top-r.rect.top,Q=S.bottom-r.rect.top,ee=(Z+Q)/2,te=r.view.measure.heights,ne=0;ne<te.length-1&&!(ee<te[ne]);ne++);var re=ne?te[ne-1]:0,oe=te[ne],ie={left:("right"==q?S.right:S.left)-r.rect.left,right:("left"==q?S.left:S.right)-r.rect.left,top:re,bottom:oe};return S.left||S.right||(ie.bogus=!0),t.options.singleCursorHeightPerLine||(ie.rtop=Z,ie.rbottom=Q),ie}(t,r,a,l)).bogus||(r.cache[D]=O)),{left:O.left,right:O.right,top:S?O.rtop:O.top,bottom:S?O.rbottom:O.bottom}}var De,Re={left:0,right:0,top:0,bottom:0};function nodeAndOffsetInLineMap(t,r,a){for(var l,S,O,L,E,D,j=0;j<t.length;j+=3)if(E=t[j],D=t[j+1],r<E?(S=0,O=1,L="left"):r<D?O=1+(S=r-E):(j==t.length-3||r==D&&t[j+3]>r)&&(S=(O=D-E)-1,r>=D&&(L="right")),null!=S){if(l=t[j+2],E==D&&a==(l.insertLeft?"left":"right")&&(L=a),"left"==a&&0==S)for(;j&&t[j-2]==t[j-3]&&t[j-1].insertLeft;)l=t[2+(j-=3)],L="left";if("right"==a&&S==D-E)for(;j<t.length-3&&t[j+3]==t[j+4]&&!t[j+5].insertLeft;)l=t[(j+=3)+2],L="right";break}return{node:l,start:S,end:O,collapse:L,coverStart:E,coverEnd:D}}function getUsefulRect(t,r){var a=Re;if("left"==r)for(var l=0;l<t.length&&(a=t[l]).left==a.right;l++);else for(var S=t.length-1;S>=0&&(a=t[S]).left==a.right;S--);return a}function clearLineMeasurementCacheFor(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var r=0;r<t.rest.length;r++)t.measure.caches[r]={}}function clearLineMeasurementCache(t){t.display.externalMeasure=null,removeChildren(t.display.lineMeasure);for(var r=0;r<t.display.view.length;r++)clearLineMeasurementCacheFor(t.display.view[r])}function clearCaches(t){clearLineMeasurementCache(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function pageScrollX(){return B&&Q?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return B&&Q?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function widgetTopHeight(t){var r=0;if(t.widgets)for(var a=0;a<t.widgets.length;++a)t.widgets[a].above&&(r+=widgetHeight(t.widgets[a]));return r}function intoCoordSystem(t,r,a,l,S){if(!S){var O=widgetTopHeight(r);a.top+=O,a.bottom+=O}if("line"==l)return a;l||(l="local");var L=heightAtLine(r);if("local"==l?L+=paddingTop(t.display):L-=t.display.viewOffset,"page"==l||"window"==l){var E=t.display.lineSpace.getBoundingClientRect();L+=E.top+("window"==l?0:pageScrollY());var D=E.left+("window"==l?0:pageScrollX());a.left+=D,a.right+=D}return a.top+=L,a.bottom+=L,a}function fromCoordSystem(t,r,a){if("div"==a)return r;var l=r.left,S=r.top;if("page"==a)l-=pageScrollX(),S-=pageScrollY();else if("local"==a||!a){var O=t.display.sizer.getBoundingClientRect();l+=O.left,S+=O.top}var L=t.display.lineSpace.getBoundingClientRect();return{left:l-L.left,top:S-L.top}}function charCoords(t,r,a,l,S){return l||(l=getLine(t.doc,r.line)),intoCoordSystem(t,l,measureChar(t,l,r.ch,S),a)}function cursorCoords(t,r,a,l,S,O){function get(r,L){var E=measureCharPrepared(t,S,r,L?"right":"left",O);return L?E.left=E.right:E.right=E.left,intoCoordSystem(t,l,E,a)}l=l||getLine(t.doc,r.line),S||(S=prepareMeasureForLine(t,l));var L=getOrder(l,t.doc.direction),E=r.ch,D=r.sticky;if(E>=l.text.length?(E=l.text.length,D="before"):E<=0&&(E=0,D="after"),!L)return get("before"==D?E-1:E,"before"==D);function getBidi(t,r,a){return get(a?t-1:t,1==L[r].level!=a)}var j=getBidiPartAt(L,E,D),B=ge,q=getBidi(E,j,"before"==D);return null!=B&&(q.other=getBidi(E,B,"before"!=D)),q}function estimateCoords(t,r){var a=0;r=clipPos(t.doc,r),t.options.lineWrapping||(a=charWidth(t.display)*r.ch);var l=getLine(t.doc,r.line),S=heightAtLine(l)+paddingTop(t.display);return{left:a,right:a,top:S,bottom:S+l.height}}function PosWithInfo(t,r,a,l,S){var O=Pos(t,r,a);return O.xRel=S,l&&(O.outside=l),O}function coordsChar(t,r,a){var l=t.doc;if((a+=t.display.viewOffset)<0)return PosWithInfo(l.first,0,null,-1,-1);var S=lineAtHeight(l,a),O=l.first+l.size-1;if(S>O)return PosWithInfo(l.first+l.size-1,getLine(l,O).text.length,null,1,1);r<0&&(r=0);for(var L=getLine(l,S);;){var E=coordsCharInner(t,L,S,r,a),D=collapsedSpanAround(L,E.ch+(E.xRel>0||E.outside>0?1:0));if(!D)return E;var j=D.find(1);if(j.line==S)return j;L=getLine(l,S=j.line)}}function wrappedLineExtent(t,r,a,l){l-=widgetTopHeight(r);var S=r.text.length,O=findFirst((function(r){return measureCharPrepared(t,a,r-1).bottom<=l}),S,0);return{begin:O,end:S=findFirst((function(r){return measureCharPrepared(t,a,r).top>l}),O,S)}}function wrappedLineExtentChar(t,r,a,l){return a||(a=prepareMeasureForLine(t,r)),wrappedLineExtent(t,r,a,intoCoordSystem(t,r,measureCharPrepared(t,a,l),"line").top)}function boxIsAfter(t,r,a,l){return!(t.bottom<=a)&&(t.top>a||(l?t.left:t.right)>r)}function coordsCharInner(t,r,a,l,S){S-=heightAtLine(r);var O=prepareMeasureForLine(t,r),L=widgetTopHeight(r),E=0,D=r.text.length,j=!0,B=getOrder(r,t.doc.direction);if(B){var q=(t.options.lineWrapping?coordsBidiPartWrapped:coordsBidiPart)(t,r,a,O,B,l,S);E=(j=1!=q.level)?q.from:q.to-1,D=j?q.to:q.from-1}var G,X,$=null,Z=null,Q=findFirst((function(r){var a=measureCharPrepared(t,O,r);return a.top+=L,a.bottom+=L,!!boxIsAfter(a,l,S,!1)&&(a.top<=S&&a.left<=l&&($=r,Z=a),!0)}),E,D),ee=!1;if(Z){var te=l-Z.left<Z.right-l,ne=te==j;Q=$+(ne?0:1),X=ne?"after":"before",G=te?Z.left:Z.right}else{j||Q!=D&&Q!=E||Q++,X=0==Q?"after":Q==r.text.length?"before":measureCharPrepared(t,O,Q-(j?1:0)).bottom+L<=S==j?"after":"before";var re=cursorCoords(t,Pos(a,Q,X),"line",r,O);G=re.left,ee=S<re.top?-1:S>=re.bottom?1:0}return PosWithInfo(a,Q=skipExtendingChars(r.text,Q,1),X,ee,l-G)}function coordsBidiPart(t,r,a,l,S,O,L){var E=findFirst((function(E){var D=S[E],j=1!=D.level;return boxIsAfter(cursorCoords(t,Pos(a,j?D.to:D.from,j?"before":"after"),"line",r,l),O,L,!0)}),0,S.length-1),D=S[E];if(E>0){var j=1!=D.level,B=cursorCoords(t,Pos(a,j?D.from:D.to,j?"after":"before"),"line",r,l);boxIsAfter(B,O,L,!0)&&B.top>L&&(D=S[E-1])}return D}function coordsBidiPartWrapped(t,r,a,l,S,O,L){var E=wrappedLineExtent(t,r,l,L),D=E.begin,j=E.end;/\s/.test(r.text.charAt(j-1))&&j--;for(var B=null,q=null,G=0;G<S.length;G++){var X=S[G];if(!(X.from>=j||X.to<=D)){var $=measureCharPrepared(t,l,1!=X.level?Math.min(j,X.to)-1:Math.max(D,X.from)).right,Z=$<O?O-$+1e9:$-O;(!B||q>Z)&&(B=X,q=Z)}}return B||(B=S[S.length-1]),B.from<D&&(B={from:D,to:B.to,level:B.level}),B.to>j&&(B={from:B.from,to:j,level:B.level}),B}function textHeight(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==De){De=elt("pre",null,"CodeMirror-line-like");for(var r=0;r<49;++r)De.appendChild(document.createTextNode("x")),De.appendChild(elt("br"));De.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(t.measure,De);var a=De.offsetHeight/50;return a>3&&(t.cachedTextHeight=a),removeChildren(t.measure),a||1}function charWidth(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var r=elt("span","xxxxxxxxxx"),a=elt("pre",[r],"CodeMirror-line-like");removeChildrenAndAdd(t.measure,a);var l=r.getBoundingClientRect(),S=(l.right-l.left)/10;return S>2&&(t.cachedCharWidth=S),S||10}function getDimensions(t){for(var r=t.display,a={},l={},S=r.gutters.clientLeft,O=r.gutters.firstChild,L=0;O;O=O.nextSibling,++L){var E=t.display.gutterSpecs[L].className;a[E]=O.offsetLeft+O.clientLeft+S,l[E]=O.clientWidth}return{fixedPos:compensateForHScroll(r),gutterTotalWidth:r.gutters.offsetWidth,gutterLeft:a,gutterWidth:l,wrapperWidth:r.wrapper.clientWidth}}function compensateForHScroll(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function estimateHeight(t){var r=textHeight(t.display),a=t.options.lineWrapping,l=a&&Math.max(5,t.display.scroller.clientWidth/charWidth(t.display)-3);return function(S){if(lineIsHidden(t.doc,S))return 0;var O=0;if(S.widgets)for(var L=0;L<S.widgets.length;L++)S.widgets[L].height&&(O+=S.widgets[L].height);return a?O+(Math.ceil(S.text.length/l)||1)*r:O+r}}function estimateLineHeights(t){var r=t.doc,a=estimateHeight(t);r.iter((function(t){var r=a(t);r!=t.height&&updateLineHeight(t,r)}))}function posFromMouse(t,r,a,l){var S=t.display;if(!a&&"true"==e_target(r).getAttribute("cm-not-content"))return null;var O,L,E=S.lineSpace.getBoundingClientRect();try{O=r.clientX-E.left,L=r.clientY-E.top}catch(t){return null}var D,j=coordsChar(t,O,L);if(l&&j.xRel>0&&(D=getLine(t.doc,j.line).text).length==j.ch){var B=countColumn(D,D.length,t.options.tabSize)-D.length;j=Pos(j.line,Math.max(0,Math.round((O-paddingH(t.display).left)/charWidth(t.display))-B))}return j}function findViewIndex(t,r){if(r>=t.display.viewTo)return null;if((r-=t.display.viewFrom)<0)return null;for(var a=t.display.view,l=0;l<a.length;l++)if((r-=a[l].size)<0)return l}function regChange(t,r,a,l){null==r&&(r=t.doc.first),null==a&&(a=t.doc.first+t.doc.size),l||(l=0);var S=t.display;if(l&&a<S.viewTo&&(null==S.updateLineNumbers||S.updateLineNumbers>r)&&(S.updateLineNumbers=r),t.curOp.viewChanged=!0,r>=S.viewTo)Me&&visualLineNo(t.doc,r)<S.viewTo&&resetView(t);else if(a<=S.viewFrom)Me&&visualLineEndNo(t.doc,a+l)>S.viewFrom?resetView(t):(S.viewFrom+=l,S.viewTo+=l);else if(r<=S.viewFrom&&a>=S.viewTo)resetView(t);else if(r<=S.viewFrom){var O=viewCuttingPoint(t,a,a+l,1);O?(S.view=S.view.slice(O.index),S.viewFrom=O.lineN,S.viewTo+=l):resetView(t)}else if(a>=S.viewTo){var L=viewCuttingPoint(t,r,r,-1);L?(S.view=S.view.slice(0,L.index),S.viewTo=L.lineN):resetView(t)}else{var E=viewCuttingPoint(t,r,r,-1),D=viewCuttingPoint(t,a,a+l,1);E&&D?(S.view=S.view.slice(0,E.index).concat(buildViewArray(t,E.lineN,D.lineN)).concat(S.view.slice(D.index)),S.viewTo+=l):resetView(t)}var j=S.externalMeasured;j&&(a<j.lineN?j.lineN+=l:r<j.lineN+j.size&&(S.externalMeasured=null))}function regLineChange(t,r,a){t.curOp.viewChanged=!0;var l=t.display,S=t.display.externalMeasured;if(S&&r>=S.lineN&&r<S.lineN+S.size&&(l.externalMeasured=null),!(r<l.viewFrom||r>=l.viewTo)){var O=l.view[findViewIndex(t,r)];if(null!=O.node){var L=O.changes||(O.changes=[]);-1==indexOf(L,a)&&L.push(a)}}}function resetView(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function viewCuttingPoint(t,r,a,l){var S,O=findViewIndex(t,r),L=t.display.view;if(!Me||a==t.doc.first+t.doc.size)return{index:O,lineN:a};for(var E=t.display.viewFrom,D=0;D<O;D++)E+=L[D].size;if(E!=r){if(l>0){if(O==L.length-1)return null;S=E+L[O].size-r,O++}else S=E-r;r+=S,a+=S}for(;visualLineNo(t.doc,a)!=a;){if(O==(l<0?0:L.length-1))return null;a+=l*L[O-(l<0?1:0)].size,O+=l}return{index:O,lineN:a}}function countDirtyView(t){for(var r=t.display.view,a=0,l=0;l<r.length;l++){var S=r[l];S.hidden||S.node&&!S.changes||++a}return a}function updateSelection(t){t.display.input.showSelection(t.display.input.prepareSelection())}function prepareSelection(t,r){void 0===r&&(r=!0);for(var a=t.doc,l={},S=l.cursors=document.createDocumentFragment(),O=l.selection=document.createDocumentFragment(),L=0;L<a.sel.ranges.length;L++)if(r||L!=a.sel.primIndex){var E=a.sel.ranges[L];if(!(E.from().line>=t.display.viewTo||E.to().line<t.display.viewFrom)){var D=E.empty();(D||t.options.showCursorWhenSelecting)&&drawSelectionCursor(t,E.head,S),D||drawSelectionRange(t,E,O)}}return l}function drawSelectionCursor(t,r,a){var l=cursorCoords(t,r,"div",null,null,!t.options.singleCursorHeightPerLine),S=a.appendChild(elt("div"," ","CodeMirror-cursor"));if(S.style.left=l.left+"px",S.style.top=l.top+"px",S.style.height=Math.max(0,l.bottom-l.top)*t.options.cursorHeight+"px",l.other){var O=a.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));O.style.display="",O.style.left=l.other.left+"px",O.style.top=l.other.top+"px",O.style.height=.85*(l.other.bottom-l.other.top)+"px"}}function cmpCoords(t,r){return t.top-r.top||t.left-r.left}function drawSelectionRange(t,r,a){var l=t.display,S=t.doc,O=document.createDocumentFragment(),L=paddingH(t.display),E=L.left,D=Math.max(l.sizerWidth,displayWidth(t)-l.sizer.offsetLeft)-L.right,j="ltr"==S.direction;function add(t,r,a,l){r<0&&(r=0),r=Math.round(r),l=Math.round(l),O.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+r+"px; width: "+(null==a?D-t:a)+"px;\n                             height: "+(l-r)+"px"))}function drawForLine(r,a,l){var O,L,B=getLine(S,r),q=B.text.length;function coords(a,l){return charCoords(t,Pos(r,a),"div",B,l)}function wrapX(r,a,l){var S=wrappedLineExtentChar(t,B,null,r),O="ltr"==a==("after"==l)?"left":"right";return coords("after"==l?S.begin:S.end-(/\s/.test(B.text.charAt(S.end-1))?2:1),O)[O]}var G=getOrder(B,S.direction);return function iterateBidiSections(t,r,a,l){if(!t)return l(r,a,"ltr",0);for(var S=!1,O=0;O<t.length;++O){var L=t[O];(L.from<a&&L.to>r||r==a&&L.to==r)&&(l(Math.max(L.from,r),Math.min(L.to,a),1==L.level?"rtl":"ltr",O),S=!0)}S||l(r,a,"ltr")}(G,a||0,null==l?q:l,(function(t,r,S,B){var X="ltr"==S,$=coords(t,X?"left":"right"),Z=coords(r-1,X?"right":"left"),Q=null==a&&0==t,ee=null==l&&r==q,te=0==B,ne=!G||B==G.length-1;if(Z.top-$.top<=3){var re=(j?ee:Q)&&ne,oe=(j?Q:ee)&&te?E:(X?$:Z).left,ie=re?D:(X?Z:$).right;add(oe,$.top,ie-oe,$.bottom)}else{var ae,se,le,ce;X?(ae=j&&Q&&te?E:$.left,se=j?D:wrapX(t,S,"before"),le=j?E:wrapX(r,S,"after"),ce=j&&ee&&ne?D:Z.right):(ae=j?wrapX(t,S,"before"):E,se=!j&&Q&&te?D:$.right,le=!j&&ee&&ne?E:Z.left,ce=j?wrapX(r,S,"after"):D),add(ae,$.top,se-ae,$.bottom),$.bottom<Z.top&&add(E,$.bottom,null,Z.top),add(le,Z.top,ce-le,Z.bottom)}(!O||cmpCoords($,O)<0)&&(O=$),cmpCoords(Z,O)<0&&(O=Z),(!L||cmpCoords($,L)<0)&&(L=$),cmpCoords(Z,L)<0&&(L=Z)})),{start:O,end:L}}var B=r.from(),q=r.to();if(B.line==q.line)drawForLine(B.line,B.ch,q.ch);else{var G=getLine(S,B.line),X=getLine(S,q.line),$=visualLine(G)==visualLine(X),Z=drawForLine(B.line,B.ch,$?G.text.length+1:null).end,Q=drawForLine(q.line,$?0:null,q.ch).start;$&&(Z.top<Q.top-2?(add(Z.right,Z.top,null,Z.bottom),add(E,Q.top,Q.left,Q.bottom)):add(Z.right,Z.top,Q.left-Z.right,Z.bottom)),Z.bottom<Q.top&&add(E,Z.bottom,null,Q.top)}a.appendChild(O)}function restartBlink(t){if(t.state.focused){var r=t.display;clearInterval(r.blinker);var a=!0;r.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?r.blinker=setInterval((function(){t.hasFocus()||onBlur(t),r.cursorDiv.style.visibility=(a=!a)?"":"hidden"}),t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(r.cursorDiv.style.visibility="hidden")}}function ensureFocus(t){t.hasFocus()||(t.display.input.focus(),t.state.focused||onFocus(t))}function delayBlurEvent(t){t.state.delayingBlurEvent=!0,setTimeout((function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,t.state.focused&&onBlur(t))}),100)}function onFocus(t,r){t.state.delayingBlurEvent&&!t.state.draggingText&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(signal(t,"focus",t,r),t.state.focused=!0,addClass(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),D&&setTimeout((function(){return t.display.input.reset(!0)}),20)),t.display.input.receivedFocus()),restartBlink(t))}function onBlur(t,r){t.state.delayingBlurEvent||(t.state.focused&&(signal(t,"blur",t,r),t.state.focused=!1,rmClass(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout((function(){t.state.focused||(t.display.shift=!1)}),150))}function updateHeightsInViewport(t){for(var r=t.display,a=r.lineDiv.offsetTop,l=0;l<r.view.length;l++){var S=r.view[l],O=t.options.lineWrapping,D=void 0,j=0;if(!S.hidden){if(L&&E<8){var B=S.node.offsetTop+S.node.offsetHeight;D=B-a,a=B}else{var q=S.node.getBoundingClientRect();D=q.bottom-q.top,!O&&S.text.firstChild&&(j=S.text.firstChild.getBoundingClientRect().right-q.left-1)}var G=S.line.height-D;if((G>.005||G<-.005)&&(updateLineHeight(S.line,D),updateWidgetHeight(S.line),S.rest))for(var X=0;X<S.rest.length;X++)updateWidgetHeight(S.rest[X]);if(j>t.display.sizerWidth){var $=Math.ceil(j/charWidth(t.display));$>t.display.maxLineLength&&(t.display.maxLineLength=$,t.display.maxLine=S.line,t.display.maxLineChanged=!0)}}}}function updateWidgetHeight(t){if(t.widgets)for(var r=0;r<t.widgets.length;++r){var a=t.widgets[r],l=a.node.parentNode;l&&(a.height=l.offsetHeight)}}function visibleLines(t,r,a){var l=a&&null!=a.top?Math.max(0,a.top):t.scroller.scrollTop;l=Math.floor(l-paddingTop(t));var S=a&&null!=a.bottom?a.bottom:l+t.wrapper.clientHeight,O=lineAtHeight(r,l),L=lineAtHeight(r,S);if(a&&a.ensure){var E=a.ensure.from.line,D=a.ensure.to.line;E<O?(O=E,L=lineAtHeight(r,heightAtLine(getLine(r,E))+t.wrapper.clientHeight)):Math.min(D,r.lastLine())>=L&&(O=lineAtHeight(r,heightAtLine(getLine(r,D))-t.wrapper.clientHeight),L=D)}return{from:O,to:Math.max(L,O+1)}}function calculateScrollPos(t,r){var a=t.display,l=textHeight(t.display);r.top<0&&(r.top=0);var S=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:a.scroller.scrollTop,O=displayHeight(t),L={};r.bottom-r.top>O&&(r.bottom=r.top+O);var E=t.doc.height+paddingVert(a),D=r.top<l,j=r.bottom>E-l;if(r.top<S)L.scrollTop=D?0:r.top;else if(r.bottom>S+O){var B=Math.min(r.top,(j?E:r.bottom)-O);B!=S&&(L.scrollTop=B)}var q=t.options.fixedGutter?0:a.gutters.offsetWidth,G=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:a.scroller.scrollLeft-q,X=displayWidth(t)-a.gutters.offsetWidth,$=r.right-r.left>X;return $&&(r.right=r.left+X),r.left<10?L.scrollLeft=0:r.left<G?L.scrollLeft=Math.max(0,r.left+q-($?0:10)):r.right>X+G-3&&(L.scrollLeft=r.right+($?0:10)-X),L}function addToScrollTop(t,r){null!=r&&(resolveScrollToPos(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+r)}function ensureCursorVisible(t){resolveScrollToPos(t);var r=t.getCursor();t.curOp.scrollToPos={from:r,to:r,margin:t.options.cursorScrollMargin}}function scrollToCoords(t,r,a){null==r&&null==a||resolveScrollToPos(t),null!=r&&(t.curOp.scrollLeft=r),null!=a&&(t.curOp.scrollTop=a)}function resolveScrollToPos(t){var r=t.curOp.scrollToPos;r&&(t.curOp.scrollToPos=null,scrollToCoordsRange(t,estimateCoords(t,r.from),estimateCoords(t,r.to),r.margin))}function scrollToCoordsRange(t,r,a,l){var S=calculateScrollPos(t,{left:Math.min(r.left,a.left),top:Math.min(r.top,a.top)-l,right:Math.max(r.right,a.right),bottom:Math.max(r.bottom,a.bottom)+l});scrollToCoords(t,S.scrollLeft,S.scrollTop)}function updateScrollTop(t,r){Math.abs(t.doc.scrollTop-r)<2||(a||updateDisplaySimple(t,{top:r}),setScrollTop(t,r,!0),a&&updateDisplaySimple(t),startWorker(t,100))}function setScrollTop(t,r,a){r=Math.max(0,Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,r)),(t.display.scroller.scrollTop!=r||a)&&(t.doc.scrollTop=r,t.display.scrollbars.setScrollTop(r),t.display.scroller.scrollTop!=r&&(t.display.scroller.scrollTop=r))}function setScrollLeft(t,r,a,l){r=Math.max(0,Math.min(r,t.display.scroller.scrollWidth-t.display.scroller.clientWidth)),(a?r==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-r)<2)&&!l||(t.doc.scrollLeft=r,alignHorizontally(t),t.display.scroller.scrollLeft!=r&&(t.display.scroller.scrollLeft=r),t.display.scrollbars.setScrollLeft(r))}function measureForScrollbars(t){var r=t.display,a=r.gutters.offsetWidth,l=Math.round(t.doc.height+paddingVert(t.display));return{clientHeight:r.scroller.clientHeight,viewHeight:r.wrapper.clientHeight,scrollWidth:r.scroller.scrollWidth,clientWidth:r.scroller.clientWidth,viewWidth:r.wrapper.clientWidth,barLeft:t.options.fixedGutter?a:0,docHeight:l,scrollHeight:l+scrollGap(t)+r.barHeight,nativeBarWidth:r.nativeBarWidth,gutterWidth:a}}var NativeScrollbars=function(t,r,a){this.cm=a;var l=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),S=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");l.tabIndex=S.tabIndex=-1,t(l),t(S),on(l,"scroll",(function(){l.clientHeight&&r(l.scrollTop,"vertical")})),on(S,"scroll",(function(){S.clientWidth&&r(S.scrollLeft,"horizontal")})),this.checkedZeroWidth=!1,L&&E<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};NativeScrollbars.prototype.update=function(t){var r=t.scrollWidth>t.clientWidth+1,a=t.scrollHeight>t.clientHeight+1,l=t.nativeBarWidth;if(a){this.vert.style.display="block",this.vert.style.bottom=r?l+"px":"0";var S=t.viewHeight-(r?l:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+S)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(r){this.horiz.style.display="block",this.horiz.style.right=a?l+"px":"0",this.horiz.style.left=t.barLeft+"px";var O=t.viewWidth-t.barLeft-(a?l:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+O)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==l&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:a?l:0,bottom:r?l:0}},NativeScrollbars.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},NativeScrollbars.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},NativeScrollbars.prototype.zeroWidthHack=function(){var t=te&&!X?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Delayed,this.disableVert=new Delayed},NativeScrollbars.prototype.enableZeroWidthBar=function(t,r,a){t.style.pointerEvents="auto",r.set(1e3,(function maybeDisable(){var l=t.getBoundingClientRect();("vert"==a?document.elementFromPoint(l.right-1,(l.top+l.bottom)/2):document.elementFromPoint((l.right+l.left)/2,l.bottom-1))!=t?t.style.pointerEvents="none":r.set(1e3,maybeDisable)}))},NativeScrollbars.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var NullScrollbars=function(){};function updateScrollbars(t,r){r||(r=measureForScrollbars(t));var a=t.display.barWidth,l=t.display.barHeight;updateScrollbarsInner(t,r);for(var S=0;S<4&&a!=t.display.barWidth||l!=t.display.barHeight;S++)a!=t.display.barWidth&&t.options.lineWrapping&&updateHeightsInViewport(t),updateScrollbarsInner(t,measureForScrollbars(t)),a=t.display.barWidth,l=t.display.barHeight}function updateScrollbarsInner(t,r){var a=t.display,l=a.scrollbars.update(r);a.sizer.style.paddingRight=(a.barWidth=l.right)+"px",a.sizer.style.paddingBottom=(a.barHeight=l.bottom)+"px",a.heightForcer.style.borderBottom=l.bottom+"px solid transparent",l.right&&l.bottom?(a.scrollbarFiller.style.display="block",a.scrollbarFiller.style.height=l.bottom+"px",a.scrollbarFiller.style.width=l.right+"px"):a.scrollbarFiller.style.display="",l.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(a.gutterFiller.style.display="block",a.gutterFiller.style.height=l.bottom+"px",a.gutterFiller.style.width=r.gutterWidth+"px"):a.gutterFiller.style.display=""}NullScrollbars.prototype.update=function(){return{bottom:0,right:0}},NullScrollbars.prototype.setScrollLeft=function(){},NullScrollbars.prototype.setScrollTop=function(){},NullScrollbars.prototype.clear=function(){};var ze={native:NativeScrollbars,null:NullScrollbars};function initScrollbars(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&rmClass(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new ze[t.options.scrollbarStyle]((function(r){t.display.wrapper.insertBefore(r,t.display.scrollbarFiller),on(r,"mousedown",(function(){t.state.focused&&setTimeout((function(){return t.display.input.focus()}),0)})),r.setAttribute("cm-not-content","true")}),(function(r,a){"horizontal"==a?setScrollLeft(t,r):updateScrollTop(t,r)}),t),t.display.scrollbars.addClass&&addClass(t.display.wrapper,t.display.scrollbars.addClass)}var Fe=0;function startOperation(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Fe},function pushOperation(t){Ae?Ae.ops.push(t):t.ownsGroup=Ae={ops:[t],delayedCallbacks:[]}}(t.curOp)}function endOperation(t){var r=t.curOp;r&&function finishOperation(t,r){var a=t.ownsGroup;if(a)try{!function fireCallbacksForOps(t){var r=t.delayedCallbacks,a=0;do{for(;a<r.length;a++)r[a].call(null);for(var l=0;l<t.ops.length;l++){var S=t.ops[l];if(S.cursorActivityHandlers)for(;S.cursorActivityCalled<S.cursorActivityHandlers.length;)S.cursorActivityHandlers[S.cursorActivityCalled++].call(null,S.cm)}}while(a<r.length)}(a)}finally{Ae=null,r(a)}}(r,(function(t){for(var r=0;r<t.ops.length;r++)t.ops[r].cm.curOp=null;!function endOperations(t){for(var r=t.ops,a=0;a<r.length;a++)endOperation_R1(r[a]);for(var l=0;l<r.length;l++)endOperation_W1(r[l]);for(var S=0;S<r.length;S++)endOperation_R2(r[S]);for(var O=0;O<r.length;O++)endOperation_W2(r[O]);for(var L=0;L<r.length;L++)endOperation_finish(r[L])}(t)}))}function endOperation_R1(t){var r=t.cm,a=r.display;!function maybeClipScrollbars(t){var r=t.display;!r.scrollbarsClipped&&r.scroller.offsetWidth&&(r.nativeBarWidth=r.scroller.offsetWidth-r.scroller.clientWidth,r.heightForcer.style.height=scrollGap(t)+"px",r.sizer.style.marginBottom=-r.nativeBarWidth+"px",r.sizer.style.borderRightWidth=scrollGap(t)+"px",r.scrollbarsClipped=!0)}(r),t.updateMaxLine&&findMaxLine(r),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<a.viewFrom||t.scrollToPos.to.line>=a.viewTo)||a.maxLineChanged&&r.options.lineWrapping,t.update=t.mustUpdate&&new DisplayUpdate(r,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function endOperation_W1(t){t.updatedDisplay=t.mustUpdate&&updateDisplayIfNeeded(t.cm,t.update)}function endOperation_R2(t){var r=t.cm,a=r.display;t.updatedDisplay&&updateHeightsInViewport(r),t.barMeasure=measureForScrollbars(r),a.maxLineChanged&&!r.options.lineWrapping&&(t.adjustWidthTo=measureChar(r,a.maxLine,a.maxLine.text.length).left+3,r.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(a.scroller.clientWidth,a.sizer.offsetLeft+t.adjustWidthTo+scrollGap(r)+r.display.barWidth),t.maxScrollLeft=Math.max(0,a.sizer.offsetLeft+t.adjustWidthTo-displayWidth(r))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=a.input.prepareSelection())}function endOperation_W2(t){var r=t.cm;null!=t.adjustWidthTo&&(r.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<r.doc.scrollLeft&&setScrollLeft(r,Math.min(r.display.scroller.scrollLeft,t.maxScrollLeft),!0),r.display.maxLineChanged=!1);var a=t.focus&&t.focus==activeElt();t.preparedSelection&&r.display.input.showSelection(t.preparedSelection,a),(t.updatedDisplay||t.startHeight!=r.doc.height)&&updateScrollbars(r,t.barMeasure),t.updatedDisplay&&setDocumentHeight(r,t.barMeasure),t.selectionChanged&&restartBlink(r),r.state.focused&&t.updateInput&&r.display.input.reset(t.typing),a&&ensureFocus(t.cm)}function endOperation_finish(t){var r=t.cm,a=r.display,l=r.doc;t.updatedDisplay&&postUpdateDisplay(r,t.update),null==a.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(a.wheelStartX=a.wheelStartY=null),null!=t.scrollTop&&setScrollTop(r,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&setScrollLeft(r,t.scrollLeft,!0,!0),t.scrollToPos&&function maybeScrollWindow(t,r){if(!signalDOMEvent(t,"scrollCursorIntoView")){var a=t.display,l=a.sizer.getBoundingClientRect(),S=null;if(r.top+l.top<0?S=!0:r.bottom+l.top>(window.innerHeight||document.documentElement.clientHeight)&&(S=!1),null!=S&&!$){var O=elt("div","​",null,"position: absolute;\n                         top: "+(r.top-a.viewOffset-paddingTop(t.display))+"px;\n                         height: "+(r.bottom-r.top+scrollGap(t)+a.barHeight)+"px;\n                         left: "+r.left+"px; width: "+Math.max(2,r.right-r.left)+"px;");t.display.lineSpace.appendChild(O),O.scrollIntoView(S),t.display.lineSpace.removeChild(O)}}}(r,function scrollPosIntoView(t,r,a,l){var S;null==l&&(l=0),t.options.lineWrapping||r!=a||(a="before"==(r=r.ch?Pos(r.line,"before"==r.sticky?r.ch-1:r.ch,"after"):r).sticky?Pos(r.line,r.ch+1,"before"):r);for(var O=0;O<5;O++){var L=!1,E=cursorCoords(t,r),D=a&&a!=r?cursorCoords(t,a):E,j=calculateScrollPos(t,S={left:Math.min(E.left,D.left),top:Math.min(E.top,D.top)-l,right:Math.max(E.left,D.left),bottom:Math.max(E.bottom,D.bottom)+l}),B=t.doc.scrollTop,q=t.doc.scrollLeft;if(null!=j.scrollTop&&(updateScrollTop(t,j.scrollTop),Math.abs(t.doc.scrollTop-B)>1&&(L=!0)),null!=j.scrollLeft&&(setScrollLeft(t,j.scrollLeft),Math.abs(t.doc.scrollLeft-q)>1&&(L=!0)),!L)break}return S}(r,clipPos(l,t.scrollToPos.from),clipPos(l,t.scrollToPos.to),t.scrollToPos.margin));var S=t.maybeHiddenMarkers,O=t.maybeUnhiddenMarkers;if(S)for(var L=0;L<S.length;++L)S[L].lines.length||signal(S[L],"hide");if(O)for(var E=0;E<O.length;++E)O[E].lines.length&&signal(O[E],"unhide");a.wrapper.offsetHeight&&(l.scrollTop=r.display.scroller.scrollTop),t.changeObjs&&signal(r,"changes",r,t.changeObjs),t.update&&t.update.finish()}function runInOp(t,r){if(t.curOp)return r();startOperation(t);try{return r()}finally{endOperation(t)}}function operation(t,r){return function(){if(t.curOp)return r.apply(t,arguments);startOperation(t);try{return r.apply(t,arguments)}finally{endOperation(t)}}}function methodOp(t){return function(){if(this.curOp)return t.apply(this,arguments);startOperation(this);try{return t.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(t){return function(){var r=this.cm;if(!r||r.curOp)return t.apply(this,arguments);startOperation(r);try{return t.apply(this,arguments)}finally{endOperation(r)}}}function startWorker(t,r){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(r,bind(highlightWorker,t))}function highlightWorker(t){var r=t.doc;if(!(r.highlightFrontier>=t.display.viewTo)){var a=+new Date+t.options.workTime,l=getContextBefore(t,r.highlightFrontier),S=[];r.iter(l.line,Math.min(r.first+r.size,t.display.viewTo+500),(function(O){if(l.line>=t.display.viewFrom){var L=O.styles,E=O.text.length>t.options.maxHighlightLength?copyState(r.mode,l.state):null,D=highlightLine(t,O,l,!0);E&&(l.state=E),O.styles=D.styles;var j=O.styleClasses,B=D.classes;B?O.styleClasses=B:j&&(O.styleClasses=null);for(var q=!L||L.length!=O.styles.length||j!=B&&(!j||!B||j.bgClass!=B.bgClass||j.textClass!=B.textClass),G=0;!q&&G<L.length;++G)q=L[G]!=O.styles[G];q&&S.push(l.line),O.stateAfter=l.save(),l.nextLine()}else O.text.length<=t.options.maxHighlightLength&&processLine(t,O.text,l),O.stateAfter=l.line%5==0?l.save():null,l.nextLine();if(+new Date>a)return startWorker(t,t.options.workDelay),!0})),r.highlightFrontier=l.line,r.modeFrontier=Math.max(r.modeFrontier,l.line),S.length&&runInOp(t,(function(){for(var r=0;r<S.length;r++)regLineChange(t,S[r],"text")}))}}var DisplayUpdate=function(t,r,a){var l=t.display;this.viewport=r,this.visible=visibleLines(l,t.doc,r),this.editorIsHidden=!l.wrapper.offsetWidth,this.wrapperHeight=l.wrapper.clientHeight,this.wrapperWidth=l.wrapper.clientWidth,this.oldDisplayWidth=displayWidth(t),this.force=a,this.dims=getDimensions(t),this.events=[]};function updateDisplayIfNeeded(t,r){var a=t.display,l=t.doc;if(r.editorIsHidden)return resetView(t),!1;if(!r.force&&r.visible.from>=a.viewFrom&&r.visible.to<=a.viewTo&&(null==a.updateLineNumbers||a.updateLineNumbers>=a.viewTo)&&a.renderedView==a.view&&0==countDirtyView(t))return!1;maybeUpdateLineNumberWidth(t)&&(resetView(t),r.dims=getDimensions(t));var S=l.first+l.size,O=Math.max(r.visible.from-t.options.viewportMargin,l.first),L=Math.min(S,r.visible.to+t.options.viewportMargin);a.viewFrom<O&&O-a.viewFrom<20&&(O=Math.max(l.first,a.viewFrom)),a.viewTo>L&&a.viewTo-L<20&&(L=Math.min(S,a.viewTo)),Me&&(O=visualLineNo(t.doc,O),L=visualLineEndNo(t.doc,L));var E=O!=a.viewFrom||L!=a.viewTo||a.lastWrapHeight!=r.wrapperHeight||a.lastWrapWidth!=r.wrapperWidth;!function adjustView(t,r,a){var l=t.display;0==l.view.length||r>=l.viewTo||a<=l.viewFrom?(l.view=buildViewArray(t,r,a),l.viewFrom=r):(l.viewFrom>r?l.view=buildViewArray(t,r,l.viewFrom).concat(l.view):l.viewFrom<r&&(l.view=l.view.slice(findViewIndex(t,r))),l.viewFrom=r,l.viewTo<a?l.view=l.view.concat(buildViewArray(t,l.viewTo,a)):l.viewTo>a&&(l.view=l.view.slice(0,findViewIndex(t,a)))),l.viewTo=a}(t,O,L),a.viewOffset=heightAtLine(getLine(t.doc,a.viewFrom)),t.display.mover.style.top=a.viewOffset+"px";var j=countDirtyView(t);if(!E&&0==j&&!r.force&&a.renderedView==a.view&&(null==a.updateLineNumbers||a.updateLineNumbers>=a.viewTo))return!1;var B=function selectionSnapshot(t){if(t.hasFocus())return null;var r=activeElt();if(!r||!contains(t.display.lineDiv,r))return null;var a={activeElt:r};if(window.getSelection){var l=window.getSelection();l.anchorNode&&l.extend&&contains(t.display.lineDiv,l.anchorNode)&&(a.anchorNode=l.anchorNode,a.anchorOffset=l.anchorOffset,a.focusNode=l.focusNode,a.focusOffset=l.focusOffset)}return a}(t);return j>4&&(a.lineDiv.style.display="none"),function patchDisplay(t,r,a){var l=t.display,S=t.options.lineNumbers,O=l.lineDiv,L=O.firstChild;function rm(r){var a=r.nextSibling;return D&&te&&t.display.currentWheelTarget==r?r.style.display="none":r.parentNode.removeChild(r),a}for(var E=l.view,j=l.viewFrom,B=0;B<E.length;B++){var q=E[B];if(q.hidden);else if(q.node&&q.node.parentNode==O){for(;L!=q.node;)L=rm(L);var G=S&&null!=r&&r<=j&&q.lineNumber;q.changes&&(indexOf(q.changes,"gutter")>-1&&(G=!1),updateLineForChanges(t,q,j,a)),G&&(removeChildren(q.lineNumber),q.lineNumber.appendChild(document.createTextNode(lineNumberFor(t.options,j)))),L=q.node.nextSibling}else{var X=buildLineElement(t,q,j,a);O.insertBefore(X,L)}j+=q.size}for(;L;)L=rm(L)}(t,a.updateLineNumbers,r.dims),j>4&&(a.lineDiv.style.display=""),a.renderedView=a.view,function restoreSelection(t){if(t&&t.activeElt&&t.activeElt!=activeElt()&&(t.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(t.activeElt.nodeName)&&t.anchorNode&&contains(document.body,t.anchorNode)&&contains(document.body,t.focusNode))){var r=window.getSelection(),a=document.createRange();a.setEnd(t.anchorNode,t.anchorOffset),a.collapse(!1),r.removeAllRanges(),r.addRange(a),r.extend(t.focusNode,t.focusOffset)}}(B),removeChildren(a.cursorDiv),removeChildren(a.selectionDiv),a.gutters.style.height=a.sizer.style.minHeight=0,E&&(a.lastWrapHeight=r.wrapperHeight,a.lastWrapWidth=r.wrapperWidth,startWorker(t,400)),a.updateLineNumbers=null,!0}function postUpdateDisplay(t,r){for(var a=r.viewport,l=!0;;l=!1){if(l&&t.options.lineWrapping&&r.oldDisplayWidth!=displayWidth(t))l&&(r.visible=visibleLines(t.display,t.doc,a));else if(a&&null!=a.top&&(a={top:Math.min(t.doc.height+paddingVert(t.display)-displayHeight(t),a.top)}),r.visible=visibleLines(t.display,t.doc,a),r.visible.from>=t.display.viewFrom&&r.visible.to<=t.display.viewTo)break;if(!updateDisplayIfNeeded(t,r))break;updateHeightsInViewport(t);var S=measureForScrollbars(t);updateSelection(t),updateScrollbars(t,S),setDocumentHeight(t,S),r.force=!1}r.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(r.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function updateDisplaySimple(t,r){var a=new DisplayUpdate(t,r);if(updateDisplayIfNeeded(t,a)){updateHeightsInViewport(t),postUpdateDisplay(t,a);var l=measureForScrollbars(t);updateSelection(t),updateScrollbars(t,l),setDocumentHeight(t,l),a.finish()}}function updateGutterSpace(t){var r=t.gutters.offsetWidth;t.sizer.style.marginLeft=r+"px",signalLater(t,"gutterChanged",t)}function setDocumentHeight(t,r){t.display.sizer.style.minHeight=r.docHeight+"px",t.display.heightForcer.style.top=r.docHeight+"px",t.display.gutters.style.height=r.docHeight+t.display.barHeight+scrollGap(t)+"px"}function alignHorizontally(t){var r=t.display,a=r.view;if(r.alignWidgets||r.gutters.firstChild&&t.options.fixedGutter){for(var l=compensateForHScroll(r)-r.scroller.scrollLeft+t.doc.scrollLeft,S=r.gutters.offsetWidth,O=l+"px",L=0;L<a.length;L++)if(!a[L].hidden){t.options.fixedGutter&&(a[L].gutter&&(a[L].gutter.style.left=O),a[L].gutterBackground&&(a[L].gutterBackground.style.left=O));var E=a[L].alignable;if(E)for(var D=0;D<E.length;D++)E[D].style.left=O}t.options.fixedGutter&&(r.gutters.style.left=l+S+"px")}}function maybeUpdateLineNumberWidth(t){if(!t.options.lineNumbers)return!1;var r=t.doc,a=lineNumberFor(t.options,r.first+r.size-1),l=t.display;if(a.length!=l.lineNumChars){var S=l.measure.appendChild(elt("div",[elt("div",a)],"CodeMirror-linenumber CodeMirror-gutter-elt")),O=S.firstChild.offsetWidth,L=S.offsetWidth-O;return l.lineGutter.style.width="",l.lineNumInnerWidth=Math.max(O,l.lineGutter.offsetWidth-L)+1,l.lineNumWidth=l.lineNumInnerWidth+L,l.lineNumChars=l.lineNumInnerWidth?a.length:-1,l.lineGutter.style.width=l.lineNumWidth+"px",updateGutterSpace(t.display),!0}return!1}function getGutters(t,r){for(var a=[],l=!1,S=0;S<t.length;S++){var O=t[S],L=null;if("string"!=typeof O&&(L=O.style,O=O.className),"CodeMirror-linenumbers"==O){if(!r)continue;l=!0}a.push({className:O,style:L})}return r&&!l&&a.push({className:"CodeMirror-linenumbers",style:null}),a}function renderGutters(t){var r=t.gutters,a=t.gutterSpecs;removeChildren(r),t.lineGutter=null;for(var l=0;l<a.length;++l){var S=a[l],O=S.className,L=S.style,E=r.appendChild(elt("div",null,"CodeMirror-gutter "+O));L&&(E.style.cssText=L),"CodeMirror-linenumbers"==O&&(t.lineGutter=E,E.style.width=(t.lineNumWidth||1)+"px")}r.style.display=a.length?"":"none",updateGutterSpace(t)}function updateGutters(t){renderGutters(t.display),regChange(t),alignHorizontally(t)}function Display(t,r,l,S){var O=this;this.input=l,O.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),O.scrollbarFiller.setAttribute("cm-not-content","true"),O.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),O.gutterFiller.setAttribute("cm-not-content","true"),O.lineDiv=eltP("div",null,"CodeMirror-code"),O.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),O.cursorDiv=elt("div",null,"CodeMirror-cursors"),O.measure=elt("div",null,"CodeMirror-measure"),O.lineMeasure=elt("div",null,"CodeMirror-measure"),O.lineSpace=eltP("div",[O.measure,O.lineMeasure,O.selectionDiv,O.cursorDiv,O.lineDiv],null,"position: relative; outline: none");var j=eltP("div",[O.lineSpace],"CodeMirror-lines");O.mover=elt("div",[j],null,"position: relative"),O.sizer=elt("div",[O.mover],"CodeMirror-sizer"),O.sizerWidth=null,O.heightForcer=elt("div",null,null,"position: absolute; height: 50px; width: 1px;"),O.gutters=elt("div",null,"CodeMirror-gutters"),O.lineGutter=null,O.scroller=elt("div",[O.sizer,O.heightForcer,O.gutters],"CodeMirror-scroll"),O.scroller.setAttribute("tabIndex","-1"),O.wrapper=elt("div",[O.scrollbarFiller,O.gutterFiller,O.scroller],"CodeMirror"),L&&E<8&&(O.gutters.style.zIndex=-1,O.scroller.style.paddingRight=0),D||a&&ee||(O.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(O.wrapper):t(O.wrapper)),O.viewFrom=O.viewTo=r.first,O.reportedViewFrom=O.reportedViewTo=r.first,O.view=[],O.renderedView=null,O.externalMeasured=null,O.viewOffset=0,O.lastWrapHeight=O.lastWrapWidth=0,O.updateLineNumbers=null,O.nativeBarWidth=O.barHeight=O.barWidth=0,O.scrollbarsClipped=!1,O.lineNumWidth=O.lineNumInnerWidth=O.lineNumChars=null,O.alignWidgets=!1,O.cachedCharWidth=O.cachedTextHeight=O.cachedPaddingH=null,O.maxLine=null,O.maxLineLength=0,O.maxLineChanged=!1,O.wheelDX=O.wheelDY=O.wheelStartX=O.wheelStartY=null,O.shift=!1,O.selForContextMenu=null,O.activeTouch=null,O.gutterSpecs=getGutters(S.gutters,S.lineNumbers),renderGutters(O),l.init(O)}DisplayUpdate.prototype.signal=function(t,r){hasHandler(t,r)&&this.events.push(arguments)},DisplayUpdate.prototype.finish=function(){for(var t=0;t<this.events.length;t++)signal.apply(null,this.events[t])};var We=0,je=null;function wheelEventDelta(t){var r=t.wheelDeltaX,a=t.wheelDeltaY;return null==r&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(r=t.detail),null==a&&t.detail&&t.axis==t.VERTICAL_AXIS?a=t.detail:null==a&&(a=t.wheelDelta),{x:r,y:a}}function wheelEventPixels(t){var r=wheelEventDelta(t);return r.x*=je,r.y*=je,r}function onScrollWheel(t,r){var l=wheelEventDelta(r),S=l.x,O=l.y,L=t.display,E=L.scroller,j=E.scrollWidth>E.clientWidth,B=E.scrollHeight>E.clientHeight;if(S&&j||O&&B){if(O&&te&&D)e:for(var G=r.target,X=L.view;G!=E;G=G.parentNode)for(var $=0;$<X.length;$++)if(X[$].node==G){t.display.currentWheelTarget=G;break e}if(S&&!a&&!q&&null!=je)return O&&B&&updateScrollTop(t,Math.max(0,E.scrollTop+O*je)),setScrollLeft(t,Math.max(0,E.scrollLeft+S*je)),(!O||O&&B)&&e_preventDefault(r),void(L.wheelStartX=null);if(O&&null!=je){var Z=O*je,Q=t.doc.scrollTop,ee=Q+L.wrapper.clientHeight;Z<0?Q=Math.max(0,Q+Z-50):ee=Math.min(t.doc.height,ee+Z+50),updateDisplaySimple(t,{top:Q,bottom:ee})}We<20&&(null==L.wheelStartX?(L.wheelStartX=E.scrollLeft,L.wheelStartY=E.scrollTop,L.wheelDX=S,L.wheelDY=O,setTimeout((function(){if(null!=L.wheelStartX){var t=E.scrollLeft-L.wheelStartX,r=E.scrollTop-L.wheelStartY,a=r&&L.wheelDY&&r/L.wheelDY||t&&L.wheelDX&&t/L.wheelDX;L.wheelStartX=L.wheelStartY=null,a&&(je=(je*We+a)/(We+1),++We)}}),200)):(L.wheelDX+=S,L.wheelDY+=O))}}L?je=-.53:a?je=15:B?je=-.7:G&&(je=-1/3);var Selection=function(t,r){this.ranges=t,this.primIndex=r};Selection.prototype.primary=function(){return this.ranges[this.primIndex]},Selection.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var r=0;r<this.ranges.length;r++){var a=this.ranges[r],l=t.ranges[r];if(!equalCursorPos(a.anchor,l.anchor)||!equalCursorPos(a.head,l.head))return!1}return!0},Selection.prototype.deepCopy=function(){for(var t=[],r=0;r<this.ranges.length;r++)t[r]=new Range(copyPos(this.ranges[r].anchor),copyPos(this.ranges[r].head));return new Selection(t,this.primIndex)},Selection.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},Selection.prototype.contains=function(t,r){r||(r=t);for(var a=0;a<this.ranges.length;a++){var l=this.ranges[a];if(cmp(r,l.from())>=0&&cmp(t,l.to())<=0)return a}return-1};var Range=function(t,r){this.anchor=t,this.head=r};function normalizeSelection(t,r,a){var l=t&&t.options.selectionsMayTouch,S=r[a];r.sort((function(t,r){return cmp(t.from(),r.from())})),a=indexOf(r,S);for(var O=1;O<r.length;O++){var L=r[O],E=r[O-1],D=cmp(E.to(),L.from());if(l&&!L.empty()?D>0:D>=0){var j=minPos(E.from(),L.from()),B=maxPos(E.to(),L.to()),q=E.empty()?L.from()==L.head:E.from()==E.head;O<=a&&--a,r.splice(--O,2,new Range(q?B:j,q?j:B))}}return new Selection(r,a)}function simpleSelection(t,r){return new Selection([new Range(t,r||t)],0)}function changeEnd(t){return t.text?Pos(t.from.line+t.text.length-1,lst(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function adjustForChange(t,r){if(cmp(t,r.from)<0)return t;if(cmp(t,r.to)<=0)return changeEnd(r);var a=t.line+r.text.length-(r.to.line-r.from.line)-1,l=t.ch;return t.line==r.to.line&&(l+=changeEnd(r).ch-r.to.ch),Pos(a,l)}function computeSelAfterChange(t,r){for(var a=[],l=0;l<t.sel.ranges.length;l++){var S=t.sel.ranges[l];a.push(new Range(adjustForChange(S.anchor,r),adjustForChange(S.head,r)))}return normalizeSelection(t.cm,a,t.sel.primIndex)}function offsetPos(t,r,a){return t.line==r.line?Pos(a.line,t.ch-r.ch+a.ch):Pos(a.line+(t.line-r.line),t.ch)}function loadMode(t){t.doc.mode=getMode(t.options,t.doc.modeOption),resetModeState(t)}function resetModeState(t){t.doc.iter((function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)})),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,startWorker(t,100),t.state.modeGen++,t.curOp&&regChange(t)}function isWholeLineUpdate(t,r){return 0==r.from.ch&&0==r.to.ch&&""==lst(r.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function updateDoc(t,r,a,l){function spansFor(t){return a?a[t]:null}function update(t,a,S){!function updateLine(t,r,a,l){t.text=r,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),detachMarkedSpans(t),attachMarkedSpans(t,a);var S=l?l(t):1;S!=t.height&&updateLineHeight(t,S)}(t,a,S,l),signalLater(t,"change",t,r)}function linesFor(t,r){for(var a=[],S=t;S<r;++S)a.push(new Line(L[S],spansFor(S),l));return a}var S=r.from,O=r.to,L=r.text,E=getLine(t,S.line),D=getLine(t,O.line),j=lst(L),B=spansFor(L.length-1),q=O.line-S.line;if(r.full)t.insert(0,linesFor(0,L.length)),t.remove(L.length,t.size-L.length);else if(isWholeLineUpdate(t,r)){var G=linesFor(0,L.length-1);update(D,D.text,B),q&&t.remove(S.line,q),G.length&&t.insert(S.line,G)}else if(E==D)if(1==L.length)update(E,E.text.slice(0,S.ch)+j+E.text.slice(O.ch),B);else{var X=linesFor(1,L.length-1);X.push(new Line(j+E.text.slice(O.ch),B,l)),update(E,E.text.slice(0,S.ch)+L[0],spansFor(0)),t.insert(S.line+1,X)}else if(1==L.length)update(E,E.text.slice(0,S.ch)+L[0]+D.text.slice(O.ch),spansFor(0)),t.remove(S.line+1,q);else{update(E,E.text.slice(0,S.ch)+L[0],spansFor(0)),update(D,j+D.text.slice(O.ch),B);var $=linesFor(1,L.length-1);q>1&&t.remove(S.line+1,q-1),t.insert(S.line+1,$)}signalLater(t,"change",t,r)}function linkedDocs(t,r,a){!function propagate(t,l,S){if(t.linked)for(var O=0;O<t.linked.length;++O){var L=t.linked[O];if(L.doc!=l){var E=S&&L.sharedHist;a&&!E||(r(L.doc,E),propagate(L.doc,t,E))}}}(t,null,!0)}function attachDoc(t,r){if(r.cm)throw new Error("This document is already in use.");t.doc=r,r.cm=t,estimateLineHeights(t),loadMode(t),setDirectionClass(t),t.options.lineWrapping||findMaxLine(t),t.options.mode=r.modeOption,regChange(t)}function setDirectionClass(t){("rtl"==t.doc.direction?addClass:rmClass)(t.display.lineDiv,"CodeMirror-rtl")}function History(t){this.done=[],this.undone=[],this.undoDepth=t?t.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t?t.maxGeneration:1}function historyChangeFromChange(t,r){var a={from:copyPos(r.from),to:changeEnd(r),text:getBetween(t,r.from,r.to)};return attachLocalSpans(t,a,r.from.line,r.to.line+1),linkedDocs(t,(function(t){return attachLocalSpans(t,a,r.from.line,r.to.line+1)}),!0),a}function clearSelectionEvents(t){for(;t.length&&lst(t).ranges;)t.pop()}function addChangeToHistory(t,r,a,l){var S=t.history;S.undone.length=0;var O,L,E=+new Date;if((S.lastOp==l||S.lastOrigin==r.origin&&r.origin&&("+"==r.origin.charAt(0)&&S.lastModTime>E-(t.cm?t.cm.options.historyEventDelay:500)||"*"==r.origin.charAt(0)))&&(O=function lastChangeEvent(t,r){return r?(clearSelectionEvents(t.done),lst(t.done)):t.done.length&&!lst(t.done).ranges?lst(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),lst(t.done)):void 0}(S,S.lastOp==l)))L=lst(O.changes),0==cmp(r.from,r.to)&&0==cmp(r.from,L.to)?L.to=changeEnd(r):O.changes.push(historyChangeFromChange(t,r));else{var D=lst(S.done);for(D&&D.ranges||pushSelectionToHistory(t.sel,S.done),O={changes:[historyChangeFromChange(t,r)],generation:S.generation},S.done.push(O);S.done.length>S.undoDepth;)S.done.shift(),S.done[0].ranges||S.done.shift()}S.done.push(a),S.generation=++S.maxGeneration,S.lastModTime=S.lastSelTime=E,S.lastOp=S.lastSelOp=l,S.lastOrigin=S.lastSelOrigin=r.origin,L||signal(t,"historyAdded")}function addSelectionToHistory(t,r,a,l){var S=t.history,O=l&&l.origin;a==S.lastSelOp||O&&S.lastSelOrigin==O&&(S.lastModTime==S.lastSelTime&&S.lastOrigin==O||function selectionEventCanBeMerged(t,r,a,l){var S=r.charAt(0);return"*"==S||"+"==S&&a.ranges.length==l.ranges.length&&a.somethingSelected()==l.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(t,O,lst(S.done),r))?S.done[S.done.length-1]=r:pushSelectionToHistory(r,S.done),S.lastSelTime=+new Date,S.lastSelOrigin=O,S.lastSelOp=a,l&&!1!==l.clearRedo&&clearSelectionEvents(S.undone)}function pushSelectionToHistory(t,r){var a=lst(r);a&&a.ranges&&a.equals(t)||r.push(t)}function attachLocalSpans(t,r,a,l){var S=r["spans_"+t.id],O=0;t.iter(Math.max(t.first,a),Math.min(t.first+t.size,l),(function(a){a.markedSpans&&((S||(S=r["spans_"+t.id]={}))[O]=a.markedSpans),++O}))}function removeClearedSpans(t){if(!t)return null;for(var r,a=0;a<t.length;++a)t[a].marker.explicitlyCleared?r||(r=t.slice(0,a)):r&&r.push(t[a]);return r?r.length?r:null:t}function mergeOldSpans(t,r){var a=function getOldSpans(t,r){var a=r["spans_"+t.id];if(!a)return null;for(var l=[],S=0;S<r.text.length;++S)l.push(removeClearedSpans(a[S]));return l}(t,r),l=stretchSpansOverChange(t,r);if(!a)return l;if(!l)return a;for(var S=0;S<a.length;++S){var O=a[S],L=l[S];if(O&&L)e:for(var E=0;E<L.length;++E){for(var D=L[E],j=0;j<O.length;++j)if(O[j].marker==D.marker)continue e;O.push(D)}else L&&(a[S]=L)}return a}function copyHistoryArray(t,r,a){for(var l=[],S=0;S<t.length;++S){var O=t[S];if(O.ranges)l.push(a?Selection.prototype.deepCopy.call(O):O);else{var L=O.changes,E=[];l.push({changes:E});for(var D=0;D<L.length;++D){var j=L[D],B=void 0;if(E.push({from:j.from,to:j.to,text:j.text}),r)for(var q in j)(B=q.match(/^spans_(\d+)$/))&&indexOf(r,Number(B[1]))>-1&&(lst(E)[q]=j[q],delete j[q])}}}return l}function extendRange(t,r,a,l){if(l){var S=t.anchor;if(a){var O=cmp(r,S)<0;O!=cmp(a,S)<0?(S=r,r=a):O!=cmp(r,a)<0&&(r=a)}return new Range(S,r)}return new Range(a||r,r)}function extendSelection(t,r,a,l,S){null==S&&(S=t.cm&&(t.cm.display.shift||t.extend)),setSelection(t,new Selection([extendRange(t.sel.primary(),r,a,S)],0),l)}function extendSelections(t,r,a){for(var l=[],S=t.cm&&(t.cm.display.shift||t.extend),O=0;O<t.sel.ranges.length;O++)l[O]=extendRange(t.sel.ranges[O],r[O],null,S);setSelection(t,normalizeSelection(t.cm,l,t.sel.primIndex),a)}function replaceOneSelection(t,r,a,l){var S=t.sel.ranges.slice(0);S[r]=a,setSelection(t,normalizeSelection(t.cm,S,t.sel.primIndex),l)}function setSimpleSelection(t,r,a,l){setSelection(t,simpleSelection(r,a),l)}function setSelectionReplaceHistory(t,r,a){var l=t.history.done,S=lst(l);S&&S.ranges?(l[l.length-1]=r,setSelectionNoUndo(t,r,a)):setSelection(t,r,a)}function setSelection(t,r,a){setSelectionNoUndo(t,r,a),addSelectionToHistory(t,t.sel,t.cm?t.cm.curOp.id:NaN,a)}function setSelectionNoUndo(t,r,a){(hasHandler(t,"beforeSelectionChange")||t.cm&&hasHandler(t.cm,"beforeSelectionChange"))&&(r=function filterSelectionChange(t,r,a){var l={ranges:r.ranges,update:function(r){this.ranges=[];for(var a=0;a<r.length;a++)this.ranges[a]=new Range(clipPos(t,r[a].anchor),clipPos(t,r[a].head))},origin:a&&a.origin};return signal(t,"beforeSelectionChange",t,l),t.cm&&signal(t.cm,"beforeSelectionChange",t.cm,l),l.ranges!=r.ranges?normalizeSelection(t.cm,l.ranges,l.ranges.length-1):r}(t,r,a));var l=a&&a.bias||(cmp(r.primary().head,t.sel.primary().head)<0?-1:1);setSelectionInner(t,skipAtomicInSelection(t,r,l,!0)),a&&!1===a.scroll||!t.cm||"nocursor"==t.cm.getOption("readOnly")||ensureCursorVisible(t.cm)}function setSelectionInner(t,r){r.equals(t.sel)||(t.sel=r,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,signalCursorActivity(t.cm)),signalLater(t,"cursorActivity",t))}function reCheckSelection(t){setSelectionInner(t,skipAtomicInSelection(t,t.sel,null,!1))}function skipAtomicInSelection(t,r,a,l){for(var S,O=0;O<r.ranges.length;O++){var L=r.ranges[O],E=r.ranges.length==t.sel.ranges.length&&t.sel.ranges[O],D=skipAtomic(t,L.anchor,E&&E.anchor,a,l),j=skipAtomic(t,L.head,E&&E.head,a,l);(S||D!=L.anchor||j!=L.head)&&(S||(S=r.ranges.slice(0,O)),S[O]=new Range(D,j))}return S?normalizeSelection(t.cm,S,r.primIndex):r}function skipAtomicInner(t,r,a,l,S){var O=getLine(t,r.line);if(O.markedSpans)for(var L=0;L<O.markedSpans.length;++L){var E=O.markedSpans[L],D=E.marker,j="selectLeft"in D?!D.selectLeft:D.inclusiveLeft,B="selectRight"in D?!D.selectRight:D.inclusiveRight;if((null==E.from||(j?E.from<=r.ch:E.from<r.ch))&&(null==E.to||(B?E.to>=r.ch:E.to>r.ch))){if(S&&(signal(D,"beforeCursorEnter"),D.explicitlyCleared)){if(O.markedSpans){--L;continue}break}if(!D.atomic)continue;if(a){var q=D.find(l<0?1:-1),G=void 0;if((l<0?B:j)&&(q=movePos(t,q,-l,q&&q.line==r.line?O:null)),q&&q.line==r.line&&(G=cmp(q,a))&&(l<0?G<0:G>0))return skipAtomicInner(t,q,r,l,S)}var X=D.find(l<0?-1:1);return(l<0?j:B)&&(X=movePos(t,X,l,X.line==r.line?O:null)),X?skipAtomicInner(t,X,r,l,S):null}}return r}function skipAtomic(t,r,a,l,S){var O=l||1,L=skipAtomicInner(t,r,a,O,S)||!S&&skipAtomicInner(t,r,a,O,!0)||skipAtomicInner(t,r,a,-O,S)||!S&&skipAtomicInner(t,r,a,-O,!0);return L||(t.cantEdit=!0,Pos(t.first,0))}function movePos(t,r,a,l){return a<0&&0==r.ch?r.line>t.first?clipPos(t,Pos(r.line-1)):null:a>0&&r.ch==(l||getLine(t,r.line)).text.length?r.line<t.first+t.size-1?Pos(r.line+1,0):null:new Pos(r.line,r.ch+a)}function selectAll(t){t.setSelection(Pos(t.firstLine(),0),Pos(t.lastLine()),ce)}function filterChange(t,r,a){var l={canceled:!1,from:r.from,to:r.to,text:r.text,origin:r.origin,cancel:function(){return l.canceled=!0}};return a&&(l.update=function(r,a,S,O){r&&(l.from=clipPos(t,r)),a&&(l.to=clipPos(t,a)),S&&(l.text=S),void 0!==O&&(l.origin=O)}),signal(t,"beforeChange",t,l),t.cm&&signal(t.cm,"beforeChange",t.cm,l),l.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:l.from,to:l.to,text:l.text,origin:l.origin}}function makeChange(t,r,a){if(t.cm){if(!t.cm.curOp)return operation(t.cm,makeChange)(t,r,a);if(t.cm.state.suppressEdits)return}if(!(hasHandler(t,"beforeChange")||t.cm&&hasHandler(t.cm,"beforeChange"))||(r=filterChange(t,r,!0))){var l=ke&&!a&&function removeReadOnlyRanges(t,r,a){var l=null;if(t.iter(r.line,a.line+1,(function(t){if(t.markedSpans)for(var r=0;r<t.markedSpans.length;++r){var a=t.markedSpans[r].marker;!a.readOnly||l&&-1!=indexOf(l,a)||(l||(l=[])).push(a)}})),!l)return null;for(var S=[{from:r,to:a}],O=0;O<l.length;++O)for(var L=l[O],E=L.find(0),D=0;D<S.length;++D){var j=S[D];if(!(cmp(j.to,E.from)<0||cmp(j.from,E.to)>0)){var B=[D,1],q=cmp(j.from,E.from),G=cmp(j.to,E.to);(q<0||!L.inclusiveLeft&&!q)&&B.push({from:j.from,to:E.from}),(G>0||!L.inclusiveRight&&!G)&&B.push({from:E.to,to:j.to}),S.splice.apply(S,B),D+=B.length-3}}return S}(t,r.from,r.to);if(l)for(var S=l.length-1;S>=0;--S)makeChangeInner(t,{from:l[S].from,to:l[S].to,text:S?[""]:r.text,origin:r.origin});else makeChangeInner(t,r)}}function makeChangeInner(t,r){if(1!=r.text.length||""!=r.text[0]||0!=cmp(r.from,r.to)){var a=computeSelAfterChange(t,r);addChangeToHistory(t,r,a,t.cm?t.cm.curOp.id:NaN),makeChangeSingleDoc(t,r,a,stretchSpansOverChange(t,r));var l=[];linkedDocs(t,(function(t,a){a||-1!=indexOf(l,t.history)||(rebaseHist(t.history,r),l.push(t.history)),makeChangeSingleDoc(t,r,null,stretchSpansOverChange(t,r))}))}}function makeChangeFromHistory(t,r,a){var l=t.cm&&t.cm.state.suppressEdits;if(!l||a){for(var S,O=t.history,L=t.sel,E="undo"==r?O.done:O.undone,D="undo"==r?O.undone:O.done,j=0;j<E.length&&(S=E[j],a?!S.ranges||S.equals(t.sel):S.ranges);j++);if(j!=E.length){for(O.lastOrigin=O.lastSelOrigin=null;;){if(!(S=E.pop()).ranges){if(l)return void E.push(S);break}if(pushSelectionToHistory(S,D),a&&!S.equals(t.sel))return void setSelection(t,S,{clearRedo:!1});L=S}var B=[];pushSelectionToHistory(L,D),D.push({changes:B,generation:O.generation}),O.generation=S.generation||++O.maxGeneration;for(var q=hasHandler(t,"beforeChange")||t.cm&&hasHandler(t.cm,"beforeChange"),loop=function(a){var l=S.changes[a];if(l.origin=r,q&&!filterChange(t,l,!1))return E.length=0,{};B.push(historyChangeFromChange(t,l));var O=a?computeSelAfterChange(t,l):lst(E);makeChangeSingleDoc(t,l,O,mergeOldSpans(t,l)),!a&&t.cm&&t.cm.scrollIntoView({from:l.from,to:changeEnd(l)});var L=[];linkedDocs(t,(function(t,r){r||-1!=indexOf(L,t.history)||(rebaseHist(t.history,l),L.push(t.history)),makeChangeSingleDoc(t,l,null,mergeOldSpans(t,l))}))},G=S.changes.length-1;G>=0;--G){var X=loop(G);if(X)return X.v}}}}function shiftDoc(t,r){if(0!=r&&(t.first+=r,t.sel=new Selection(map(t.sel.ranges,(function(t){return new Range(Pos(t.anchor.line+r,t.anchor.ch),Pos(t.head.line+r,t.head.ch))})),t.sel.primIndex),t.cm)){regChange(t.cm,t.first,t.first-r,r);for(var a=t.cm.display,l=a.viewFrom;l<a.viewTo;l++)regLineChange(t.cm,l,"gutter")}}function makeChangeSingleDoc(t,r,a,l){if(t.cm&&!t.cm.curOp)return operation(t.cm,makeChangeSingleDoc)(t,r,a,l);if(r.to.line<t.first)shiftDoc(t,r.text.length-1-(r.to.line-r.from.line));else if(!(r.from.line>t.lastLine())){if(r.from.line<t.first){var S=r.text.length-1-(t.first-r.from.line);shiftDoc(t,S),r={from:Pos(t.first,0),to:Pos(r.to.line+S,r.to.ch),text:[lst(r.text)],origin:r.origin}}var O=t.lastLine();r.to.line>O&&(r={from:r.from,to:Pos(O,getLine(t,O).text.length),text:[r.text[0]],origin:r.origin}),r.removed=getBetween(t,r.from,r.to),a||(a=computeSelAfterChange(t,r)),t.cm?function makeChangeSingleDocInEditor(t,r,a){var l=t.doc,S=t.display,O=r.from,L=r.to,E=!1,D=O.line;t.options.lineWrapping||(D=lineNo(visualLine(getLine(l,O.line))),l.iter(D,L.line+1,(function(t){if(t==S.maxLine)return E=!0,!0}))),l.sel.contains(r.from,r.to)>-1&&signalCursorActivity(t),updateDoc(l,r,a,estimateHeight(t)),t.options.lineWrapping||(l.iter(D,O.line+r.text.length,(function(t){var r=lineLength(t);r>S.maxLineLength&&(S.maxLine=t,S.maxLineLength=r,S.maxLineChanged=!0,E=!1)})),E&&(t.curOp.updateMaxLine=!0)),function retreatFrontier(t,r){if(t.modeFrontier=Math.min(t.modeFrontier,r),!(t.highlightFrontier<r-10)){for(var a=t.first,l=r-1;l>a;l--){var S=getLine(t,l).stateAfter;if(S&&(!(S instanceof SavedContext)||l+S.lookAhead<r)){a=l+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,a)}}(l,O.line),startWorker(t,400);var j=r.text.length-(L.line-O.line)-1;r.full?regChange(t):O.line!=L.line||1!=r.text.length||isWholeLineUpdate(t.doc,r)?regChange(t,O.line,L.line+1,j):regLineChange(t,O.line,"text");var B=hasHandler(t,"changes"),q=hasHandler(t,"change");if(q||B){var G={from:O,to:L,text:r.text,removed:r.removed,origin:r.origin};q&&signalLater(t,"change",t,G),B&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(G)}t.display.selForContextMenu=null}(t.cm,r,l):updateDoc(t,r,l),setSelectionNoUndo(t,a,ce),t.cantEdit&&skipAtomic(t,Pos(t.firstLine(),0))&&(t.cantEdit=!1)}}function replaceRange(t,r,a,l,S){var O;l||(l=a),cmp(l,a)<0&&(a=(O=[l,a])[0],l=O[1]),"string"==typeof r&&(r=t.splitLines(r)),makeChange(t,{from:a,to:l,text:r,origin:S})}function rebaseHistSelSingle(t,r,a,l){a<t.line?t.line+=l:r<t.line&&(t.line=r,t.ch=0)}function rebaseHistArray(t,r,a,l){for(var S=0;S<t.length;++S){var O=t[S],L=!0;if(O.ranges){O.copied||((O=t[S]=O.deepCopy()).copied=!0);for(var E=0;E<O.ranges.length;E++)rebaseHistSelSingle(O.ranges[E].anchor,r,a,l),rebaseHistSelSingle(O.ranges[E].head,r,a,l)}else{for(var D=0;D<O.changes.length;++D){var j=O.changes[D];if(a<j.from.line)j.from=Pos(j.from.line+l,j.from.ch),j.to=Pos(j.to.line+l,j.to.ch);else if(r<=j.to.line){L=!1;break}}L||(t.splice(0,S+1),S=0)}}}function rebaseHist(t,r){var a=r.from.line,l=r.to.line,S=r.text.length-(l-a)-1;rebaseHistArray(t.done,a,l,S),rebaseHistArray(t.undone,a,l,S)}function changeLine(t,r,a,l){var S=r,O=r;return"number"==typeof r?O=getLine(t,clipLine(t,r)):S=lineNo(r),null==S?null:(l(O,S)&&t.cm&&regLineChange(t.cm,S,a),O)}function LeafChunk(t){this.lines=t,this.parent=null;for(var r=0,a=0;a<t.length;++a)t[a].parent=this,r+=t[a].height;this.height=r}function BranchChunk(t){this.children=t;for(var r=0,a=0,l=0;l<t.length;++l){var S=t[l];r+=S.chunkSize(),a+=S.height,S.parent=this}this.size=r,this.height=a,this.parent=null}Range.prototype.from=function(){return minPos(this.anchor,this.head)},Range.prototype.to=function(){return maxPos(this.anchor,this.head)},Range.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,r){for(var a=t,l=t+r;a<l;++a){var S=this.lines[a];this.height-=S.height,cleanUpLine(S),signalLater(S,"delete")}this.lines.splice(t,r)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,r,a){this.height+=a,this.lines=this.lines.slice(0,t).concat(r).concat(this.lines.slice(t));for(var l=0;l<r.length;++l)r[l].parent=this},iterN:function(t,r,a){for(var l=t+r;t<l;++t)if(a(this.lines[t]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(t,r){this.size-=r;for(var a=0;a<this.children.length;++a){var l=this.children[a],S=l.chunkSize();if(t<S){var O=Math.min(r,S-t),L=l.height;if(l.removeInner(t,O),this.height-=L-l.height,S==O&&(this.children.splice(a--,1),l.parent=null),0==(r-=O))break;t=0}else t-=S}if(this.size-r<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var E=[];this.collapse(E),this.children=[new LeafChunk(E)],this.children[0].parent=this}},collapse:function(t){for(var r=0;r<this.children.length;++r)this.children[r].collapse(t)},insertInner:function(t,r,a){this.size+=r.length,this.height+=a;for(var l=0;l<this.children.length;++l){var S=this.children[l],O=S.chunkSize();if(t<=O){if(S.insertInner(t,r,a),S.lines&&S.lines.length>50){for(var L=S.lines.length%25+25,E=L;E<S.lines.length;){var D=new LeafChunk(S.lines.slice(E,E+=25));S.height-=D.height,this.children.splice(++l,0,D),D.parent=this}S.lines=S.lines.slice(0,L),this.maybeSpill()}break}t-=O}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var r=new BranchChunk(t.children.splice(t.children.length-5,5));if(t.parent){t.size-=r.size,t.height-=r.height;var a=indexOf(t.parent.children,t);t.parent.children.splice(a+1,0,r)}else{var l=new BranchChunk(t.children);l.parent=t,t.children=[l,r],t=l}r.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,r,a){for(var l=0;l<this.children.length;++l){var S=this.children[l],O=S.chunkSize();if(t<O){var L=Math.min(r,O-t);if(S.iterN(t,L,a))return!0;if(0==(r-=L))break;t=0}else t-=O}}};var LineWidget=function(t,r,a){if(a)for(var l in a)a.hasOwnProperty(l)&&(this[l]=a[l]);this.doc=t,this.node=r};function adjustScrollWhenAboveVisible(t,r,a){heightAtLine(r)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&addToScrollTop(t,a)}LineWidget.prototype.clear=function(){var t=this.doc.cm,r=this.line.widgets,a=this.line,l=lineNo(a);if(null!=l&&r){for(var S=0;S<r.length;++S)r[S]==this&&r.splice(S--,1);r.length||(a.widgets=null);var O=widgetHeight(this);updateLineHeight(a,Math.max(0,a.height-O)),t&&(runInOp(t,(function(){adjustScrollWhenAboveVisible(t,a,-O),regLineChange(t,l,"widget")})),signalLater(t,"lineWidgetCleared",t,this,l))}},LineWidget.prototype.changed=function(){var t=this,r=this.height,a=this.doc.cm,l=this.line;this.height=null;var S=widgetHeight(this)-r;S&&(lineIsHidden(this.doc,l)||updateLineHeight(l,l.height+S),a&&runInOp(a,(function(){a.curOp.forceUpdate=!0,adjustScrollWhenAboveVisible(a,l,S),signalLater(a,"lineWidgetChanged",a,t,lineNo(l))})))},eventMixin(LineWidget);var He=0,TextMarker=function(t,r){this.lines=[],this.type=r,this.doc=t,this.id=++He};function markText(t,r,a,l,S){if(l&&l.shared)return function markTextShared(t,r,a,l,S){(l=copyObj(l)).shared=!1;var O=[markText(t,r,a,l,S)],L=O[0],E=l.widgetNode;return linkedDocs(t,(function(t){E&&(l.widgetNode=E.cloneNode(!0)),O.push(markText(t,clipPos(t,r),clipPos(t,a),l,S));for(var D=0;D<t.linked.length;++D)if(t.linked[D].isParent)return;L=lst(O)})),new SharedTextMarker(O,L)}(t,r,a,l,S);if(t.cm&&!t.cm.curOp)return operation(t.cm,markText)(t,r,a,l,S);var O=new TextMarker(t,S),L=cmp(r,a);if(l&&copyObj(l,O,!1),L>0||0==L&&!1!==O.clearWhenEmpty)return O;if(O.replacedWith&&(O.collapsed=!0,O.widgetNode=eltP("span",[O.replacedWith],"CodeMirror-widget"),l.handleMouseEvents||O.widgetNode.setAttribute("cm-ignore-events","true"),l.insertLeft&&(O.widgetNode.insertLeft=!0)),O.collapsed){if(conflictingCollapsedRange(t,r.line,r,a,O)||r.line!=a.line&&conflictingCollapsedRange(t,a.line,r,a,O))throw new Error("Inserting collapsed marker partially overlapping an existing one");!function seeCollapsedSpans(){Me=!0}()}O.addToHistory&&addChangeToHistory(t,{from:r,to:a,origin:"markText"},t.sel,NaN);var E,D=r.line,j=t.cm;if(t.iter(D,a.line+1,(function(t){j&&O.collapsed&&!j.options.lineWrapping&&visualLine(t)==j.display.maxLine&&(E=!0),O.collapsed&&D!=r.line&&updateLineHeight(t,0),function addMarkedSpan(t,r){t.markedSpans=t.markedSpans?t.markedSpans.concat([r]):[r],r.marker.attachLine(t)}(t,new MarkedSpan(O,D==r.line?r.ch:null,D==a.line?a.ch:null)),++D})),O.collapsed&&t.iter(r.line,a.line+1,(function(r){lineIsHidden(t,r)&&updateLineHeight(r,0)})),O.clearOnEnter&&on(O,"beforeCursorEnter",(function(){return O.clear()})),O.readOnly&&(function seeReadOnlySpans(){ke=!0}(),(t.history.done.length||t.history.undone.length)&&t.clearHistory()),O.collapsed&&(O.id=++He,O.atomic=!0),j){if(E&&(j.curOp.updateMaxLine=!0),O.collapsed)regChange(j,r.line,a.line+1);else if(O.className||O.startStyle||O.endStyle||O.css||O.attributes||O.title)for(var B=r.line;B<=a.line;B++)regLineChange(j,B,"text");O.atomic&&reCheckSelection(j.doc),signalLater(j,"markerAdded",j,O)}return O}TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,r=t&&!t.curOp;if(r&&startOperation(t),hasHandler(this,"clear")){var a=this.find();a&&signalLater(this,"clear",a.from,a.to)}for(var l=null,S=null,O=0;O<this.lines.length;++O){var L=this.lines[O],E=getMarkedSpanFor(L.markedSpans,this);t&&!this.collapsed?regLineChange(t,lineNo(L),"text"):t&&(null!=E.to&&(S=lineNo(L)),null!=E.from&&(l=lineNo(L))),L.markedSpans=removeMarkedSpan(L.markedSpans,E),null==E.from&&this.collapsed&&!lineIsHidden(this.doc,L)&&t&&updateLineHeight(L,textHeight(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var D=0;D<this.lines.length;++D){var j=visualLine(this.lines[D]),B=lineLength(j);B>t.display.maxLineLength&&(t.display.maxLine=j,t.display.maxLineLength=B,t.display.maxLineChanged=!0)}null!=l&&t&&this.collapsed&&regChange(t,l,S+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&reCheckSelection(t.doc)),t&&signalLater(t,"markerCleared",t,this,l,S),r&&endOperation(t),this.parent&&this.parent.clear()}},TextMarker.prototype.find=function(t,r){var a,l;null==t&&"bookmark"==this.type&&(t=1);for(var S=0;S<this.lines.length;++S){var O=this.lines[S],L=getMarkedSpanFor(O.markedSpans,this);if(null!=L.from&&(a=Pos(r?O:lineNo(O),L.from),-1==t))return a;if(null!=L.to&&(l=Pos(r?O:lineNo(O),L.to),1==t))return l}return a&&{from:a,to:l}},TextMarker.prototype.changed=function(){var t=this,r=this.find(-1,!0),a=this,l=this.doc.cm;r&&l&&runInOp(l,(function(){var S=r.line,O=lineNo(r.line),L=findViewForLine(l,O);if(L&&(clearLineMeasurementCacheFor(L),l.curOp.selectionChanged=l.curOp.forceUpdate=!0),l.curOp.updateMaxLine=!0,!lineIsHidden(a.doc,S)&&null!=a.height){var E=a.height;a.height=null;var D=widgetHeight(a)-E;D&&updateLineHeight(S,S.height+D)}signalLater(l,"markerChanged",l,t)}))},TextMarker.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;r.maybeHiddenMarkers&&-1!=indexOf(r.maybeHiddenMarkers,this)||(r.maybeUnhiddenMarkers||(r.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},TextMarker.prototype.detachLine=function(t){if(this.lines.splice(indexOf(this.lines,t),1),!this.lines.length&&this.doc.cm){var r=this.doc.cm.curOp;(r.maybeHiddenMarkers||(r.maybeHiddenMarkers=[])).push(this)}},eventMixin(TextMarker);var SharedTextMarker=function(t,r){this.markers=t,this.primary=r;for(var a=0;a<t.length;++a)t[a].parent=this};function findSharedMarkers(t){return t.findMarks(Pos(t.first,0),t.clipPos(Pos(t.lastLine())),(function(t){return t.parent}))}function detachSharedMarkers(t){for(var loop=function(r){var a=t[r],l=[a.primary.doc];linkedDocs(a.primary.doc,(function(t){return l.push(t)}));for(var S=0;S<a.markers.length;S++){var O=a.markers[S];-1==indexOf(l,O.doc)&&(O.parent=null,a.markers.splice(S--,1))}},r=0;r<t.length;r++)loop(r)}SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(t,r){return this.primary.find(t,r)},eventMixin(SharedTextMarker);var Ve=0,Doc=function(t,r,a,l,S){if(!(this instanceof Doc))return new Doc(t,r,a,l,S);null==a&&(a=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=a,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=a;var O=Pos(a,0);this.sel=simpleSelection(O),this.history=new History(null),this.id=++Ve,this.modeOption=r,this.lineSep=l,this.direction="rtl"==S?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),updateDoc(this,{from:O,to:O,text:t}),setSelection(this,simpleSelection(O),ce)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(t,r,a){a?this.iterN(t-this.first,r-t,a):this.iterN(this.first,this.first+this.size,t)},insert:function(t,r){for(var a=0,l=0;l<r.length;++l)a+=r[l].height;this.insertInner(t-this.first,r,a)},remove:function(t,r){this.removeInner(t-this.first,r)},getValue:function(t){var r=getLines(this,this.first,this.first+this.size);return!1===t?r:r.join(t||this.lineSeparator())},setValue:docMethodOp((function(t){var r=Pos(this.first,0),a=this.first+this.size-1;makeChange(this,{from:r,to:Pos(a,getLine(this,a).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&scrollToCoords(this.cm,0,0),setSelection(this,simpleSelection(r),ce)})),replaceRange:function(t,r,a,l){replaceRange(this,t,r=clipPos(this,r),a=a?clipPos(this,a):r,l)},getRange:function(t,r,a){var l=getBetween(this,clipPos(this,t),clipPos(this,r));return!1===a?l:l.join(a||this.lineSeparator())},getLine:function(t){var r=this.getLineHandle(t);return r&&r.text},getLineHandle:function(t){if(isLine(this,t))return getLine(this,t)},getLineNumber:function(t){return lineNo(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=getLine(this,t)),visualLine(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return clipPos(this,t)},getCursor:function(t){var r=this.sel.primary();return null==t||"head"==t?r.head:"anchor"==t?r.anchor:"end"==t||"to"==t||!1===t?r.to():r.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp((function(t,r,a){setSimpleSelection(this,clipPos(this,"number"==typeof t?Pos(t,r||0):t),null,a)})),setSelection:docMethodOp((function(t,r,a){setSimpleSelection(this,clipPos(this,t),clipPos(this,r||t),a)})),extendSelection:docMethodOp((function(t,r,a){extendSelection(this,clipPos(this,t),r&&clipPos(this,r),a)})),extendSelections:docMethodOp((function(t,r){extendSelections(this,clipPosArray(this,t),r)})),extendSelectionsBy:docMethodOp((function(t,r){extendSelections(this,clipPosArray(this,map(this.sel.ranges,t)),r)})),setSelections:docMethodOp((function(t,r,a){if(t.length){for(var l=[],S=0;S<t.length;S++)l[S]=new Range(clipPos(this,t[S].anchor),clipPos(this,t[S].head||t[S].anchor));null==r&&(r=Math.min(t.length-1,this.sel.primIndex)),setSelection(this,normalizeSelection(this.cm,l,r),a)}})),addSelection:docMethodOp((function(t,r,a){var l=this.sel.ranges.slice(0);l.push(new Range(clipPos(this,t),clipPos(this,r||t))),setSelection(this,normalizeSelection(this.cm,l,l.length-1),a)})),getSelection:function(t){for(var r,a=this.sel.ranges,l=0;l<a.length;l++){var S=getBetween(this,a[l].from(),a[l].to());r=r?r.concat(S):S}return!1===t?r:r.join(t||this.lineSeparator())},getSelections:function(t){for(var r=[],a=this.sel.ranges,l=0;l<a.length;l++){var S=getBetween(this,a[l].from(),a[l].to());!1!==t&&(S=S.join(t||this.lineSeparator())),r[l]=S}return r},replaceSelection:function(t,r,a){for(var l=[],S=0;S<this.sel.ranges.length;S++)l[S]=t;this.replaceSelections(l,r,a||"+input")},replaceSelections:docMethodOp((function(t,r,a){for(var l=[],S=this.sel,O=0;O<S.ranges.length;O++){var L=S.ranges[O];l[O]={from:L.from(),to:L.to(),text:this.splitLines(t[O]),origin:a}}for(var E=r&&"end"!=r&&function computeReplacedSel(t,r,a){for(var l=[],S=Pos(t.first,0),O=S,L=0;L<r.length;L++){var E=r[L],D=offsetPos(E.from,S,O),j=offsetPos(changeEnd(E),S,O);if(S=E.to,O=j,"around"==a){var B=t.sel.ranges[L],q=cmp(B.head,B.anchor)<0;l[L]=new Range(q?j:D,q?D:j)}else l[L]=new Range(D,D)}return new Selection(l,t.sel.primIndex)}(this,l,r),D=l.length-1;D>=0;D--)makeChange(this,l[D]);E?setSelectionReplaceHistory(this,E):this.cm&&ensureCursorVisible(this.cm)})),undo:docMethodOp((function(){makeChangeFromHistory(this,"undo")})),redo:docMethodOp((function(){makeChangeFromHistory(this,"redo")})),undoSelection:docMethodOp((function(){makeChangeFromHistory(this,"undo",!0)})),redoSelection:docMethodOp((function(){makeChangeFromHistory(this,"redo",!0)})),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,r=0,a=0,l=0;l<t.done.length;l++)t.done[l].ranges||++r;for(var S=0;S<t.undone.length;S++)t.undone[S].ranges||++a;return{undo:r,redo:a}},clearHistory:function(){var t=this;this.history=new History(this.history),linkedDocs(this,(function(r){return r.history=t.history}),!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(t){var r=this.history=new History(this.history);r.done=copyHistoryArray(t.done.slice(0),null,!0),r.undone=copyHistoryArray(t.undone.slice(0),null,!0)},setGutterMarker:docMethodOp((function(t,r,a){return changeLine(this,t,"gutter",(function(t){var l=t.gutterMarkers||(t.gutterMarkers={});return l[r]=a,!a&&isEmpty(l)&&(t.gutterMarkers=null),!0}))})),clearGutter:docMethodOp((function(t){var r=this;this.iter((function(a){a.gutterMarkers&&a.gutterMarkers[t]&&changeLine(r,a,"gutter",(function(){return a.gutterMarkers[t]=null,isEmpty(a.gutterMarkers)&&(a.gutterMarkers=null),!0}))}))})),lineInfo:function(t){var r;if("number"==typeof t){if(!isLine(this,t))return null;if(r=t,!(t=getLine(this,t)))return null}else if(null==(r=lineNo(t)))return null;return{line:r,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:docMethodOp((function(t,r,a){return changeLine(this,t,"gutter"==r?"gutter":"class",(function(t){var l="text"==r?"textClass":"background"==r?"bgClass":"gutter"==r?"gutterClass":"wrapClass";if(t[l]){if(classTest(a).test(t[l]))return!1;t[l]+=" "+a}else t[l]=a;return!0}))})),removeLineClass:docMethodOp((function(t,r,a){return changeLine(this,t,"gutter"==r?"gutter":"class",(function(t){var l="text"==r?"textClass":"background"==r?"bgClass":"gutter"==r?"gutterClass":"wrapClass",S=t[l];if(!S)return!1;if(null==a)t[l]=null;else{var O=S.match(classTest(a));if(!O)return!1;var L=O.index+O[0].length;t[l]=S.slice(0,O.index)+(O.index&&L!=S.length?" ":"")+S.slice(L)||null}return!0}))})),addLineWidget:docMethodOp((function(t,r,a){return function addLineWidget(t,r,a,l){var S=new LineWidget(t,a,l),O=t.cm;return O&&S.noHScroll&&(O.display.alignWidgets=!0),changeLine(t,r,"widget",(function(r){var a=r.widgets||(r.widgets=[]);if(null==S.insertAt?a.push(S):a.splice(Math.min(a.length,Math.max(0,S.insertAt)),0,S),S.line=r,O&&!lineIsHidden(t,r)){var l=heightAtLine(r)<t.scrollTop;updateLineHeight(r,r.height+widgetHeight(S)),l&&addToScrollTop(O,S.height),O.curOp.forceUpdate=!0}return!0})),O&&signalLater(O,"lineWidgetAdded",O,S,"number"==typeof r?r:lineNo(r)),S}(this,t,r,a)})),removeLineWidget:function(t){t.clear()},markText:function(t,r,a){return markText(this,clipPos(this,t),clipPos(this,r),a,a&&a.type||"range")},setBookmark:function(t,r){var a={replacedWith:r&&(null==r.nodeType?r.widget:r),insertLeft:r&&r.insertLeft,clearWhenEmpty:!1,shared:r&&r.shared,handleMouseEvents:r&&r.handleMouseEvents};return markText(this,t=clipPos(this,t),t,a,"bookmark")},findMarksAt:function(t){var r=[],a=getLine(this,(t=clipPos(this,t)).line).markedSpans;if(a)for(var l=0;l<a.length;++l){var S=a[l];(null==S.from||S.from<=t.ch)&&(null==S.to||S.to>=t.ch)&&r.push(S.marker.parent||S.marker)}return r},findMarks:function(t,r,a){t=clipPos(this,t),r=clipPos(this,r);var l=[],S=t.line;return this.iter(t.line,r.line+1,(function(O){var L=O.markedSpans;if(L)for(var E=0;E<L.length;E++){var D=L[E];null!=D.to&&S==t.line&&t.ch>=D.to||null==D.from&&S!=t.line||null!=D.from&&S==r.line&&D.from>=r.ch||a&&!a(D.marker)||l.push(D.marker.parent||D.marker)}++S})),l},getAllMarks:function(){var t=[];return this.iter((function(r){var a=r.markedSpans;if(a)for(var l=0;l<a.length;++l)null!=a[l].from&&t.push(a[l].marker)})),t},posFromIndex:function(t){var r,a=this.first,l=this.lineSeparator().length;return this.iter((function(S){var O=S.text.length+l;if(O>t)return r=t,!0;t-=O,++a})),clipPos(this,Pos(a,r))},indexFromPos:function(t){var r=(t=clipPos(this,t)).ch;if(t.line<this.first||t.ch<0)return 0;var a=this.lineSeparator().length;return this.iter(this.first,t.line,(function(t){r+=t.text.length+a})),r},copy:function(t){var r=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return r.scrollTop=this.scrollTop,r.scrollLeft=this.scrollLeft,r.sel=this.sel,r.extend=!1,t&&(r.history.undoDepth=this.history.undoDepth,r.setHistory(this.getHistory())),r},linkedDoc:function(t){t||(t={});var r=this.first,a=this.first+this.size;null!=t.from&&t.from>r&&(r=t.from),null!=t.to&&t.to<a&&(a=t.to);var l=new Doc(getLines(this,r,a),t.mode||this.modeOption,r,this.lineSep,this.direction);return t.sharedHist&&(l.history=this.history),(this.linked||(this.linked=[])).push({doc:l,sharedHist:t.sharedHist}),l.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],function copySharedMarkers(t,r){for(var a=0;a<r.length;a++){var l=r[a],S=l.find(),O=t.clipPos(S.from),L=t.clipPos(S.to);if(cmp(O,L)){var E=markText(t,O,L,l.primary,l.primary.type);l.markers.push(E),E.parent=l}}}(l,findSharedMarkers(this)),l},unlinkDoc:function(t){if(t instanceof CodeMirror&&(t=t.doc),this.linked)for(var r=0;r<this.linked.length;++r)if(this.linked[r].doc==t){this.linked.splice(r,1),t.unlinkDoc(this),detachSharedMarkers(findSharedMarkers(this));break}if(t.history==this.history){var a=[t.id];linkedDocs(t,(function(t){return a.push(t.id)}),!0),t.history=new History(null),t.history.done=copyHistoryArray(this.history.done,a),t.history.undone=copyHistoryArray(this.history.undone,a)}},iterLinkedDocs:function(t){linkedDocs(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):xe(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:docMethodOp((function(t){"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter((function(t){return t.order=null})),this.cm&&function directionChanged(t){runInOp(t,(function(){setDirectionClass(t),regChange(t)}))}(this.cm))}))}),Doc.prototype.eachLine=Doc.prototype.iter;var Be=0;function onDrop(t){var r=this;if(clearDragCursor(r),!signalDOMEvent(r,t)&&!eventInWidget(r.display,t)){e_preventDefault(t),L&&(Be=+new Date);var a=posFromMouse(r,t,!0),l=t.dataTransfer.files;if(a&&!r.isReadOnly())if(l&&l.length&&window.FileReader&&window.File)for(var S=l.length,O=Array(S),E=0,markAsReadAndPasteIfAllFilesAreRead=function(){++E==S&&operation(r,(function(){var t={from:a=clipPos(r.doc,a),to:a,text:r.doc.splitLines(O.filter((function(t){return null!=t})).join(r.doc.lineSeparator())),origin:"paste"};makeChange(r.doc,t),setSelectionReplaceHistory(r.doc,simpleSelection(clipPos(r.doc,a),clipPos(r.doc,changeEnd(t))))}))()},readTextFromFile=function(t,a){if(r.options.allowDropFileTypes&&-1==indexOf(r.options.allowDropFileTypes,t.type))markAsReadAndPasteIfAllFilesAreRead();else{var l=new FileReader;l.onerror=function(){return markAsReadAndPasteIfAllFilesAreRead()},l.onload=function(){var t=l.result;/[\x00-\x08\x0e-\x1f]{2}/.test(t)||(O[a]=t),markAsReadAndPasteIfAllFilesAreRead()},l.readAsText(t)}},D=0;D<l.length;D++)readTextFromFile(l[D],D);else{if(r.state.draggingText&&r.doc.sel.contains(a)>-1)return r.state.draggingText(t),void setTimeout((function(){return r.display.input.focus()}),20);try{var j=t.dataTransfer.getData("Text");if(j){var B;if(r.state.draggingText&&!r.state.draggingText.copy&&(B=r.listSelections()),setSelectionNoUndo(r.doc,simpleSelection(a,a)),B)for(var q=0;q<B.length;++q)replaceRange(r.doc,"",B[q].anchor,B[q].head,"drag");r.replaceSelection(j,"around","paste"),r.display.input.focus()}}catch(t){}}}}function clearDragCursor(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function forEachCodeMirror(t){if(document.getElementsByClassName){for(var r=document.getElementsByClassName("CodeMirror"),a=[],l=0;l<r.length;l++){var S=r[l].CodeMirror;S&&a.push(S)}a.length&&a[0].operation((function(){for(var r=0;r<a.length;r++)t(a[r])}))}}var Ue=!1;function ensureGlobalHandlers(){Ue||(function registerGlobalHandlers(){var t;on(window,"resize",(function(){null==t&&(t=setTimeout((function(){t=null,forEachCodeMirror(onResize)}),100))})),on(window,"blur",(function(){return forEachCodeMirror(onBlur)}))}(),Ue=!0)}function onResize(t){var r=t.display;r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.scrollbarsClipped=!1,t.setSize()}for(var qe={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Ge=0;Ge<10;Ge++)qe[Ge+48]=qe[Ge+96]=String(Ge);for(var Ke=65;Ke<=90;Ke++)qe[Ke]=String.fromCharCode(Ke);for(var Xe=1;Xe<=12;Xe++)qe[Xe+111]=qe[Xe+63235]="F"+Xe;var $e={};function normalizeKeyName(t){var r,a,l,S,O=t.split(/-(?!$)/);t=O[O.length-1];for(var L=0;L<O.length-1;L++){var E=O[L];if(/^(cmd|meta|m)$/i.test(E))S=!0;else if(/^a(lt)?$/i.test(E))r=!0;else if(/^(c|ctrl|control)$/i.test(E))a=!0;else{if(!/^s(hift)?$/i.test(E))throw new Error("Unrecognized modifier name: "+E);l=!0}}return r&&(t="Alt-"+t),a&&(t="Ctrl-"+t),S&&(t="Cmd-"+t),l&&(t="Shift-"+t),t}function normalizeKeyMap(t){var r={};for(var a in t)if(t.hasOwnProperty(a)){var l=t[a];if(/^(name|fallthrough|(de|at)tach)$/.test(a))continue;if("..."==l){delete t[a];continue}for(var S=map(a.split(" "),normalizeKeyName),O=0;O<S.length;O++){var L=void 0,E=void 0;O==S.length-1?(E=S.join(" "),L=l):(E=S.slice(0,O+1).join(" "),L="...");var D=r[E];if(D){if(D!=L)throw new Error("Inconsistent bindings for "+E)}else r[E]=L}delete t[a]}for(var j in r)t[j]=r[j];return t}function lookupKey(t,r,a,l){var S=(r=getKeyMap(r)).call?r.call(t,l):r[t];if(!1===S)return"nothing";if("..."===S)return"multi";if(null!=S&&a(S))return"handled";if(r.fallthrough){if("[object Array]"!=Object.prototype.toString.call(r.fallthrough))return lookupKey(t,r.fallthrough,a,l);for(var O=0;O<r.fallthrough.length;O++){var L=lookupKey(t,r.fallthrough[O],a,l);if(L)return L}}}function isModifierKey(t){var r="string"==typeof t?t:qe[t.keyCode];return"Ctrl"==r||"Alt"==r||"Shift"==r||"Mod"==r}function addModifierNames(t,r,a){var l=t;return r.altKey&&"Alt"!=l&&(t="Alt-"+t),(ie?r.metaKey:r.ctrlKey)&&"Ctrl"!=l&&(t="Ctrl-"+t),(ie?r.ctrlKey:r.metaKey)&&"Mod"!=l&&(t="Cmd-"+t),!a&&r.shiftKey&&"Shift"!=l&&(t="Shift-"+t),t}function keyName(t,r){if(q&&34==t.keyCode&&t.char)return!1;var a=qe[t.keyCode];return null!=a&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(a=t.code),addModifierNames(a,t,r))}function getKeyMap(t){return"string"==typeof t?$e[t]:t}function deleteNearSelection(t,r){for(var a=t.doc.sel.ranges,l=[],S=0;S<a.length;S++){for(var O=r(a[S]);l.length&&cmp(O.from,lst(l).to)<=0;){var L=l.pop();if(cmp(L.from,O.from)<0){O.from=L.from;break}}l.push(O)}runInOp(t,(function(){for(var r=l.length-1;r>=0;r--)replaceRange(t.doc,"",l[r].from,l[r].to,"+delete");ensureCursorVisible(t)}))}function moveCharLogically(t,r,a){var l=skipExtendingChars(t.text,r+a,a);return l<0||l>t.text.length?null:l}function moveLogically(t,r,a){var l=moveCharLogically(t,r.ch,a);return null==l?null:new Pos(r.line,l,a<0?"after":"before")}function endOfLine(t,r,a,l,S){if(t){"rtl"==r.doc.direction&&(S=-S);var O=getOrder(a,r.doc.direction);if(O){var L,E=S<0?lst(O):O[0],D=S<0==(1==E.level)?"after":"before";if(E.level>0||"rtl"==r.doc.direction){var j=prepareMeasureForLine(r,a);L=S<0?a.text.length-1:0;var B=measureCharPrepared(r,j,L).top;L=findFirst((function(t){return measureCharPrepared(r,j,t).top==B}),S<0==(1==E.level)?E.from:E.to-1,L),"before"==D&&(L=moveCharLogically(a,L,1))}else L=S<0?E.to:E.from;return new Pos(l,L,D)}}return new Pos(l,S<0?a.text.length:0,S<0?"before":"after")}$e.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},$e.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},$e.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},$e.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},$e.default=te?$e.macDefault:$e.pcDefault;var Ye={selectAll:selectAll,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),ce)},killLine:function(t){return deleteNearSelection(t,(function(r){if(r.empty()){var a=getLine(t.doc,r.head.line).text.length;return r.head.ch==a&&r.head.line<t.lastLine()?{from:r.head,to:Pos(r.head.line+1,0)}:{from:r.head,to:Pos(r.head.line,a)}}return{from:r.from(),to:r.to()}}))},deleteLine:function(t){return deleteNearSelection(t,(function(r){return{from:Pos(r.from().line,0),to:clipPos(t.doc,Pos(r.to().line+1,0))}}))},delLineLeft:function(t){return deleteNearSelection(t,(function(t){return{from:Pos(t.from().line,0),to:t.from()}}))},delWrappedLineLeft:function(t){return deleteNearSelection(t,(function(r){var a=t.charCoords(r.head,"div").top+5;return{from:t.coordsChar({left:0,top:a},"div"),to:r.from()}}))},delWrappedLineRight:function(t){return deleteNearSelection(t,(function(r){var a=t.charCoords(r.head,"div").top+5,l=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:a},"div");return{from:r.from(),to:l}}))},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(Pos(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(Pos(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy((function(r){return lineStart(t,r.head.line)}),{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy((function(r){return lineStartSmart(t,r.head)}),{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy((function(r){return function lineEnd(t,r){var a=getLine(t.doc,r),l=function visualLineEnd(t){for(var r;r=collapsedSpanAtEnd(t);)t=r.find(1,!0).line;return t}(a);return l!=a&&(r=lineNo(l)),endOfLine(!0,t,a,r,-1)}(t,r.head.line)}),{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy((function(r){var a=t.cursorCoords(r.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:a},"div")}),pe)},goLineLeft:function(t){return t.extendSelectionsBy((function(r){var a=t.cursorCoords(r.head,"div").top+5;return t.coordsChar({left:0,top:a},"div")}),pe)},goLineLeftSmart:function(t){return t.extendSelectionsBy((function(r){var a=t.cursorCoords(r.head,"div").top+5,l=t.coordsChar({left:0,top:a},"div");return l.ch<t.getLine(l.line).search(/\S/)?lineStartSmart(t,r.head):l}),pe)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"codepoint")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var r=[],a=t.listSelections(),l=t.options.tabSize,S=0;S<a.length;S++){var O=a[S].from(),L=countColumn(t.getLine(O.line),O.ch,l);r.push(spaceStr(l-L%l))}t.replaceSelections(r)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return runInOp(t,(function(){for(var r=t.listSelections(),a=[],l=0;l<r.length;l++)if(r[l].empty()){var S=r[l].head,O=getLine(t.doc,S.line).text;if(O)if(S.ch==O.length&&(S=new Pos(S.line,S.ch-1)),S.ch>0)S=new Pos(S.line,S.ch+1),t.replaceRange(O.charAt(S.ch-1)+O.charAt(S.ch-2),Pos(S.line,S.ch-2),S,"+transpose");else if(S.line>t.doc.first){var L=getLine(t.doc,S.line-1).text;L&&(S=new Pos(S.line,1),t.replaceRange(O.charAt(0)+t.doc.lineSeparator()+L.charAt(L.length-1),Pos(S.line-1,L.length-1),S,"+transpose"))}a.push(new Range(S,S))}t.setSelections(a)}))},newlineAndIndent:function(t){return runInOp(t,(function(){for(var r=t.listSelections(),a=r.length-1;a>=0;a--)t.replaceRange(t.doc.lineSeparator(),r[a].anchor,r[a].head,"+input");r=t.listSelections();for(var l=0;l<r.length;l++)t.indentLine(r[l].from().line,null,!0);ensureCursorVisible(t)}))},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function lineStart(t,r){var a=getLine(t.doc,r),l=visualLine(a);return l!=a&&(r=lineNo(l)),endOfLine(!0,t,l,r,1)}function lineStartSmart(t,r){var a=lineStart(t,r.line),l=getLine(t.doc,a.line),S=getOrder(l,t.doc.direction);if(!S||0==S[0].level){var O=Math.max(a.ch,l.text.search(/\S/)),L=r.line==a.line&&r.ch<=O&&r.ch;return Pos(a.line,L?0:O,a.sticky)}return a}function doHandleBinding(t,r,a){if("string"==typeof r&&!(r=Ye[r]))return!1;t.display.input.ensurePolled();var l=t.display.shift,S=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),a&&(t.display.shift=!1),S=r(t)!=le}finally{t.display.shift=l,t.state.suppressEdits=!1}return S}var Ze=new Delayed;function dispatchKey(t,r,a,l){var S=t.state.keySeq;if(S){if(isModifierKey(r))return"handled";if(/\'$/.test(r)?t.state.keySeq=null:Ze.set(50,(function(){t.state.keySeq==S&&(t.state.keySeq=null,t.display.input.reset())})),dispatchKeyInner(t,S+" "+r,a,l))return!0}return dispatchKeyInner(t,r,a,l)}function dispatchKeyInner(t,r,a,l){var S=function lookupKeyForEditor(t,r,a){for(var l=0;l<t.state.keyMaps.length;l++){var S=lookupKey(r,t.state.keyMaps[l],a,t);if(S)return S}return t.options.extraKeys&&lookupKey(r,t.options.extraKeys,a,t)||lookupKey(r,t.options.keyMap,a,t)}(t,r,l);return"multi"==S&&(t.state.keySeq=r),"handled"==S&&signalLater(t,"keyHandled",t,r,a),"handled"!=S&&"multi"!=S||(e_preventDefault(a),restartBlink(t)),!!S}function handleKeyBinding(t,r){var a=keyName(r,!0);return!!a&&(r.shiftKey&&!t.state.keySeq?dispatchKey(t,"Shift-"+a,r,(function(r){return doHandleBinding(t,r,!0)}))||dispatchKey(t,a,r,(function(r){if("string"==typeof r?/^go[A-Z]/.test(r):r.motion)return doHandleBinding(t,r)})):dispatchKey(t,a,r,(function(r){return doHandleBinding(t,r)})))}var Qe=null;function onKeyDown(t){var r=this;if(!(t.target&&t.target!=r.display.input.getField()||(r.curOp.focus=activeElt(),signalDOMEvent(r,t)))){L&&E<11&&27==t.keyCode&&(t.returnValue=!1);var l=t.keyCode;r.display.shift=16==l||t.shiftKey;var S=handleKeyBinding(r,t);q&&(Qe=S?l:null,!S&&88==l&&!Se&&(te?t.metaKey:t.ctrlKey)&&r.replaceSelection("",null,"cut")),a&&!te&&!S&&46==l&&t.shiftKey&&!t.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=l||/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)||function showCrossHair(t){var r=t.display.lineDiv;function up(t){18!=t.keyCode&&t.altKey||(rmClass(r,"CodeMirror-crosshair"),off(document,"keyup",up),off(document,"mouseover",up))}addClass(r,"CodeMirror-crosshair"),on(document,"keyup",up),on(document,"mouseover",up)}(r)}}function onKeyUp(t){16==t.keyCode&&(this.doc.sel.shift=!1),signalDOMEvent(this,t)}function onKeyPress(t){var r=this;if(!(t.target&&t.target!=r.display.input.getField()||eventInWidget(r.display,t)||signalDOMEvent(r,t)||t.ctrlKey&&!t.altKey||te&&t.metaKey)){var a=t.keyCode,l=t.charCode;if(q&&a==Qe)return Qe=null,void e_preventDefault(t);if(!q||t.which&&!(t.which<10)||!handleKeyBinding(r,t)){var S=String.fromCharCode(null==l?a:l);"\b"!=S&&(function handleCharBinding(t,r,a){return dispatchKey(t,"'"+a+"'",r,(function(r){return doHandleBinding(t,r,!0)}))}(r,t,S)||r.display.input.onKeyPress(t))}}}var Je,et,PastClick=function(t,r,a){this.time=t,this.pos=r,this.button=a};function onMouseDown(t){var r=this,a=r.display;if(!(signalDOMEvent(r,t)||a.activeTouch&&a.input.supportsTouch()))if(a.input.ensurePolled(),a.shift=t.shiftKey,eventInWidget(a,t))D||(a.scroller.draggable=!1,setTimeout((function(){return a.scroller.draggable=!0}),100));else if(!clickInGutter(r,t)){var l=posFromMouse(r,t),S=e_button(t),O=l?function clickRepeat(t,r){var a=+new Date;return et&&et.compare(a,t,r)?(Je=et=null,"triple"):Je&&Je.compare(a,t,r)?(et=new PastClick(a,t,r),Je=null,"double"):(Je=new PastClick(a,t,r),et=null,"single")}(l,S):"single";window.focus(),1==S&&r.state.selectingText&&r.state.selectingText(t),l&&function handleMappedButton(t,r,a,l,S){var O="Click";return"double"==l?O="Double"+O:"triple"==l&&(O="Triple"+O),dispatchKey(t,addModifierNames(O=(1==r?"Left":2==r?"Middle":"Right")+O,S),S,(function(r){if("string"==typeof r&&(r=Ye[r]),!r)return!1;var l=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),l=r(t,a)!=le}finally{t.state.suppressEdits=!1}return l}))}(r,S,l,O,t)||(1==S?l?function leftButtonDown(t,r,a,l){L?setTimeout(bind(ensureFocus,t),0):t.curOp.focus=activeElt();var S,O=function configureMouse(t,r,a){var l=t.getOption("configureMouse"),S=l?l(t,r,a):{};if(null==S.unit){var O=ne?a.shiftKey&&a.metaKey:a.altKey;S.unit=O?"rectangle":"single"==r?"char":"double"==r?"word":"line"}return(null==S.extend||t.doc.extend)&&(S.extend=t.doc.extend||a.shiftKey),null==S.addNew&&(S.addNew=te?a.metaKey:a.ctrlKey),null==S.moveOnDrag&&(S.moveOnDrag=!(te?a.altKey:a.ctrlKey)),S}(t,a,l),j=t.doc.sel;t.options.dragDrop&&_e&&!t.isReadOnly()&&"single"==a&&(S=j.contains(r))>-1&&(cmp((S=j.ranges[S]).from(),r)<0||r.xRel>0)&&(cmp(S.to(),r)>0||r.xRel<0)?function leftButtonStartDrag(t,r,a,l){var S=t.display,O=!1,j=operation(t,(function(r){D&&(S.scroller.draggable=!1),t.state.draggingText=!1,t.state.delayingBlurEvent&&(t.hasFocus()?t.state.delayingBlurEvent=!1:delayBlurEvent(t)),off(S.wrapper.ownerDocument,"mouseup",j),off(S.wrapper.ownerDocument,"mousemove",mouseMove),off(S.scroller,"dragstart",dragStart),off(S.scroller,"drop",j),O||(e_preventDefault(r),l.addNew||extendSelection(t.doc,a,null,null,l.extend),D&&!G||L&&9==E?setTimeout((function(){S.wrapper.ownerDocument.body.focus({preventScroll:!0}),S.input.focus()}),20):S.input.focus())})),mouseMove=function(t){O=O||Math.abs(r.clientX-t.clientX)+Math.abs(r.clientY-t.clientY)>=10},dragStart=function(){return O=!0};D&&(S.scroller.draggable=!0),t.state.draggingText=j,j.copy=!l.moveOnDrag,on(S.wrapper.ownerDocument,"mouseup",j),on(S.wrapper.ownerDocument,"mousemove",mouseMove),on(S.scroller,"dragstart",dragStart),on(S.scroller,"drop",j),t.state.delayingBlurEvent=!0,setTimeout((function(){return S.input.focus()}),20),S.scroller.dragDrop&&S.scroller.dragDrop()}(t,l,r,O):function leftButtonSelect(t,r,a,l){L&&delayBlurEvent(t);var S=t.display,O=t.doc;e_preventDefault(r);var E,D,j=O.sel,B=j.ranges;if(l.addNew&&!l.extend?(D=O.sel.contains(a),E=D>-1?B[D]:new Range(a,a)):(E=O.sel.primary(),D=O.sel.primIndex),"rectangle"==l.unit)l.addNew||(E=new Range(a,a)),a=posFromMouse(t,r,!0,!0),D=-1;else{var q=rangeForUnit(t,a,l.unit);E=l.extend?extendRange(E,q.anchor,q.head,l.extend):q}l.addNew?-1==D?(D=B.length,setSelection(O,normalizeSelection(t,B.concat([E]),D),{scroll:!1,origin:"*mouse"})):B.length>1&&B[D].empty()&&"char"==l.unit&&!l.extend?(setSelection(O,normalizeSelection(t,B.slice(0,D).concat(B.slice(D+1)),0),{scroll:!1,origin:"*mouse"}),j=O.sel):replaceOneSelection(O,D,E,ue):(D=0,setSelection(O,new Selection([E],0),ue),j=O.sel);var G=a;function extendTo(r){if(0!=cmp(G,r))if(G=r,"rectangle"==l.unit){for(var S=[],L=t.options.tabSize,B=countColumn(getLine(O,a.line).text,a.ch,L),q=countColumn(getLine(O,r.line).text,r.ch,L),X=Math.min(B,q),$=Math.max(B,q),Z=Math.min(a.line,r.line),Q=Math.min(t.lastLine(),Math.max(a.line,r.line));Z<=Q;Z++){var ee=getLine(O,Z).text,te=findColumn(ee,X,L);X==$?S.push(new Range(Pos(Z,te),Pos(Z,te))):ee.length>te&&S.push(new Range(Pos(Z,te),Pos(Z,findColumn(ee,$,L))))}S.length||S.push(new Range(a,a)),setSelection(O,normalizeSelection(t,j.ranges.slice(0,D).concat(S),D),{origin:"*mouse",scroll:!1}),t.scrollIntoView(r)}else{var ne,re=E,oe=rangeForUnit(t,r,l.unit),ie=re.anchor;cmp(oe.anchor,ie)>0?(ne=oe.head,ie=minPos(re.from(),oe.anchor)):(ne=oe.anchor,ie=maxPos(re.to(),oe.head));var ae=j.ranges.slice(0);ae[D]=function bidiSimplify(t,r){var a=r.anchor,l=r.head,S=getLine(t.doc,a.line);if(0==cmp(a,l)&&a.sticky==l.sticky)return r;var O=getOrder(S);if(!O)return r;var L=getBidiPartAt(O,a.ch,a.sticky),E=O[L];if(E.from!=a.ch&&E.to!=a.ch)return r;var D,j=L+(E.from==a.ch==(1!=E.level)?0:1);if(0==j||j==O.length)return r;if(l.line!=a.line)D=(l.line-a.line)*("ltr"==t.doc.direction?1:-1)>0;else{var B=getBidiPartAt(O,l.ch,l.sticky),q=B-L||(l.ch-a.ch)*(1==E.level?-1:1);D=B==j-1||B==j?q<0:q>0}var G=O[j+(D?-1:0)],X=D==(1==G.level),$=X?G.from:G.to,Z=X?"after":"before";return a.ch==$&&a.sticky==Z?r:new Range(new Pos(a.line,$,Z),l)}(t,new Range(clipPos(O,ie),ne)),setSelection(O,normalizeSelection(t,ae,D),ue)}}var X=S.wrapper.getBoundingClientRect(),$=0;function done(r){t.state.selectingText=!1,$=1/0,r&&(e_preventDefault(r),S.input.focus()),off(S.wrapper.ownerDocument,"mousemove",Z),off(S.wrapper.ownerDocument,"mouseup",Q),O.history.lastSelOrigin=null}var Z=operation(t,(function(r){0!==r.buttons&&e_button(r)?function extend(r){var a=++$,L=posFromMouse(t,r,!0,"rectangle"==l.unit);if(L)if(0!=cmp(L,G)){t.curOp.focus=activeElt(),extendTo(L);var E=visibleLines(S,O);(L.line>=E.to||L.line<E.from)&&setTimeout(operation(t,(function(){$==a&&extend(r)})),150)}else{var D=r.clientY<X.top?-20:r.clientY>X.bottom?20:0;D&&setTimeout(operation(t,(function(){$==a&&(S.scroller.scrollTop+=D,extend(r))})),50)}}(r):done(r)})),Q=operation(t,done);t.state.selectingText=Q,on(S.wrapper.ownerDocument,"mousemove",Z),on(S.wrapper.ownerDocument,"mouseup",Q)}(t,l,r,O)}(r,l,O,t):e_target(t)==a.scroller&&e_preventDefault(t):2==S?(l&&extendSelection(r.doc,l),setTimeout((function(){return a.input.focus()}),20)):3==S&&(ae?r.display.input.onContextMenu(t):delayBlurEvent(r)))}}function rangeForUnit(t,r,a){if("char"==a)return new Range(r,r);if("word"==a)return t.findWordAt(r);if("line"==a)return new Range(Pos(r.line,0),clipPos(t.doc,Pos(r.line+1,0)));var l=a(t,r);return new Range(l.from,l.to)}function gutterEvent(t,r,a,l){var S,O;if(r.touches)S=r.touches[0].clientX,O=r.touches[0].clientY;else try{S=r.clientX,O=r.clientY}catch(t){return!1}if(S>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;l&&e_preventDefault(r);var L=t.display,E=L.lineDiv.getBoundingClientRect();if(O>E.bottom||!hasHandler(t,a))return e_defaultPrevented(r);O-=E.top-L.viewOffset;for(var D=0;D<t.display.gutterSpecs.length;++D){var j=L.gutters.childNodes[D];if(j&&j.getBoundingClientRect().right>=S)return signal(t,a,t,lineAtHeight(t.doc,O),t.display.gutterSpecs[D].className,r),e_defaultPrevented(r)}}function clickInGutter(t,r){return gutterEvent(t,r,"gutterClick",!0)}function onContextMenu(t,r){eventInWidget(t.display,r)||function contextMenuInGutter(t,r){return!!hasHandler(t,"gutterContextMenu")&&gutterEvent(t,r,"gutterContextMenu",!1)}(t,r)||signalDOMEvent(t,r,"contextmenu")||ae||t.display.input.onContextMenu(r)}function themeChanged(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(t)}PastClick.prototype.compare=function(t,r,a){return this.time+400>t&&0==cmp(r,this.pos)&&a==this.button};var tt={toString:function(){return"CodeMirror.Init"}},nt={},rt={};function dragDropChanged(t,r,a){if(!r!=!(a&&a!=tt)){var l=t.display.dragFunctions,S=r?on:off;S(t.display.scroller,"dragstart",l.start),S(t.display.scroller,"dragenter",l.enter),S(t.display.scroller,"dragover",l.over),S(t.display.scroller,"dragleave",l.leave),S(t.display.scroller,"drop",l.drop)}}function wrappingChanged(t){t.options.lineWrapping?(addClass(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(rmClass(t.display.wrapper,"CodeMirror-wrap"),findMaxLine(t)),estimateLineHeights(t),regChange(t),clearCaches(t),setTimeout((function(){return updateScrollbars(t)}),100)}function CodeMirror(t,r){var a=this;if(!(this instanceof CodeMirror))return new CodeMirror(t,r);this.options=r=r?copyObj(r):{},copyObj(nt,r,!1);var l=r.value;"string"==typeof l?l=new Doc(l,r.mode,null,r.lineSeparator,r.direction):r.mode&&(l.modeOption=r.mode),this.doc=l;var S=new CodeMirror.inputStyles[r.inputStyle](this),O=this.display=new Display(t,l,S,r);for(var j in O.wrapper.CodeMirror=this,themeChanged(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Delayed,keySeq:null,specialChars:null},r.autofocus&&!ee&&O.input.focus(),L&&E<11&&setTimeout((function(){return a.display.input.reset(!0)}),20),function registerEventHandlers(t){var r=t.display;on(r.scroller,"mousedown",operation(t,onMouseDown)),on(r.scroller,"dblclick",L&&E<11?operation(t,(function(r){if(!signalDOMEvent(t,r)){var a=posFromMouse(t,r);if(a&&!clickInGutter(t,r)&&!eventInWidget(t.display,r)){e_preventDefault(r);var l=t.findWordAt(a);extendSelection(t.doc,l.anchor,l.head)}}})):function(r){return signalDOMEvent(t,r)||e_preventDefault(r)}),on(r.scroller,"contextmenu",(function(r){return onContextMenu(t,r)})),on(r.input.getField(),"contextmenu",(function(a){r.scroller.contains(a.target)||onContextMenu(t,a)}));var a,l={end:0};function finishTouch(){r.activeTouch&&(a=setTimeout((function(){return r.activeTouch=null}),1e3),(l=r.activeTouch).end=+new Date)}function farAway(t,r){if(null==r.left)return!0;var a=r.left-t.left,l=r.top-t.top;return a*a+l*l>400}on(r.scroller,"touchstart",(function(S){if(!signalDOMEvent(t,S)&&!function isMouseLikeTouchEvent(t){if(1!=t.touches.length)return!1;var r=t.touches[0];return r.radiusX<=1&&r.radiusY<=1}(S)&&!clickInGutter(t,S)){r.input.ensurePolled(),clearTimeout(a);var O=+new Date;r.activeTouch={start:O,moved:!1,prev:O-l.end<=300?l:null},1==S.touches.length&&(r.activeTouch.left=S.touches[0].pageX,r.activeTouch.top=S.touches[0].pageY)}})),on(r.scroller,"touchmove",(function(){r.activeTouch&&(r.activeTouch.moved=!0)})),on(r.scroller,"touchend",(function(a){var l=r.activeTouch;if(l&&!eventInWidget(r,a)&&null!=l.left&&!l.moved&&new Date-l.start<300){var S,O=t.coordsChar(r.activeTouch,"page");S=!l.prev||farAway(l,l.prev)?new Range(O,O):!l.prev.prev||farAway(l,l.prev.prev)?t.findWordAt(O):new Range(Pos(O.line,0),clipPos(t.doc,Pos(O.line+1,0))),t.setSelection(S.anchor,S.head),t.focus(),e_preventDefault(a)}finishTouch()})),on(r.scroller,"touchcancel",finishTouch),on(r.scroller,"scroll",(function(){r.scroller.clientHeight&&(updateScrollTop(t,r.scroller.scrollTop),setScrollLeft(t,r.scroller.scrollLeft,!0),signal(t,"scroll",t))})),on(r.scroller,"mousewheel",(function(r){return onScrollWheel(t,r)})),on(r.scroller,"DOMMouseScroll",(function(r){return onScrollWheel(t,r)})),on(r.wrapper,"scroll",(function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0})),r.dragFunctions={enter:function(r){signalDOMEvent(t,r)||e_stop(r)},over:function(r){signalDOMEvent(t,r)||(function onDragOver(t,r){var a=posFromMouse(t,r);if(a){var l=document.createDocumentFragment();drawSelectionCursor(t,a,l),t.display.dragCursor||(t.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),removeChildrenAndAdd(t.display.dragCursor,l)}}(t,r),e_stop(r))},start:function(r){return function onDragStart(t,r){if(L&&(!t.state.draggingText||+new Date-Be<100))e_stop(r);else if(!signalDOMEvent(t,r)&&!eventInWidget(t.display,r)&&(r.dataTransfer.setData("Text",t.getSelection()),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage&&!G)){var a=elt("img",null,null,"position: fixed; left: 0; top: 0;");a.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",q&&(a.width=a.height=1,t.display.wrapper.appendChild(a),a._top=a.offsetTop),r.dataTransfer.setDragImage(a,0,0),q&&a.parentNode.removeChild(a)}}(t,r)},drop:operation(t,onDrop),leave:function(r){signalDOMEvent(t,r)||clearDragCursor(t)}};var S=r.input.getField();on(S,"keyup",(function(r){return onKeyUp.call(t,r)})),on(S,"keydown",operation(t,onKeyDown)),on(S,"keypress",operation(t,onKeyPress)),on(S,"focus",(function(r){return onFocus(t,r)})),on(S,"blur",(function(r){return onBlur(t,r)}))}(this),ensureGlobalHandlers(),startOperation(this),this.curOp.forceUpdate=!0,attachDoc(this,l),r.autofocus&&!ee||this.hasFocus()?setTimeout((function(){a.hasFocus()&&!a.state.focused&&onFocus(a)}),20):onBlur(this),rt)rt.hasOwnProperty(j)&&rt[j](this,r[j],tt);maybeUpdateLineNumberWidth(this),r.finishInit&&r.finishInit(this);for(var B=0;B<ot.length;++B)ot[B](this);endOperation(this),D&&r.lineWrapping&&"optimizelegibility"==getComputedStyle(O.lineDiv).textRendering&&(O.lineDiv.style.textRendering="auto")}CodeMirror.defaults=nt,CodeMirror.optionHandlers=rt;var ot=[];function indentLine(t,r,a,l){var S,O=t.doc;null==a&&(a="add"),"smart"==a&&(O.mode.indent?S=getContextBefore(t,r).state:a="prev");var L=t.options.tabSize,E=getLine(O,r),D=countColumn(E.text,null,L);E.stateAfter&&(E.stateAfter=null);var j,B=E.text.match(/^\s*/)[0];if(l||/\S/.test(E.text)){if("smart"==a&&((j=O.mode.indent(S,E.text.slice(B.length),E.text))==le||j>150)){if(!l)return;a="prev"}}else j=0,a="not";"prev"==a?j=r>O.first?countColumn(getLine(O,r-1).text,null,L):0:"add"==a?j=D+t.options.indentUnit:"subtract"==a?j=D-t.options.indentUnit:"number"==typeof a&&(j=D+a),j=Math.max(0,j);var q="",G=0;if(t.options.indentWithTabs)for(var X=Math.floor(j/L);X;--X)G+=L,q+="\t";if(G<j&&(q+=spaceStr(j-G)),q!=B)return replaceRange(O,q,Pos(r,0),Pos(r,B.length),"+input"),E.stateAfter=null,!0;for(var $=0;$<O.sel.ranges.length;$++){var Z=O.sel.ranges[$];if(Z.head.line==r&&Z.head.ch<B.length){var Q=Pos(r,B.length);replaceOneSelection(O,$,new Range(Q,Q));break}}}CodeMirror.defineInitHook=function(t){return ot.push(t)};var it=null;function setLastCopied(t){it=t}function applyTextInput(t,r,a,l,S){var O=t.doc;t.display.shift=!1,l||(l=O.sel);var L=+new Date-200,E="paste"==S||t.state.pasteIncoming>L,D=xe(r),j=null;if(E&&l.ranges.length>1)if(it&&it.text.join("\n")==r){if(l.ranges.length%it.text.length==0){j=[];for(var B=0;B<it.text.length;B++)j.push(O.splitLines(it.text[B]))}}else D.length==l.ranges.length&&t.options.pasteLinesPerSelection&&(j=map(D,(function(t){return[t]})));for(var q=t.curOp.updateInput,G=l.ranges.length-1;G>=0;G--){var X=l.ranges[G],$=X.from(),Z=X.to();X.empty()&&(a&&a>0?$=Pos($.line,$.ch-a):t.state.overwrite&&!E?Z=Pos(Z.line,Math.min(getLine(O,Z.line).text.length,Z.ch+lst(D).length)):E&&it&&it.lineWise&&it.text.join("\n")==D.join("\n")&&($=Z=Pos($.line,0)));var Q={from:$,to:Z,text:j?j[G%j.length]:D,origin:S||(E?"paste":t.state.cutIncoming>L?"cut":"+input")};makeChange(t.doc,Q),signalLater(t,"inputRead",t,Q)}r&&!E&&triggerElectric(t,r),ensureCursorVisible(t),t.curOp.updateInput<2&&(t.curOp.updateInput=q),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function handlePaste(t,r){var a=t.clipboardData&&t.clipboardData.getData("Text");if(a)return t.preventDefault(),r.isReadOnly()||r.options.disableInput||runInOp(r,(function(){return applyTextInput(r,a,0,null,"paste")})),!0}function triggerElectric(t,r){if(t.options.electricChars&&t.options.smartIndent)for(var a=t.doc.sel,l=a.ranges.length-1;l>=0;l--){var S=a.ranges[l];if(!(S.head.ch>100||l&&a.ranges[l-1].head.line==S.head.line)){var O=t.getModeAt(S.head),L=!1;if(O.electricChars){for(var E=0;E<O.electricChars.length;E++)if(r.indexOf(O.electricChars.charAt(E))>-1){L=indentLine(t,S.head.line,"smart");break}}else O.electricInput&&O.electricInput.test(getLine(t.doc,S.head.line).text.slice(0,S.head.ch))&&(L=indentLine(t,S.head.line,"smart"));L&&signalLater(t,"electricInput",t,S.head.line)}}}function copyableRanges(t){for(var r=[],a=[],l=0;l<t.doc.sel.ranges.length;l++){var S=t.doc.sel.ranges[l].head.line,O={anchor:Pos(S,0),head:Pos(S+1,0)};a.push(O),r.push(t.getRange(O.anchor,O.head))}return{text:r,ranges:a}}function disableBrowserMagic(t,r,a,l){t.setAttribute("autocorrect",a?"":"off"),t.setAttribute("autocapitalize",l?"":"off"),t.setAttribute("spellcheck",!!r)}function hiddenTextarea(){var t=elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),r=elt("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return D?t.style.width="1000px":t.setAttribute("wrap","off"),Z&&(t.style.border="1px solid black"),disableBrowserMagic(t),r}function findPosH(t,r,a,l,S){var O=r,L=a,E=getLine(t,r.line),D=S&&"rtl"==t.direction?-a:a;function moveOnce(O){var L;if("codepoint"==l){var j=E.text.charCodeAt(r.ch+(a>0?0:-1));if(isNaN(j))L=null;else{var B=a>0?j>=55296&&j<56320:j>=56320&&j<57343;L=new Pos(r.line,Math.max(0,Math.min(E.text.length,r.ch+a*(B?2:1))),-a)}}else L=S?function moveVisually(t,r,a,l){var S=getOrder(r,t.doc.direction);if(!S)return moveLogically(r,a,l);a.ch>=r.text.length?(a.ch=r.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var O=getBidiPartAt(S,a.ch,a.sticky),L=S[O];if("ltr"==t.doc.direction&&L.level%2==0&&(l>0?L.to>a.ch:L.from<a.ch))return moveLogically(r,a,l);var E,mv=function(t,a){return moveCharLogically(r,t instanceof Pos?t.ch:t,a)},getWrappedLineExtent=function(a){return t.options.lineWrapping?(E=E||prepareMeasureForLine(t,r),wrappedLineExtentChar(t,r,E,a)):{begin:0,end:r.text.length}},D=getWrappedLineExtent("before"==a.sticky?mv(a,-1):a.ch);if("rtl"==t.doc.direction||1==L.level){var j=1==L.level==l<0,B=mv(a,j?1:-1);if(null!=B&&(j?B<=L.to&&B<=D.end:B>=L.from&&B>=D.begin)){var q=j?"before":"after";return new Pos(a.line,B,q)}}var searchInVisualLine=function(t,r,l){for(var getRes=function(t,r){return r?new Pos(a.line,mv(t,1),"before"):new Pos(a.line,t,"after")};t>=0&&t<S.length;t+=r){var O=S[t],L=r>0==(1!=O.level),E=L?l.begin:mv(l.end,-1);if(O.from<=E&&E<O.to)return getRes(E,L);if(E=L?O.from:mv(O.to,-1),l.begin<=E&&E<l.end)return getRes(E,L)}},G=searchInVisualLine(O+l,l,D);if(G)return G;var X=l>0?D.end:mv(D.begin,-1);return null==X||l>0&&X==r.text.length||!(G=searchInVisualLine(l>0?0:S.length-1,l,getWrappedLineExtent(X)))?null:G}(t.cm,E,r,a):moveLogically(E,r,a);if(null==L){if(O||!function findNextLine(){var a=r.line+D;return!(a<t.first||a>=t.first+t.size)&&(r=new Pos(a,r.ch,r.sticky),E=getLine(t,a))}())return!1;r=endOfLine(S,t.cm,E,r.line,D)}else r=L;return!0}if("char"==l||"codepoint"==l)moveOnce();else if("column"==l)moveOnce(!0);else if("word"==l||"group"==l)for(var j=null,B="group"==l,q=t.cm&&t.cm.getHelper(r,"wordChars"),G=!0;!(a<0)||moveOnce(!G);G=!1){var X=E.text.charAt(r.ch)||"\n",$=isWordChar(X,q)?"w":B&&"\n"==X?"n":!B||/\s/.test(X)?null:"p";if(!B||G||$||($="s"),j&&j!=$){a<0&&(a=1,moveOnce(),r.sticky="after");break}if($&&(j=$),a>0&&!moveOnce(!G))break}var Z=skipAtomic(t,r,O,L,!0);return equalCursorPos(O,Z)&&(Z.hitSide=!0),Z}function findPosV(t,r,a,l){var S,O,L=t.doc,E=r.left;if("page"==l){var D=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),j=Math.max(D-.5*textHeight(t.display),3);S=(a>0?r.bottom:r.top)+a*j}else"line"==l&&(S=a>0?r.bottom+3:r.top-3);for(;(O=coordsChar(t,E,S)).outside;){if(a<0?S<=0:S>=L.height){O.hitSide=!0;break}S+=5*a}return O}var ContentEditableInput=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Delayed,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function posToDOM(t,r){var a=findViewForLine(t,r.line);if(!a||a.hidden)return null;var l=getLine(t.doc,r.line),S=mapFromLineView(a,l,r.line),O=getOrder(l,t.doc.direction),L="left";O&&(L=getBidiPartAt(O,r.ch)%2?"right":"left");var E=nodeAndOffsetInLineMap(S.map,r.ch,L);return E.offset="right"==E.collapse?E.end:E.start,E}function badPos(t,r){return r&&(t.bad=!0),t}function domToPos(t,r,a){var l;if(r==t.display.lineDiv){if(!(l=t.display.lineDiv.childNodes[a]))return badPos(t.clipPos(Pos(t.display.viewTo-1)),!0);r=null,a=0}else for(l=r;;l=l.parentNode){if(!l||l==t.display.lineDiv)return null;if(l.parentNode&&l.parentNode==t.display.lineDiv)break}for(var S=0;S<t.display.view.length;S++){var O=t.display.view[S];if(O.node==l)return locateNodeInLineView(O,r,a)}}function locateNodeInLineView(t,r,a){var l=t.text.firstChild,S=!1;if(!r||!contains(l,r))return badPos(Pos(lineNo(t.line),0),!0);if(r==l&&(S=!0,r=l.childNodes[a],a=0,!r)){var O=t.rest?lst(t.rest):t.line;return badPos(Pos(lineNo(O),O.text.length),S)}var L=3==r.nodeType?r:null,E=r;for(L||1!=r.childNodes.length||3!=r.firstChild.nodeType||(L=r.firstChild,a&&(a=L.nodeValue.length));E.parentNode!=l;)E=E.parentNode;var D=t.measure,j=D.maps;function find(r,a,l){for(var S=-1;S<(j?j.length:0);S++)for(var O=S<0?D.map:j[S],L=0;L<O.length;L+=3){var E=O[L+2];if(E==r||E==a){var B=lineNo(S<0?t.line:t.rest[S]),q=O[L]+l;return(l<0||E!=r)&&(q=O[L+(l?1:0)]),Pos(B,q)}}}var B=find(L,E,a);if(B)return badPos(B,S);for(var q=E.nextSibling,G=L?L.nodeValue.length-a:0;q;q=q.nextSibling){if(B=find(q,q.firstChild,0))return badPos(Pos(B.line,B.ch-G),S);G+=q.textContent.length}for(var X=E.previousSibling,$=a;X;X=X.previousSibling){if(B=find(X,X.firstChild,-1))return badPos(Pos(B.line,B.ch+$),S);$+=X.textContent.length}}ContentEditableInput.prototype.init=function(t){var r=this,a=this,l=a.cm,S=a.div=t.lineDiv;function belongsToInput(t){for(var r=t.target;r;r=r.parentNode){if(r==S)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(r.className))break}return!1}function onCopyCut(t){if(belongsToInput(t)&&!signalDOMEvent(l,t)){if(l.somethingSelected())setLastCopied({lineWise:!1,text:l.getSelections()}),"cut"==t.type&&l.replaceSelection("",null,"cut");else{if(!l.options.lineWiseCopyCut)return;var r=copyableRanges(l);setLastCopied({lineWise:!0,text:r.text}),"cut"==t.type&&l.operation((function(){l.setSelections(r.ranges,0,ce),l.replaceSelection("",null,"cut")}))}if(t.clipboardData){t.clipboardData.clearData();var O=it.text.join("\n");if(t.clipboardData.setData("Text",O),t.clipboardData.getData("Text")==O)return void t.preventDefault()}var L=hiddenTextarea(),E=L.firstChild;l.display.lineSpace.insertBefore(L,l.display.lineSpace.firstChild),E.value=it.text.join("\n");var D=activeElt();selectInput(E),setTimeout((function(){l.display.lineSpace.removeChild(L),D.focus(),D==S&&a.showPrimarySelection()}),50)}}S.contentEditable=!0,disableBrowserMagic(S,l.options.spellcheck,l.options.autocorrect,l.options.autocapitalize),on(S,"paste",(function(t){!belongsToInput(t)||signalDOMEvent(l,t)||handlePaste(t,l)||E<=11&&setTimeout(operation(l,(function(){return r.updateFromDOM()})),20)})),on(S,"compositionstart",(function(t){r.composing={data:t.data,done:!1}})),on(S,"compositionupdate",(function(t){r.composing||(r.composing={data:t.data,done:!1})})),on(S,"compositionend",(function(t){r.composing&&(t.data!=r.composing.data&&r.readFromDOMSoon(),r.composing.done=!0)})),on(S,"touchstart",(function(){return a.forceCompositionEnd()})),on(S,"input",(function(){r.composing||r.readFromDOMSoon()})),on(S,"copy",onCopyCut),on(S,"cut",onCopyCut)},ContentEditableInput.prototype.screenReaderLabelChanged=function(t){t?this.div.setAttribute("aria-label",t):this.div.removeAttribute("aria-label")},ContentEditableInput.prototype.prepareSelection=function(){var t=prepareSelection(this.cm,!1);return t.focus=activeElt()==this.div,t},ContentEditableInput.prototype.showSelection=function(t,r){t&&this.cm.display.view.length&&((t.focus||r)&&this.showPrimarySelection(),this.showMultipleSelections(t))},ContentEditableInput.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},ContentEditableInput.prototype.showPrimarySelection=function(){var t=this.getSelection(),r=this.cm,l=r.doc.sel.primary(),S=l.from(),O=l.to();if(r.display.viewTo==r.display.viewFrom||S.line>=r.display.viewTo||O.line<r.display.viewFrom)t.removeAllRanges();else{var L=domToPos(r,t.anchorNode,t.anchorOffset),E=domToPos(r,t.focusNode,t.focusOffset);if(!L||L.bad||!E||E.bad||0!=cmp(minPos(L,E),S)||0!=cmp(maxPos(L,E),O)){var D=r.display.view,j=S.line>=r.display.viewFrom&&posToDOM(r,S)||{node:D[0].measure.map[2],offset:0},B=O.line<r.display.viewTo&&posToDOM(r,O);if(!B){var q=D[D.length-1].measure,G=q.maps?q.maps[q.maps.length-1]:q.map;B={node:G[G.length-1],offset:G[G.length-2]-G[G.length-3]}}if(j&&B){var X,$=t.rangeCount&&t.getRangeAt(0);try{X=se(j.node,j.offset,B.offset,B.node)}catch(t){}X&&(!a&&r.state.focused?(t.collapse(j.node,j.offset),X.collapsed||(t.removeAllRanges(),t.addRange(X))):(t.removeAllRanges(),t.addRange(X)),$&&null==t.anchorNode?t.addRange($):a&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}}},ContentEditableInput.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout((function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation((function(){return t.cm.curOp.selectionChanged=!0}))}),20)},ContentEditableInput.prototype.showMultipleSelections=function(t){removeChildrenAndAdd(this.cm.display.cursorDiv,t.cursors),removeChildrenAndAdd(this.cm.display.selectionDiv,t.selection)},ContentEditableInput.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},ContentEditableInput.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var r=t.getRangeAt(0).commonAncestorContainer;return contains(this.div,r)},ContentEditableInput.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&activeElt()==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},ContentEditableInput.prototype.blur=function(){this.div.blur()},ContentEditableInput.prototype.getField=function(){return this.div},ContentEditableInput.prototype.supportsTouch=function(){return!0},ContentEditableInput.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():runInOp(this.cm,(function(){return t.cm.curOp.selectionChanged=!0})),this.polling.set(this.cm.options.pollInterval,(function poll(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,poll))}))},ContentEditableInput.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},ContentEditableInput.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=this.getSelection(),r=this.cm;if(Q&&B&&this.cm.display.gutterSpecs.length&&function isInGutter(t){for(var r=t;r;r=r.parentNode)if(/CodeMirror-gutter-wrapper/.test(r.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var a=domToPos(r,t.anchorNode,t.anchorOffset),l=domToPos(r,t.focusNode,t.focusOffset);a&&l&&runInOp(r,(function(){setSelection(r.doc,simpleSelection(a,l),ce),(a.bad||l.bad)&&(r.curOp.selectionChanged=!0)}))}}},ContentEditableInput.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t,r,a,l=this.cm,S=l.display,O=l.doc.sel.primary(),L=O.from(),E=O.to();if(0==L.ch&&L.line>l.firstLine()&&(L=Pos(L.line-1,getLine(l.doc,L.line-1).length)),E.ch==getLine(l.doc,E.line).text.length&&E.line<l.lastLine()&&(E=Pos(E.line+1,0)),L.line<S.viewFrom||E.line>S.viewTo-1)return!1;L.line==S.viewFrom||0==(t=findViewIndex(l,L.line))?(r=lineNo(S.view[0].line),a=S.view[0].node):(r=lineNo(S.view[t].line),a=S.view[t-1].node.nextSibling);var D,j,B=findViewIndex(l,E.line);if(B==S.view.length-1?(D=S.viewTo-1,j=S.lineDiv.lastChild):(D=lineNo(S.view[B+1].line)-1,j=S.view[B+1].node.previousSibling),!a)return!1;for(var q=l.doc.splitLines(function domTextBetween(t,r,a,l,S){var O="",L=!1,E=t.doc.lineSeparator(),D=!1;function close(){L&&(O+=E,D&&(O+=E),L=D=!1)}function addText(t){t&&(close(),O+=t)}function walk(r){if(1==r.nodeType){var a=r.getAttribute("cm-text");if(a)return void addText(a);var O,j=r.getAttribute("cm-marker");if(j){var B=t.findMarks(Pos(l,0),Pos(S+1,0),function recognizeMarker(t){return function(r){return r.id==t}}(+j));return void(B.length&&(O=B[0].find(0))&&addText(getBetween(t.doc,O.from,O.to).join(E)))}if("false"==r.getAttribute("contenteditable"))return;var q=/^(pre|div|p|li|table|br)$/i.test(r.nodeName);if(!/^br$/i.test(r.nodeName)&&0==r.textContent.length)return;q&&close();for(var G=0;G<r.childNodes.length;G++)walk(r.childNodes[G]);/^(pre|p)$/i.test(r.nodeName)&&(D=!0),q&&(L=!0)}else 3==r.nodeType&&addText(r.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;walk(r),r!=a;)r=r.nextSibling,D=!1;return O}(l,a,j,r,D)),G=getBetween(l.doc,Pos(r,0),Pos(D,getLine(l.doc,D).text.length));q.length>1&&G.length>1;)if(lst(q)==lst(G))q.pop(),G.pop(),D--;else{if(q[0]!=G[0])break;q.shift(),G.shift(),r++}for(var X=0,$=0,Z=q[0],Q=G[0],ee=Math.min(Z.length,Q.length);X<ee&&Z.charCodeAt(X)==Q.charCodeAt(X);)++X;for(var te=lst(q),ne=lst(G),re=Math.min(te.length-(1==q.length?X:0),ne.length-(1==G.length?X:0));$<re&&te.charCodeAt(te.length-$-1)==ne.charCodeAt(ne.length-$-1);)++$;if(1==q.length&&1==G.length&&r==L.line)for(;X&&X>L.ch&&te.charCodeAt(te.length-$-1)==ne.charCodeAt(ne.length-$-1);)X--,$++;q[q.length-1]=te.slice(0,te.length-$).replace(/^\u200b+/,""),q[0]=q[0].slice(X).replace(/\u200b+$/,"");var oe=Pos(r,X),ie=Pos(D,G.length?lst(G).length-$:0);return q.length>1||q[0]||cmp(oe,ie)?(replaceRange(l.doc,q,oe,ie,"+input"),!0):void 0},ContentEditableInput.prototype.ensurePolled=function(){this.forceCompositionEnd()},ContentEditableInput.prototype.reset=function(){this.forceCompositionEnd()},ContentEditableInput.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},ContentEditableInput.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout((function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()}),80))},ContentEditableInput.prototype.updateFromDOM=function(){var t=this;!this.cm.isReadOnly()&&this.pollContent()||runInOp(this.cm,(function(){return regChange(t.cm)}))},ContentEditableInput.prototype.setUneditable=function(t){t.contentEditable="false"},ContentEditableInput.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},ContentEditableInput.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},ContentEditableInput.prototype.onContextMenu=function(){},ContentEditableInput.prototype.resetPosition=function(){},ContentEditableInput.prototype.needsContentAttribute=!0;var TextareaInput=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new Delayed,this.hasSelection=!1,this.composing=null};TextareaInput.prototype.init=function(t){var r=this,a=this,l=this.cm;this.createField(t);var S=this.textarea;function prepareCopyCut(t){if(!signalDOMEvent(l,t)){if(l.somethingSelected())setLastCopied({lineWise:!1,text:l.getSelections()});else{if(!l.options.lineWiseCopyCut)return;var r=copyableRanges(l);setLastCopied({lineWise:!0,text:r.text}),"cut"==t.type?l.setSelections(r.ranges,null,ce):(a.prevInput="",S.value=r.text.join("\n"),selectInput(S))}"cut"==t.type&&(l.state.cutIncoming=+new Date)}}t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),Z&&(S.style.width="0px"),on(S,"input",(function(){L&&E>=9&&r.hasSelection&&(r.hasSelection=null),a.poll()})),on(S,"paste",(function(t){signalDOMEvent(l,t)||handlePaste(t,l)||(l.state.pasteIncoming=+new Date,a.fastPoll())})),on(S,"cut",prepareCopyCut),on(S,"copy",prepareCopyCut),on(t.scroller,"paste",(function(r){if(!eventInWidget(t,r)&&!signalDOMEvent(l,r)){if(!S.dispatchEvent)return l.state.pasteIncoming=+new Date,void a.focus();var O=new Event("paste");O.clipboardData=r.clipboardData,S.dispatchEvent(O)}})),on(t.lineSpace,"selectstart",(function(r){eventInWidget(t,r)||e_preventDefault(r)})),on(S,"compositionstart",(function(){var t=l.getCursor("from");a.composing&&a.composing.range.clear(),a.composing={start:t,range:l.markText(t,l.getCursor("to"),{className:"CodeMirror-composing"})}})),on(S,"compositionend",(function(){a.composing&&(a.poll(),a.composing.range.clear(),a.composing=null)}))},TextareaInput.prototype.createField=function(t){this.wrapper=hiddenTextarea(),this.textarea=this.wrapper.firstChild},TextareaInput.prototype.screenReaderLabelChanged=function(t){t?this.textarea.setAttribute("aria-label",t):this.textarea.removeAttribute("aria-label")},TextareaInput.prototype.prepareSelection=function(){var t=this.cm,r=t.display,a=t.doc,l=prepareSelection(t);if(t.options.moveInputWithCursor){var S=cursorCoords(t,a.sel.primary().head,"div"),O=r.wrapper.getBoundingClientRect(),L=r.lineDiv.getBoundingClientRect();l.teTop=Math.max(0,Math.min(r.wrapper.clientHeight-10,S.top+L.top-O.top)),l.teLeft=Math.max(0,Math.min(r.wrapper.clientWidth-10,S.left+L.left-O.left))}return l},TextareaInput.prototype.showSelection=function(t){var r=this.cm.display;removeChildrenAndAdd(r.cursorDiv,t.cursors),removeChildrenAndAdd(r.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},TextareaInput.prototype.reset=function(t){if(!this.contextMenuPending&&!this.composing){var r=this.cm;if(r.somethingSelected()){this.prevInput="";var a=r.getSelection();this.textarea.value=a,r.state.focused&&selectInput(this.textarea),L&&E>=9&&(this.hasSelection=a)}else t||(this.prevInput=this.textarea.value="",L&&E>=9&&(this.hasSelection=null))}},TextareaInput.prototype.getField=function(){return this.textarea},TextareaInput.prototype.supportsTouch=function(){return!1},TextareaInput.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!ee||activeElt()!=this.textarea))try{this.textarea.focus()}catch(t){}},TextareaInput.prototype.blur=function(){this.textarea.blur()},TextareaInput.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},TextareaInput.prototype.receivedFocus=function(){this.slowPoll()},TextareaInput.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,(function(){t.poll(),t.cm.state.focused&&t.slowPoll()}))},TextareaInput.prototype.fastPoll=function(){var t=!1,r=this;r.pollingFast=!0,r.polling.set(20,(function p(){r.poll()||t?(r.pollingFast=!1,r.slowPoll()):(t=!0,r.polling.set(60,p))}))},TextareaInput.prototype.poll=function(){var t=this,r=this.cm,a=this.textarea,l=this.prevInput;if(this.contextMenuPending||!r.state.focused||Ce(a)&&!l&&!this.composing||r.isReadOnly()||r.options.disableInput||r.state.keySeq)return!1;var S=a.value;if(S==l&&!r.somethingSelected())return!1;if(L&&E>=9&&this.hasSelection===S||te&&/[\uf700-\uf7ff]/.test(S))return r.display.input.reset(),!1;if(r.doc.sel==r.display.selForContextMenu){var O=S.charCodeAt(0);if(8203!=O||l||(l="​"),8666==O)return this.reset(),this.cm.execCommand("undo")}for(var D=0,j=Math.min(l.length,S.length);D<j&&l.charCodeAt(D)==S.charCodeAt(D);)++D;return runInOp(r,(function(){applyTextInput(r,S.slice(D),l.length-D,null,t.composing?"*compose":null),S.length>1e3||S.indexOf("\n")>-1?a.value=t.prevInput="":t.prevInput=S,t.composing&&(t.composing.range.clear(),t.composing.range=r.markText(t.composing.start,r.getCursor("to"),{className:"CodeMirror-composing"}))})),!0},TextareaInput.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},TextareaInput.prototype.onKeyPress=function(){L&&E>=9&&(this.hasSelection=null),this.fastPoll()},TextareaInput.prototype.onContextMenu=function(t){var r=this,a=r.cm,l=a.display,S=r.textarea;r.contextMenuPending&&r.contextMenuPending();var O=posFromMouse(a,t),j=l.scroller.scrollTop;if(O&&!q){a.options.resetSelectionOnContextMenu&&-1==a.doc.sel.contains(O)&&operation(a,setSelection)(a.doc,simpleSelection(O),ce);var B,G=S.style.cssText,X=r.wrapper.style.cssText,$=r.wrapper.offsetParent.getBoundingClientRect();if(r.wrapper.style.cssText="position: static",S.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-$.top-5)+"px; left: "+(t.clientX-$.left-5)+"px;\n      z-index: 1000; background: "+(L?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",D&&(B=window.scrollY),l.input.focus(),D&&window.scrollTo(null,B),l.input.reset(),a.somethingSelected()||(S.value=r.prevInput=" "),r.contextMenuPending=rehide,l.selForContextMenu=a.doc.sel,clearTimeout(l.detectingSelectAll),L&&E>=9&&prepareSelectAllHack(),ae){e_stop(t);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}function prepareSelectAllHack(){if(null!=S.selectionStart){var t=a.somethingSelected(),O="​"+(t?S.value:"");S.value="⇚",S.value=O,r.prevInput=t?"":"​",S.selectionStart=1,S.selectionEnd=O.length,l.selForContextMenu=a.doc.sel}}function rehide(){if(r.contextMenuPending==rehide&&(r.contextMenuPending=!1,r.wrapper.style.cssText=X,S.style.cssText=G,L&&E<9&&l.scrollbars.setScrollTop(l.scroller.scrollTop=j),null!=S.selectionStart)){(!L||L&&E<9)&&prepareSelectAllHack();var t=0,poll=function(){l.selForContextMenu==a.doc.sel&&0==S.selectionStart&&S.selectionEnd>0&&"​"==r.prevInput?operation(a,selectAll)(a):t++<10?l.detectingSelectAll=setTimeout(poll,500):(l.selForContextMenu=null,l.input.reset())};l.detectingSelectAll=setTimeout(poll,200)}}},TextareaInput.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t,this.textarea.readOnly=!!t},TextareaInput.prototype.setUneditable=function(){},TextareaInput.prototype.needsContentAttribute=!1,function defineOptions(t){var r=t.optionHandlers;function option(a,l,S,O){t.defaults[a]=l,S&&(r[a]=O?function(t,r,a){a!=tt&&S(t,r,a)}:S)}t.defineOption=option,t.Init=tt,option("value","",(function(t,r){return t.setValue(r)}),!0),option("mode",null,(function(t,r){t.doc.modeOption=r,loadMode(t)}),!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,(function(t){resetModeState(t),clearCaches(t),regChange(t)}),!0),option("lineSeparator",null,(function(t,r){if(t.doc.lineSep=r,r){var a=[],l=t.doc.first;t.doc.iter((function(t){for(var S=0;;){var O=t.text.indexOf(r,S);if(-1==O)break;S=O+r.length,a.push(Pos(l,O))}l++}));for(var S=a.length-1;S>=0;S--)replaceRange(t.doc,r,a[S],Pos(a[S].line,a[S].ch+r.length))}})),option("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,(function(t,r,a){t.state.specialChars=new RegExp(r.source+(r.test("\t")?"":"|\t"),"g"),a!=tt&&t.refresh()})),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,(function(t){return t.refresh()}),!0),option("electricChars",!0),option("inputStyle",ee?"contenteditable":"textarea",(function(){throw new Error("inputStyle can not (yet) be changed in a running editor")}),!0),option("spellcheck",!1,(function(t,r){return t.getInputField().spellcheck=r}),!0),option("autocorrect",!1,(function(t,r){return t.getInputField().autocorrect=r}),!0),option("autocapitalize",!1,(function(t,r){return t.getInputField().autocapitalize=r}),!0),option("rtlMoveVisually",!re),option("wholeLineUpdateBefore",!0),option("theme","default",(function(t){themeChanged(t),updateGutters(t)}),!0),option("keyMap","default",(function(t,r,a){var l=getKeyMap(r),S=a!=tt&&getKeyMap(a);S&&S.detach&&S.detach(t,l),l.attach&&l.attach(t,S||null)})),option("extraKeys",null),option("configureMouse",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],(function(t,r){t.display.gutterSpecs=getGutters(r,t.options.lineNumbers),updateGutters(t)}),!0),option("fixedGutter",!0,(function(t,r){t.display.gutters.style.left=r?compensateForHScroll(t.display)+"px":"0",t.refresh()}),!0),option("coverGutterNextToScrollbar",!1,(function(t){return updateScrollbars(t)}),!0),option("scrollbarStyle","native",(function(t){initScrollbars(t),updateScrollbars(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)}),!0),option("lineNumbers",!1,(function(t,r){t.display.gutterSpecs=getGutters(t.options.gutters,r),updateGutters(t)}),!0),option("firstLineNumber",1,updateGutters,!0),option("lineNumberFormatter",(function(t){return t}),updateGutters,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("lineWiseCopyCut",!0),option("pasteLinesPerSelection",!0),option("selectionsMayTouch",!1),option("readOnly",!1,(function(t,r){"nocursor"==r&&(onBlur(t),t.display.input.blur()),t.display.input.readOnlyChanged(r)})),option("screenReaderLabel",null,(function(t,r){r=""===r?null:r,t.display.input.screenReaderLabelChanged(r)})),option("disableInput",!1,(function(t,r){r||t.display.input.reset()}),!0),option("dragDrop",!0,dragDropChanged),option("allowDropFileTypes",null),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1,updateSelection,!0),option("singleCursorHeightPerLine",!0,updateSelection,!0),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",200,(function(t,r){return t.doc.history.undoDepth=r})),option("historyEventDelay",1250),option("viewportMargin",10,(function(t){return t.refresh()}),!0),option("maxHighlightLength",1e4,resetModeState,!0),option("moveInputWithCursor",!0,(function(t,r){r||t.display.input.resetPosition()})),option("tabindex",null,(function(t,r){return t.display.input.getField().tabIndex=r||""})),option("autofocus",null),option("direction","ltr",(function(t,r){return t.doc.setDirection(r)}),!0),option("phrases",null)}(CodeMirror),function addEditorMethods(t){var r=t.optionHandlers,a=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,a){var l=this.options,S=l[t];l[t]==a&&"mode"!=t||(l[t]=a,r.hasOwnProperty(t)&&operation(this,r[t])(this,a,S),signal(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,r){this.state.keyMaps[r?"push":"unshift"](getKeyMap(t))},removeKeyMap:function(t){for(var r=this.state.keyMaps,a=0;a<r.length;++a)if(r[a]==t||r[a].name==t)return r.splice(a,1),!0},addOverlay:methodOp((function(r,a){var l=r.token?r:t.getMode(this.options,r);if(l.startState)throw new Error("Overlays may not be stateful.");!function insertSorted(t,r,a){for(var l=0,S=a(r);l<t.length&&a(t[l])<=S;)l++;t.splice(l,0,r)}(this.state.overlays,{mode:l,modeSpec:r,opaque:a&&a.opaque,priority:a&&a.priority||0},(function(t){return t.priority})),this.state.modeGen++,regChange(this)})),removeOverlay:methodOp((function(t){for(var r=this.state.overlays,a=0;a<r.length;++a){var l=r[a].modeSpec;if(l==t||"string"==typeof t&&l.name==t)return r.splice(a,1),this.state.modeGen++,void regChange(this)}})),indentLine:methodOp((function(t,r,a){"string"!=typeof r&&"number"!=typeof r&&(r=null==r?this.options.smartIndent?"smart":"prev":r?"add":"subtract"),isLine(this.doc,t)&&indentLine(this,t,r,a)})),indentSelection:methodOp((function(t){for(var r=this.doc.sel.ranges,a=-1,l=0;l<r.length;l++){var S=r[l];if(S.empty())S.head.line>a&&(indentLine(this,S.head.line,t,!0),a=S.head.line,l==this.doc.sel.primIndex&&ensureCursorVisible(this));else{var O=S.from(),L=S.to(),E=Math.max(a,O.line);a=Math.min(this.lastLine(),L.line-(L.ch?0:1))+1;for(var D=E;D<a;++D)indentLine(this,D,t);var j=this.doc.sel.ranges;0==O.ch&&r.length==j.length&&j[l].from().ch>0&&replaceOneSelection(this.doc,l,new Range(O,j[l].to()),ce)}}})),getTokenAt:function(t,r){return takeToken(this,t,r)},getLineTokens:function(t,r){return takeToken(this,Pos(t),r,!0)},getTokenTypeAt:function(t){t=clipPos(this.doc,t);var r,a=getLineStyles(this,getLine(this.doc,t.line)),l=0,S=(a.length-1)/2,O=t.ch;if(0==O)r=a[2];else for(;;){var L=l+S>>1;if((L?a[2*L-1]:0)>=O)S=L;else{if(!(a[2*L+1]<O)){r=a[2*L+2];break}l=L+1}}var E=r?r.indexOf("overlay "):-1;return E<0?r:0==E?null:r.slice(0,E-1)},getModeAt:function(r){var a=this.doc.mode;return a.innerMode?t.innerMode(a,this.getTokenAt(r).state).mode:a},getHelper:function(t,r){return this.getHelpers(t,r)[0]},getHelpers:function(t,r){var l=[];if(!a.hasOwnProperty(r))return l;var S=a[r],O=this.getModeAt(t);if("string"==typeof O[r])S[O[r]]&&l.push(S[O[r]]);else if(O[r])for(var L=0;L<O[r].length;L++){var E=S[O[r][L]];E&&l.push(E)}else O.helperType&&S[O.helperType]?l.push(S[O.helperType]):S[O.name]&&l.push(S[O.name]);for(var D=0;D<S._global.length;D++){var j=S._global[D];j.pred(O,this)&&-1==indexOf(l,j.val)&&l.push(j.val)}return l},getStateAfter:function(t,r){var a=this.doc;return getContextBefore(this,(t=clipLine(a,null==t?a.first+a.size-1:t))+1,r).state},cursorCoords:function(t,r){var a=this.doc.sel.primary();return cursorCoords(this,null==t?a.head:"object"==typeof t?clipPos(this.doc,t):t?a.from():a.to(),r||"page")},charCoords:function(t,r){return charCoords(this,clipPos(this.doc,t),r||"page")},coordsChar:function(t,r){return coordsChar(this,(t=fromCoordSystem(this,t,r||"page")).left,t.top)},lineAtHeight:function(t,r){return t=fromCoordSystem(this,{top:t,left:0},r||"page").top,lineAtHeight(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,r,a){var l,S=!1;if("number"==typeof t){var O=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>O&&(t=O,S=!0),l=getLine(this.doc,t)}else l=t;return intoCoordSystem(this,l,{top:0,left:0},r||"page",a||S).top+(S?this.doc.height-heightAtLine(l):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,r,a,l,S){var O=this.display,L=(t=cursorCoords(this,clipPos(this.doc,t))).bottom,E=t.left;if(r.style.position="absolute",r.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(r),O.sizer.appendChild(r),"over"==l)L=t.top;else if("above"==l||"near"==l){var D=Math.max(O.wrapper.clientHeight,this.doc.height),j=Math.max(O.sizer.clientWidth,O.lineSpace.clientWidth);("above"==l||t.bottom+r.offsetHeight>D)&&t.top>r.offsetHeight?L=t.top-r.offsetHeight:t.bottom+r.offsetHeight<=D&&(L=t.bottom),E+r.offsetWidth>j&&(E=j-r.offsetWidth)}r.style.top=L+"px",r.style.left=r.style.right="","right"==S?(E=O.sizer.clientWidth-r.offsetWidth,r.style.right="0px"):("left"==S?E=0:"middle"==S&&(E=(O.sizer.clientWidth-r.offsetWidth)/2),r.style.left=E+"px"),a&&function scrollIntoView(t,r){var a=calculateScrollPos(t,r);null!=a.scrollTop&&updateScrollTop(t,a.scrollTop),null!=a.scrollLeft&&setScrollLeft(t,a.scrollLeft)}(this,{left:E,top:L,right:E+r.offsetWidth,bottom:L+r.offsetHeight})},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,triggerOnMouseDown:methodOp(onMouseDown),execCommand:function(t){if(Ye.hasOwnProperty(t))return Ye[t].call(null,this)},triggerElectric:methodOp((function(t){triggerElectric(this,t)})),findPosH:function(t,r,a,l){var S=1;r<0&&(S=-1,r=-r);for(var O=clipPos(this.doc,t),L=0;L<r&&!(O=findPosH(this.doc,O,S,a,l)).hitSide;++L);return O},moveH:methodOp((function(t,r){var a=this;this.extendSelectionsBy((function(l){return a.display.shift||a.doc.extend||l.empty()?findPosH(a.doc,l.head,t,r,a.options.rtlMoveVisually):t<0?l.from():l.to()}),pe)})),deleteH:methodOp((function(t,r){var a=this.doc.sel,l=this.doc;a.somethingSelected()?l.replaceSelection("",null,"+delete"):deleteNearSelection(this,(function(a){var S=findPosH(l,a.head,t,r,!1);return t<0?{from:S,to:a.head}:{from:a.head,to:S}}))})),findPosV:function(t,r,a,l){var S=1,O=l;r<0&&(S=-1,r=-r);for(var L=clipPos(this.doc,t),E=0;E<r;++E){var D=cursorCoords(this,L,"div");if(null==O?O=D.left:D.left=O,(L=findPosV(this,D,S,a)).hitSide)break}return L},moveV:methodOp((function(t,r){var a=this,l=this.doc,S=[],O=!this.display.shift&&!l.extend&&l.sel.somethingSelected();if(l.extendSelectionsBy((function(L){if(O)return t<0?L.from():L.to();var E=cursorCoords(a,L.head,"div");null!=L.goalColumn&&(E.left=L.goalColumn),S.push(E.left);var D=findPosV(a,E,t,r);return"page"==r&&L==l.sel.primary()&&addToScrollTop(a,charCoords(a,D,"div").top-E.top),D}),pe),S.length)for(var L=0;L<l.sel.ranges.length;L++)l.sel.ranges[L].goalColumn=S[L]})),findWordAt:function(t){var r=getLine(this.doc,t.line).text,a=t.ch,l=t.ch;if(r){var S=this.getHelper(t,"wordChars");"before"!=t.sticky&&l!=r.length||!a?++l:--a;for(var O=r.charAt(a),L=isWordChar(O,S)?function(t){return isWordChar(t,S)}:/\s/.test(O)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!isWordChar(t)};a>0&&L(r.charAt(a-1));)--a;for(;l<r.length&&L(r.charAt(l));)++l}return new Range(Pos(t.line,a),Pos(t.line,l))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?addClass(this.display.cursorDiv,"CodeMirror-overwrite"):rmClass(this.display.cursorDiv,"CodeMirror-overwrite"),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==activeElt()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:methodOp((function(t,r){scrollToCoords(this,t,r)})),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-scrollGap(this)-this.display.barHeight,width:t.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp((function(t,r){null==t?(t={from:this.doc.sel.primary().head,to:null},null==r&&(r=this.options.cursorScrollMargin)):"number"==typeof t?t={from:Pos(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=r||0,null!=t.from.line?function scrollToRange(t,r){resolveScrollToPos(t),t.curOp.scrollToPos=r}(this,t):scrollToCoordsRange(this,t.from,t.to,t.margin)})),setSize:methodOp((function(t,r){var a=this,interpret=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=interpret(t)),null!=r&&(this.display.wrapper.style.height=interpret(r)),this.options.lineWrapping&&clearLineMeasurementCache(this);var l=this.display.viewFrom;this.doc.iter(l,this.display.viewTo,(function(t){if(t.widgets)for(var r=0;r<t.widgets.length;r++)if(t.widgets[r].noHScroll){regLineChange(a,l,"widget");break}++l})),this.curOp.forceUpdate=!0,signal(this,"refresh",this)})),operation:function(t){return runInOp(this,t)},startOperation:function(){return startOperation(this)},endOperation:function(){return endOperation(this)},refresh:methodOp((function(){var t=this.display.cachedTextHeight;regChange(this),this.curOp.forceUpdate=!0,clearCaches(this),scrollToCoords(this,this.doc.scrollLeft,this.doc.scrollTop),updateGutterSpace(this.display),(null==t||Math.abs(t-textHeight(this.display))>.5||this.options.lineWrapping)&&estimateLineHeights(this),signal(this,"refresh",this)})),swapDoc:methodOp((function(t){var r=this.doc;return r.cm=null,this.state.selectingText&&this.state.selectingText(),attachDoc(this,t),clearCaches(this),this.display.input.reset(),scrollToCoords(this,t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,signalLater(this,"swapDoc",this,r),r})),phrase:function(t){var r=this.options.phrases;return r&&Object.prototype.hasOwnProperty.call(r,t)?r[t]:t},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(t),t.registerHelper=function(r,l,S){a.hasOwnProperty(r)||(a[r]=t[r]={_global:[]}),a[r][l]=S},t.registerGlobalHelper=function(r,l,S,O){t.registerHelper(r,l,O),a[r]._global.push({pred:S,val:O})}}(CodeMirror);var at="iter insert remove copy getEditor constructor".split(" ");for(var st in Doc.prototype)Doc.prototype.hasOwnProperty(st)&&indexOf(at,st)<0&&(CodeMirror.prototype[st]=function(t){return function(){return t.apply(this.doc,arguments)}}(Doc.prototype[st]));return eventMixin(Doc),CodeMirror.inputStyles={textarea:TextareaInput,contenteditable:ContentEditableInput},CodeMirror.defineMode=function(t){CodeMirror.defaults.mode||"null"==t||(CodeMirror.defaults.mode=t),defineMode.apply(this,arguments)},CodeMirror.defineMIME=function defineMIME(t,r){Pe[t]=r},CodeMirror.defineMode("null",(function(){return{token:function(t){return t.skipToEnd()}}})),CodeMirror.defineMIME("text/plain","null"),CodeMirror.defineExtension=function(t,r){CodeMirror.prototype[t]=r},CodeMirror.defineDocExtension=function(t,r){Doc.prototype[t]=r},CodeMirror.fromTextArea=function fromTextArea(t,r){if((r=r?copyObj(r):{}).value=t.value,!r.tabindex&&t.tabIndex&&(r.tabindex=t.tabIndex),!r.placeholder&&t.placeholder&&(r.placeholder=t.placeholder),null==r.autofocus){var a=activeElt();r.autofocus=a==t||null!=t.getAttribute("autofocus")&&a==document.body}function save(){t.value=L.getValue()}var l;if(t.form&&(on(t.form,"submit",save),!r.leaveSubmitMethodAlone)){var S=t.form;l=S.submit;try{var O=S.submit=function(){save(),S.submit=l,S.submit(),S.submit=O}}catch(t){}}r.finishInit=function(a){a.save=save,a.getTextArea=function(){return t},a.toTextArea=function(){a.toTextArea=isNaN,save(),t.parentNode.removeChild(a.getWrapperElement()),t.style.display="",t.form&&(off(t.form,"submit",save),r.leaveSubmitMethodAlone||"function"!=typeof t.form.submit||(t.form.submit=l))}},t.style.display="none";var L=CodeMirror((function(r){return t.parentNode.insertBefore(r,t.nextSibling)}),r);return L},function addLegacyProps(t){t.off=off,t.on=on,t.wheelEventPixels=wheelEventPixels,t.Doc=Doc,t.splitLines=xe,t.countColumn=countColumn,t.findColumn=findColumn,t.isWordChar=isWordCharBasic,t.Pass=le,t.signal=signal,t.Line=Line,t.changeEnd=changeEnd,t.scrollbarModel=ze,t.Pos=Pos,t.cmpPos=cmp,t.modes=Te,t.mimeModes=Pe,t.resolveMode=resolveMode,t.getMode=getMode,t.modeExtensions=Le,t.extendMode=extendMode,t.copyState=copyState,t.startState=startState,t.innerMode=innerMode,t.commands=Ye,t.keyMap=$e,t.keyName=keyName,t.isModifierKey=isModifierKey,t.lookupKey=lookupKey,t.normalizeKeyMap=normalizeKeyMap,t.StringStream=StringStream,t.SharedTextMarker=SharedTextMarker,t.TextMarker=TextMarker,t.LineWidget=LineWidget,t.e_preventDefault=e_preventDefault,t.e_stopPropagation=e_stopPropagation,t.e_stop=e_stop,t.addClass=addClass,t.contains=contains,t.rmClass=rmClass,t.keyNames=qe}(CodeMirror),CodeMirror.version="5.61.0",CodeMirror}()},314:function(t,r,a){var l,S;l=[a(1)],void 0===(S=function(t){"use strict";var r={};return{publish:function(a,l){r[a]&&t.each(r[a],(function(){this&&this.apply(t,l||[])}))},subscribe:function(t,a){return r[t]||(r[t]=[]),r[t].push(a),[t,a]},unsubscribe:function(a){var l=a[0];r[l]&&t.each(r[l],(function(t){this==a[1]&&r[l].splice(t,1)}))},reset:function(){r={}}}}.apply(r,l))||(t.exports=S)},317:function(t,r,a){"use strict";var l=a(0),S=a.n(l),O=a(284),L=a(218),E=a.n(L),D=(a(192),a(236));function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var a,l=_getPrototypeOf(t);if(r){var S=_getPrototypeOf(this).constructor;a=Reflect.construct(l,arguments,S)}else a=l.apply(this,arguments);return _possibleConstructorReturn(this,a)}}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(FormulaScorer,t);var r=_createSuper(FormulaScorer);function FormulaScorer(t,a){return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,FormulaScorer),S.a.isObject(a)&&S.a.isNumber(a.mathcoreTimeoutDuration)?E.a.setTimeoutDuration(a.mathcoreTimeoutDuration):E.a.setTimeoutDuration(5e3),r.call(this,t,a)}return FormulaScorer}(O.a);j.prototype.validateSingleSpec=D.a,r.a=j},318:function(t,r,a){"use strict";var l,S=a(5),O=a.n(S),L=a(0),E=a.n(L),D=a(1),j=a.n(D),B=a(213),q=a(7),G=a(269),X=a.n(G),$=a(17),Z=a.n($),Q=["bold","italic","underline","unorderedList"],ee=X.a,te=/<!--([\s\S]*?)-->/g,ne=/<p>/gi,re=/<\/p>/gi,oe=/<\/?(em|strong|u|sup|sub)[^>]*>/gi,ie=/<\/?(br|li|ol|ul|span)[^>]*>/gi,ae=/<\/?(div)[^>]*>/gi,se=/<(div)><\/(div)>/gi,le=/<(div|p)><br><\/(div|p)>/gi,ce=/<br>(^<\/br>)/gi,ue=/&nbsp;/g,pe=/src=\"data:image\/([a-zA-Z]*);base64,([^\"]*)\"/,de=/<img .*?>/g,fe=Object(B.a)("[\\p{L}\\p{N}]"),he=j()(document);r.a=function editor(t){E.a.extend(this,O.a.Events);var r,a,S,L,D,B,G,X,$,ge,me,ye,ve=!1,be=!1,_e=[],we=[];function getContent(){return"ie"!==q.a.browser||9!==q.a.version&&10!==q.a.version?cleanHTML(D.html()):D.html().replace(/<p>/g,"").replace(/<\/p>/g,"<br>")}function cleanHTML(t){return t=function cleanTagsThatCauseIssuesWhenPasting(t){return t=(t=(t=t.replace(le,"<br></br>")).replace(se,"<br></br>")).replace(ce,"<br></br>"),pe.test(t)&&(t=t.replace(de,"")),t}(t),t=(t=Z.a.sanitizeHTML(t)).replace(te,""),"ie"===q.a.browser&&9===q.a.version||(t=t.replace(re,"<br></br>")),t=t.replace(ne,"")}function getWordCount(t){return t=function cleanHTMLForWordCount(t){return t=(t=(t=(t=t.replace(oe,"")).replace(ie," ")).replace(ae," ")).replace(ue," ")}(t),E.a.reduce(t.split(/\s+/),(function(t,r){return r.length>0&&fe.test(r)?t+1:t}),0)}function updateToolbar(){E.a.each(_e,(function(t){t.updateUI()}))}this.getTbContainer=function(){return ye};var xe=function Command(t){this.execute=function(){"subscript"!==t&&"superscript"!==t||this.queryState()||E.a.each(["subscript","superscript"],(function(t){Se[t]&&Se[t].command.queryState()&&document.execCommand(t,!1,null)})),document.execCommand(t,!1,null),ve=!0},this.queryState=function(){return document.queryCommandState(t)},this.setButton=function(t){this.button=t}};function InsertListCommand(t){var r=t?"insertOrderedList":"insertUnorderedList",a="ie"===q.a.browser||"edge"===q.a.browser;this.execute=function(){!function handleInsertListDependingOnBrowser(t,r){var a;D.focus(),t&&(a=j()(document.createElement("p")),D.append(a));document.execCommand(r,!1,null),t&&a.remove()}(a,r),ve=!0},this.queryState=function(){return document.queryCommandState(r)},this.setButton=function(t){this.button=t}}function CharacterMapCommand(r){E.a.isArray(r)||(r=t.labels.characterMapCharacters),this.execute=function(){var a=this;if(be)removeCharMap();else{var l=j()(ee({characters:r,labels:t.labels})).hide().appendTo(this.button),S=this.button.position().left,O=ye.width()-(S+this.button.outerWidth()),L=Math.abs(-l.width()/2+this.button.outerWidth()),E=function destroyCharacterMap(){a.button.removeClass("lrn_active"),removeCharMap()};L>S&&(L=S),l.width()/2>O&&(L+=l.width()/2-O),l.css("left",-L+"px").fadeIn("fast",(function(){he.off("click.charactermap").on("click.charactermap",E)})),l.find(".lrn_characterbutton").first().focus(),be=!0,j()(".lrn_toolbar .lrn_charactermap .lrn_characterbutton",D.parents(".lrn_texteditor")).on("mousedown",(function(t){t.preventDefault()}))}},this.queryState=function(){return be},this.setButton=function(t){this.button=t}}var Ce=function ToggleCommandButtonController(r,S,O,L){var E,B=j()("<li></li>").addClass("lrn_btn");B.html(r.content),B.attr({unselectable:"on",title:r.title,"aria-label":r.title,tabindex:0,role:"button","data-button-index":O}),j()(B).children().attr("unselectable","on"),B.on("mousedown",(function(t){t.preventDefault&&t.preventDefault()})),a||(B.on("click",(function(t){D.is(":focus")||D.focus(),r.command.execute(),updateToolbar()})),B.on("keydown",(function(a){13!==a.which&&32!==a.which||(a.preventDefault(),D.is(":focus")||D.focus(),r.title===t.labels.characterMapTitle&&(l=!0),r.command.execute(),updateToolbar()),37===a.which&&(a.preventDefault(),E=(O+L-1)%L,S.find('li[data-button-index="'+E+'"]').first().focus()),39===a.which&&(a.preventDefault(),E=(O+1)%L,S.find('li[data-button-index="'+E+'"]').first().focus())})),B.on("keyup",(function(t){32===t.which&&t.preventDefault()}))),B.appendTo(S),r.command.setButton(B),this.getQueryState=function(){return r.command.queryState()},this.updateUI=function(){r.command.queryState()?(B.addClass("lrn_active"),B.attr({"aria-pressed":"true"})):(B.removeClass("lrn_active"),B.attr({"aria-pressed":"false"}))}};function removeCharMap(){if(be&&!l){var t=j()(".lrn_toolbar .lrn_charactermap",D.parents(".lrn_texteditor"));t.finish().fadeOut((function(){t.remove()})),be=!1,he.off("click.charactermap")}l=!1}function updateContentAndWordCount(){ve&&(ve=!1,S=getContent(),L=getWordCount(S),function checkWordCount(){$.html(L),L>r?("on-limit"===B&&ge.addClass("lrn_hide"),"off"!==B&&X.removeClass("lrn_hide"),G.addClass("lrn_wordcount_warning_label"),D.addClass("lrn_wordcount_warning")):("on-limit"===B&&(ge.removeClass("lrn_hide"),X.addClass("lrn_hide")),G.removeClass("lrn_wordcount_warning_label"),D.removeClass("lrn_wordcount_warning"))}())}function charLimitExceeded(){return L>1e4}function insertTextAtCursor(t){charLimitExceeded()||(document.getSelection?document.getSelection().getRangeAt(0).insertNode(document.createTextNode(t)):document.selection?document.selection.createRange().pasteHTML(t):document.execCommand("InsertHTML",!1,t))}var Se={bold:{command:new xe("bold"),content:"<strong>"+t.labels.editorBoldIcon+'</strong> <span class="sr-only">'+t.labels.editorBoldTitle+"</span>",title:t.labels.editorBoldTitle,block:!1},italic:{command:new xe("italic"),content:"<em>"+t.labels.editorItalicsIcon+'</em> <span class="sr-only">'+t.labels.editorItalicsTitle+"</span>",title:t.labels.editorItalicsTitle,block:!1},underline:{command:new xe("underline"),content:"<u>"+t.labels.editorUnderlineIcon+'</u> <span class="sr-only">'+t.labels.editorUnderlineTitle+"</span>",title:t.labels.editorUnderlineTitle,block:!1},removeFormat:{command:new xe("removeFormat"),content:'<i class="lrn_icon lrn-icon-remove-format"></i> <span class="sr-only">'+t.labels.editorRemoveFormatTitle+"</span>",title:t.labels.editorRemoveFormatTitle,block:!1},unorderedList:{command:new InsertListCommand,content:'<i class="lrn_icon lrn-icon-list-bulleted"></i> <span class="sr-only">'+t.labels.editorBulletdListTitle+"</span>",title:t.labels.editorBulletdListTitle,block:!0},orderedList:{command:new InsertListCommand(!0),content:'<i class="lrn_icon lrn-icon-list-numbered"></i> <span class="sr-only">'+t.labels.editorNumberedListTitle+"</span>",title:t.labels.editorNumberedListTitle,block:!0},superscript:{command:new xe("superscript"),content:'<i class="lrn_icon lrn-icon-superscript"></i> <span class="sr-only">'+t.labels.editorSuperscriptTitle+"</span>",title:t.labels.editorSuperscriptTitle,block:!1},subscript:{command:new xe("subscript"),content:'<i class="lrn_icon lrn-icon-subscript"></i> <span class="sr-only"> <span class="sr-only">'+t.labels.editorSubscriptTitle+"</span>",title:t.labels.editorSubscriptTitle,block:!1}};this.makeEditor=function(l){var O,L,Z,ee,te,ne,re,oe,ie,ae=this,se=l.el,le=l.showCharacterMap,ce=l.spellCheck,ue=l.characterMapIcon,pe=l.placeholder,de=l.wordsLimit,fe=l.shouldInsertToolbar,he=this.normalizeFormattingOptions(l.formattingOptions);switch(a=l.readOnly,r=l.maxWordLength,this.commandDefinitions=Se,E.a.isUndefined(fe)&&(fe=!0),E.a.isArray(he)||(he=Q),O=E.a.map(he,(function(t){return Se[t]})),le&&(Se.characterMap={command:new CharacterMapCommand(le),content:ue+'<span class="sr-only">'+t.labels.characterMapTitle+"</span>",title:t.labels.characterMapTitle},O.push(Se.characterMap)),(D=j()(se)).addClass("lrn_editor_area"),D.wrap('<div class="lrn_response_input_wrapper" />'),a?D.wrap('<div class="lrn_texteditor lrn_editor_disabled" />'):(D.wrap('<div class="lrn_texteditor" />'),D.attr("contentEditable","true"),E.a.isBoolean(ce)&&D.attr("spellcheck",ce.toString()),"ie"===q.a.browser&&9===q.a.version&&0!==D.html().indexOf("<p>")&&D.html("<p>"+D.html().replace(/<br>/g,"</p><p>")+"</p>")),G=j()('<span class="lrn_length_indicator" />'),me=j()('<span class="lrn_toolbar_right" />').append(G),L=j()('<ul class="lrn_toolbar_left lrn_clearfix"></ul>'),ye=j()('<div class="lrn-toolbar-wrapper" />').append(j()('<div class="lrn_toolbar" />').append(L).append(me)),fe&&D.parent().prepend(ye),E.a.each(O,(function(t,r){!0===t.block&&we.push(t),Z=new Ce(t,L,r,O.length),_e.push(Z)})),B=de,ee=!1,de){case"always":ee=!1;break;case"on-limit":case"off":ee=!0}if($=j()('<span class="lrn_word_count" />').html("0"),ge=j()('<span class="lrn_static_words'+(!0===ee?"":" lrn_hide")+'"> '+t.labels.word+"</span>"),X=j()('<span class="lrn_word_limit'+(!0===ee?" lrn_hide":"")+'"> / '+r+" "+t.labels.wordLength+"</span>"),G.append($,ge,X),a||E.a.isEmpty(pe)||(te=j()('<span class="lrn_placeholder" />').text(pe),ne=j()('<div class="lrn_input_with_placeholder" />'),re=function togglePlaceholder(){var t=D.text();t&&t.length>0?te.hide():te.show()},D.wrap(ne).before(te),D.on("focus blur keydown keyup",re),te.on("click",(function(t){D.focus()})),re()),!a){D.on("blur",(function(){triggerChange(),ae.trigger("blur")})),D.on("focus",(function(){ae.trigger("focus")})),D.on("touchend",(function(){window.focus()})),D.on("keyup mouseup",(function(){removeCharMap(),updateToolbar(),triggerChange()})),"ie"!==q.a.browser?D.on("keyup mouseup",(function(){this.lastChild&&"br"===this.lastChild.nodeName.toLowerCase()||this.appendChild(document.createElement("br"))})):q.a.browser<9&&D.on("keyup mouseup",(function(){var t,r;D.is(":empty")&&(t=document.createElement("p"),D.append(t),(r=document.body.createTextRange()).moveToElementText(t),r.select())})),oe=E.a.throttle((function(){updateContentAndWordCount(),triggerChange()}),300),ve=!0,updateContentAndWordCount(),D.on("keyup",oe),D.on("keyup",(function(t){ve=!0,ae.trigger("keyup"),triggerChange()})),D.on("paste",(function(t){charLimitExceeded()&&t.preventDefault(),E.a.defer((function(){var t,r,a,l;window.getSelection?(t=window.getSelection().getRangeAt(0),(r=document.createElement("caret")).innerHTML="-",t.insertNode(r),D.html(getContent()),r=document.getElementsByTagName("caret")[0],(t=window.getSelection().rangeCount>0?window.getSelection().getRangeAt(0):document.createRange()).setStartBefore(r),t.setEndBefore(r),(a=window.getSelection()).rangeCount>0&&a.removeAllRanges(),a.addRange(t),r.parentNode.removeChild(r)):document.selection?((t=document.selection.createRange()).pasteHTML("<span id=lrneditorcaret>-</span>"),l=(l=cleanHTML(l=(l=D.html()).replace(/<span id=lrneditorcaret>-<\/span>/i,"<caret>-</caret>"))).replace(/<caret>-<\/caret>/i,"<span id=lrneditorcaret>-</span>"),D.html(l),r=document.getElementById("lrneditorcaret"),(t=document.selection.createRange()).moveToElementText(r),t.select(),r.parentNode.removeChild(r)):D.html(cleanHTML(D.html())),ve=!0,oe()}))})),D.on("keydown",(function(t){if(t.ctrlKey||t.metaKey){var r;switch(t.which){case 66:r=Se.bold;break;case 73:r=Se.italic;break;case 85:r=Se.underline;break;default:return}r.command.execute(),t.preventDefault(),updateToolbar(),triggerChange()}})),D.on("keypress",(function(t){t.which>31&&t.which<127&&charLimitExceeded()&&t.preventDefault(),triggerChange()}));D.parents(".lrn_texteditor").on("click",".lrn_charactermap .lrn_characterbutton",(function clickListener(t){insertTextAtCursor(j()(t.target).text()),D.trigger("keyup"),triggerChange()})),D.parents(".lrn_texteditor").on("keydown",".lrn_charactermap .lrn_characterbutton",(function keyListener(t){var r=j()(t.target).data("character-btn-index");13!==t.which&&32!==t.which||insertTextAtCursor(j()(t.target).text()),37===t.which&&(r=(r+le.length-1)%le.length,t.preventDefault(),D.parents(".lrn_texteditor").find('.lrn_charactermap .lrn_characterbutton[data-character-btn-index="'+r+'"]').first().focus()),39===t.which&&(r=(r+1)%le.length,t.preventDefault(),D.parents(".lrn_texteditor").find('.lrn_charactermap .lrn_characterbutton[data-character-btn-index="'+r+'"]').first().focus())})),D.parents(".lrn_texteditor").on("mousedown",".lrn_charactermap",(function mousedownListener(t){t.preventDefault(),triggerChange()}))}function triggerChange(){S!==ie&&(ae.trigger("change"),ie=S)}ie=S},this.getContentAndWordCount=function(){return updateContentAndWordCount(),{content:S,wordCount:L}},this.focus=function(){D.focus()},this.isEmpty=function(){return!this.getContentAndWordCount().wordCount},this.normalizeFormattingOptions=function(t){if(E.a.isArray(t))return E.a.filter(E.a.uniq(t),(function(t){return!!t}))}}},319:function(t,r,a){"use strict";a.d(r,"a",(function(){return l}));var l={recursionDepthHigh:13,recursionDepthLow:8};r.b={keepMouseEventHandlers:function keepMouseEventHandlers(t){t.hasMouseHandlers||t.addMouseEventHandlers()}}},321:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="lrn_cloze_response_container">'+(null==(__t="clozeassociation"==displayLogic.questiontype?'<div class="lrn_response_input_wrapper lrn-response-validate-wrapper">':"")?"":__t)+(null==(__t="imageclozeassociation"==displayLogic.questiontype?'<div class="lrn_response_input_wrapper lrn_response_input_wrapper_left lrn-response-validate-wrapper">':"")?"":__t)+'<div class="lrn_response_innerbody '+(null==(__t="imageclozeassociation"!=displayLogic.questiontype&&"clozeassociation"!=displayLogic.questiontype?"lrn-response-validate-wrapper":"")?"":__t)+'">',_.isUndefined(displayLogic.possibilityListPosition)||"top"!==displayLogic.possibilityListPosition&&"left"!==displayLogic.possibilityListPosition||(__p+="",displayLogic.extraContentHTML&&(__p+=""+(null==(__t=displayLogic.extraContentHTML)?"":__t)),__p+=""),__p+="",_.isUndefined(displayLogic.possibilityListPosition)||"left"!==displayLogic.possibilityListPosition&&"right"!==displayLogic.possibilityListPosition||(__p+='<div class="lrn_response_input_position">'),__p+='<div class="lrn_response_input lrn_response_math'+(null==(__t=displayLogic.hasBoostedFont?" lrn_response_font_boost":"")?"":__t)+'" aria-label="'+(null==(__t=displayLogic.questionText)?"":_.escape(__t))+'">'+(null==(__t=displayLogic.processedTemplate)?"":__t)+"</div>",_.isUndefined(displayLogic.possibilityListPosition)||"left"!==displayLogic.possibilityListPosition&&"right"!==displayLogic.possibilityListPosition||(__p+="</div>"),__p+="",(_.isUndefined(displayLogic.possibilityListPosition)||_.isNull(displayLogic.possibilityListPosition)||"bottom"===displayLogic.possibilityListPosition||"right"===displayLogic.possibilityListPosition)&&(__p+="",displayLogic.extraContentHTML&&(__p+=""+(null==(__t=displayLogic.extraContentHTML)?"":__t)),__p+=""),__p+="</div>"+(null==(__t="imageclozeassociation"==displayLogic.questiontype||"clozeassociation"==displayLogic.questiontype?"</div>":"")?"":__t)+'</div><div class="lrn_correctAnswers lrn_hide"><span>'+(null==(__t=labels.correctAnswers)?"":__t)+':</span><ul class="lrn_correctAnswerList"></ul></div>',displayLogic.showValidationButton&&(__p+='<button type="button" '+(null==(__t=displayLogic.readOnly?'disabled="disabled"':"")?"":__t)+' class="lrn_btn lrn_validate"><span>'+(null==(__t=displayLogic.multipleResponses?labels.checkAnswers:labels.checkAnswer)?"":__t)+"</span></button>"),__p+="";return __p}},325:function(t,r,a){"use strict";t.exports=a(457)},326:function(t,r,a){"use strict";var l,S,O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};S=function(){for(var t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];var l=document.createElement("input");return"object"===O(r[0])&&(!0===r[0].multiple&&l.setAttribute("multiple",""),void 0!==r[0].accept&&l.setAttribute("accept",r[0].accept)),l.setAttribute("type","file"),l.style.display="none",l.setAttribute("id","hidden-file"),document.body.appendChild(l),new Promise((function(t){l.addEventListener("change",(function(){t(l.files);var a=r[r.length-1];"function"==typeof a&&a(l.files),document.body.removeChild(l)}));var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),l.dispatchEvent(a)}))},void 0===(l=function(){return S}.call(r,a,r,t))||(t.exports=l)},327:function(t,r,a){!function(t){"use strict";t.defineMode("javascript",(function(r,a){var l,S,O=r.indentUnit,L=a.statementIndent,E=a.jsonld,D=a.json||E,j=!1!==a.trackScope,B=a.typescript,q=a.wordCharacters||/[\w$\xa1-\uffff]/,G=function(){function kw(t){return{type:t,style:"keyword"}}var t=kw("keyword a"),r=kw("keyword b"),a=kw("keyword c"),l=kw("keyword d"),S=kw("operator"),O={type:"atom",style:"atom"};return{if:kw("if"),while:t,with:t,else:r,do:r,try:r,finally:r,return:l,break:l,continue:l,new:kw("new"),delete:a,void:a,throw:a,debugger:kw("debugger"),var:kw("var"),const:kw("var"),let:kw("var"),function:kw("function"),catch:kw("catch"),for:kw("for"),switch:kw("switch"),case:kw("case"),default:kw("default"),in:S,typeof:S,instanceof:S,true:O,false:O,null:O,undefined:O,NaN:O,Infinity:O,this:kw("this"),class:kw("class"),super:kw("atom"),yield:a,export:kw("export"),import:kw("import"),extends:a,await:a}}(),X=/[+\-*&%=<>!?|~^@]/,$=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function ret(t,r,a){return l=t,S=a,r}function tokenBase(t,r){var a=t.next();if('"'==a||"'"==a)return r.tokenize=function tokenString(t){return function(r,a){var l,S=!1;if(E&&"@"==r.peek()&&r.match($))return a.tokenize=tokenBase,ret("jsonld-keyword","meta");for(;null!=(l=r.next())&&(l!=t||S);)S=!S&&"\\"==l;return S||(a.tokenize=tokenBase),ret("string","string")}}(a),r.tokenize(t,r);if("."==a&&t.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return ret("number","number");if("."==a&&t.match(".."))return ret("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(a))return ret(a);if("="==a&&t.eat(">"))return ret("=>","operator");if("0"==a&&t.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return ret("number","number");if(/\d/.test(a))return t.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),ret("number","number");if("/"==a)return t.eat("*")?(r.tokenize=tokenComment,tokenComment(t,r)):t.eat("/")?(t.skipToEnd(),ret("comment","comment")):expressionAllowed(t,r,1)?(function readRegexp(t){for(var r,a=!1,l=!1;null!=(r=t.next());){if(!a){if("/"==r&&!l)return;"["==r?l=!0:l&&"]"==r&&(l=!1)}a=!a&&"\\"==r}}(t),t.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),ret("regexp","string-2")):(t.eat("="),ret("operator","operator",t.current()));if("`"==a)return r.tokenize=tokenQuasi,tokenQuasi(t,r);if("#"==a&&"!"==t.peek())return t.skipToEnd(),ret("meta","meta");if("#"==a&&t.eatWhile(q))return ret("variable","property");if("<"==a&&t.match("!--")||"-"==a&&t.match("->")&&!/\S/.test(t.string.slice(0,t.start)))return t.skipToEnd(),ret("comment","comment");if(X.test(a))return">"==a&&r.lexical&&">"==r.lexical.type||(t.eat("=")?"!"!=a&&"="!=a||t.eat("="):/[<>*+\-|&?]/.test(a)&&(t.eat(a),">"==a&&t.eat(a))),"?"==a&&t.eat(".")?ret("."):ret("operator","operator",t.current());if(q.test(a)){t.eatWhile(q);var l=t.current();if("."!=r.lastType){if(G.propertyIsEnumerable(l)){var S=G[l];return ret(S.type,S.style,l)}if("async"==l&&t.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return ret("async","keyword",l)}return ret("variable","variable",l)}}function tokenComment(t,r){for(var a,l=!1;a=t.next();){if("/"==a&&l){r.tokenize=tokenBase;break}l="*"==a}return ret("comment","comment")}function tokenQuasi(t,r){for(var a,l=!1;null!=(a=t.next());){if(!l&&("`"==a||"$"==a&&t.eat("{"))){r.tokenize=tokenBase;break}l=!l&&"\\"==a}return ret("quasi","string-2",t.current())}function findFatArrow(t,r){r.fatArrowAt&&(r.fatArrowAt=null);var a=t.string.indexOf("=>",t.start);if(!(a<0)){if(B){var l=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(t.string.slice(t.start,a));l&&(a=l.index)}for(var S=0,O=!1,L=a-1;L>=0;--L){var E=t.string.charAt(L),D="([{}])".indexOf(E);if(D>=0&&D<3){if(!S){++L;break}if(0==--S){"("==E&&(O=!0);break}}else if(D>=3&&D<6)++S;else if(q.test(E))O=!0;else if(/["'\/`]/.test(E))for(;;--L){if(0==L)return;if(t.string.charAt(L-1)==E&&"\\"!=t.string.charAt(L-2)){L--;break}}else if(O&&!S){++L;break}}O&&!S&&(r.fatArrowAt=L)}}var Z={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function JSLexical(t,r,a,l,S,O){this.indented=t,this.column=r,this.type=a,this.prev=S,this.info=O,null!=l&&(this.align=l)}function inScope(t,r){if(!j)return!1;for(var a=t.localVars;a;a=a.next)if(a.name==r)return!0;for(var l=t.context;l;l=l.prev)for(a=l.vars;a;a=a.next)if(a.name==r)return!0}var Q={state:null,column:null,marked:null,cc:null};function pass(){for(var t=arguments.length-1;t>=0;t--)Q.cc.push(arguments[t])}function cont(){return pass.apply(null,arguments),!0}function inList(t,r){for(var a=r;a;a=a.next)if(a.name==t)return!0;return!1}function register(t){var r=Q.state;if(Q.marked="def",j){if(r.context)if("var"==r.lexical.info&&r.context&&r.context.block){var l=function registerVarScoped(t,r){if(r){if(r.block){var a=registerVarScoped(t,r.prev);return a?a==r.prev?r:new Context(a,r.vars,!0):null}return inList(t,r.vars)?r:new Context(r.prev,new Var(t,r.vars),!1)}return null}(t,r.context);if(null!=l)return void(r.context=l)}else if(!inList(t,r.localVars))return void(r.localVars=new Var(t,r.localVars));a.globalVars&&!inList(t,r.globalVars)&&(r.globalVars=new Var(t,r.globalVars))}}function isModifier(t){return"public"==t||"private"==t||"protected"==t||"abstract"==t||"readonly"==t}function Context(t,r,a){this.prev=t,this.vars=r,this.block=a}function Var(t,r){this.name=t,this.next=r}var ee=new Var("this",new Var("arguments",null));function pushcontext(){Q.state.context=new Context(Q.state.context,Q.state.localVars,!1),Q.state.localVars=ee}function pushblockcontext(){Q.state.context=new Context(Q.state.context,Q.state.localVars,!0),Q.state.localVars=null}function popcontext(){Q.state.localVars=Q.state.context.vars,Q.state.context=Q.state.context.prev}function pushlex(t,r){var result=function(){var a=Q.state,l=a.indented;if("stat"==a.lexical.type)l=a.lexical.indented;else for(var S=a.lexical;S&&")"==S.type&&S.align;S=S.prev)l=S.indented;a.lexical=new JSLexical(l,Q.stream.column(),t,null,a.lexical,r)};return result.lex=!0,result}function poplex(){var t=Q.state;t.lexical.prev&&(")"==t.lexical.type&&(t.indented=t.lexical.indented),t.lexical=t.lexical.prev)}function expect(t){return function exp(r){return r==t?cont():";"==t||"}"==r||")"==r||"]"==r?pass():cont(exp)}}function statement(t,r){return"var"==t?cont(pushlex("vardef",r),vardef,expect(";"),poplex):"keyword a"==t?cont(pushlex("form"),parenExpr,statement,poplex):"keyword b"==t?cont(pushlex("form"),statement,poplex):"keyword d"==t?Q.stream.match(/^\s*$/,!1)?cont():cont(pushlex("stat"),maybeexpression,expect(";"),poplex):"debugger"==t?cont(expect(";")):"{"==t?cont(pushlex("}"),pushblockcontext,block,poplex,popcontext):";"==t?cont():"if"==t?("else"==Q.state.lexical.info&&Q.state.cc[Q.state.cc.length-1]==poplex&&Q.state.cc.pop()(),cont(pushlex("form"),parenExpr,statement,poplex,maybeelse)):"function"==t?cont(functiondef):"for"==t?cont(pushlex("form"),pushblockcontext,forspec,statement,popcontext,poplex):"class"==t||B&&"interface"==r?(Q.marked="keyword",cont(pushlex("form","class"==t?t:r),className,poplex)):"variable"==t?B&&"declare"==r?(Q.marked="keyword",cont(statement)):B&&("module"==r||"enum"==r||"type"==r)&&Q.stream.match(/^\s*\w/,!1)?(Q.marked="keyword","enum"==r?cont(enumdef):"type"==r?cont(typename,expect("operator"),typeexpr,expect(";")):cont(pushlex("form"),pattern,expect("{"),pushlex("}"),block,poplex,poplex)):B&&"namespace"==r?(Q.marked="keyword",cont(pushlex("form"),expression,statement,poplex)):B&&"abstract"==r?(Q.marked="keyword",cont(statement)):cont(pushlex("stat"),maybelabel):"switch"==t?cont(pushlex("form"),parenExpr,expect("{"),pushlex("}","switch"),pushblockcontext,block,poplex,poplex,popcontext):"case"==t?cont(expression,expect(":")):"default"==t?cont(expect(":")):"catch"==t?cont(pushlex("form"),pushcontext,maybeCatchBinding,statement,poplex,popcontext):"export"==t?cont(pushlex("stat"),afterExport,poplex):"import"==t?cont(pushlex("stat"),afterImport,poplex):"async"==t?cont(statement):"@"==r?cont(expression,statement):pass(pushlex("stat"),expression,expect(";"),poplex)}function maybeCatchBinding(t){if("("==t)return cont(funarg,expect(")"))}function expression(t,r){return expressionInner(t,r,!1)}function expressionNoComma(t,r){return expressionInner(t,r,!0)}function parenExpr(t){return"("!=t?pass():cont(pushlex(")"),maybeexpression,expect(")"),poplex)}function expressionInner(t,r,a){if(Q.state.fatArrowAt==Q.stream.start){var l=a?arrowBodyNoComma:arrowBody;if("("==t)return cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,expect("=>"),l,popcontext);if("variable"==t)return pass(pushcontext,pattern,expect("=>"),l,popcontext)}var S=a?maybeoperatorNoComma:maybeoperatorComma;return Z.hasOwnProperty(t)?cont(S):"function"==t?cont(functiondef,S):"class"==t||B&&"interface"==r?(Q.marked="keyword",cont(pushlex("form"),classExpression,poplex)):"keyword c"==t||"async"==t?cont(a?expressionNoComma:expression):"("==t?cont(pushlex(")"),maybeexpression,expect(")"),poplex,S):"operator"==t||"spread"==t?cont(a?expressionNoComma:expression):"["==t?cont(pushlex("]"),arrayLiteral,poplex,S):"{"==t?contCommasep(objprop,"}",null,S):"quasi"==t?pass(quasi,S):"new"==t?cont(function maybeTarget(t){return function(r){return"."==r?cont(t?targetNoComma:target):"variable"==r&&B?cont(maybeTypeArgs,t?maybeoperatorNoComma:maybeoperatorComma):pass(t?expressionNoComma:expression)}}(a)):cont()}function maybeexpression(t){return t.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeoperatorComma(t,r){return","==t?cont(maybeexpression):maybeoperatorNoComma(t,r,!1)}function maybeoperatorNoComma(t,r,a){var l=0==a?maybeoperatorComma:maybeoperatorNoComma,S=0==a?expression:expressionNoComma;return"=>"==t?cont(pushcontext,a?arrowBodyNoComma:arrowBody,popcontext):"operator"==t?/\+\+|--/.test(r)||B&&"!"==r?cont(l):B&&"<"==r&&Q.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?cont(pushlex(">"),commasep(typeexpr,">"),poplex,l):"?"==r?cont(expression,expect(":"),S):cont(S):"quasi"==t?pass(quasi,l):";"!=t?"("==t?contCommasep(expressionNoComma,")","call",l):"."==t?cont(property,l):"["==t?cont(pushlex("]"),maybeexpression,expect("]"),poplex,l):B&&"as"==r?(Q.marked="keyword",cont(typeexpr,l)):"regexp"==t?(Q.state.lastType=Q.marked="operator",Q.stream.backUp(Q.stream.pos-Q.stream.start-1),cont(S)):void 0:void 0}function quasi(t,r){return"quasi"!=t?pass():"${"!=r.slice(r.length-2)?cont(quasi):cont(expression,continueQuasi)}function continueQuasi(t){if("}"==t)return Q.marked="string-2",Q.state.tokenize=tokenQuasi,cont(quasi)}function arrowBody(t){return findFatArrow(Q.stream,Q.state),pass("{"==t?statement:expression)}function arrowBodyNoComma(t){return findFatArrow(Q.stream,Q.state),pass("{"==t?statement:expressionNoComma)}function target(t,r){if("target"==r)return Q.marked="keyword",cont(maybeoperatorComma)}function targetNoComma(t,r){if("target"==r)return Q.marked="keyword",cont(maybeoperatorNoComma)}function maybelabel(t){return":"==t?cont(poplex,statement):pass(maybeoperatorComma,expect(";"),poplex)}function property(t){if("variable"==t)return Q.marked="property",cont()}function objprop(t,r){return"async"==t?(Q.marked="property",cont(objprop)):"variable"==t||"keyword"==Q.style?(Q.marked="property","get"==r||"set"==r?cont(getterSetter):(B&&Q.state.fatArrowAt==Q.stream.start&&(a=Q.stream.match(/^\s*:\s*/,!1))&&(Q.state.fatArrowAt=Q.stream.pos+a[0].length),cont(afterprop))):"number"==t||"string"==t?(Q.marked=E?"property":Q.style+" property",cont(afterprop)):"jsonld-keyword"==t?cont(afterprop):B&&isModifier(r)?(Q.marked="keyword",cont(objprop)):"["==t?cont(expression,maybetype,expect("]"),afterprop):"spread"==t?cont(expressionNoComma,afterprop):"*"==r?(Q.marked="keyword",cont(objprop)):":"==t?pass(afterprop):void 0;var a}function getterSetter(t){return"variable"!=t?pass(afterprop):(Q.marked="property",cont(functiondef))}function afterprop(t){return":"==t?cont(expressionNoComma):"("==t?pass(functiondef):void 0}function commasep(t,r,a){function proceed(l,S){if(a?a.indexOf(l)>-1:","==l){var O=Q.state.lexical;return"call"==O.info&&(O.pos=(O.pos||0)+1),cont((function(a,l){return a==r||l==r?pass():pass(t)}),proceed)}return l==r||S==r?cont():a&&a.indexOf(";")>-1?pass(t):cont(expect(r))}return function(a,l){return a==r||l==r?cont():pass(t,proceed)}}function contCommasep(t,r,a){for(var l=3;l<arguments.length;l++)Q.cc.push(arguments[l]);return cont(pushlex(r,a),commasep(t,r),poplex)}function block(t){return"}"==t?cont():pass(statement,block)}function maybetype(t,r){if(B){if(":"==t)return cont(typeexpr);if("?"==r)return cont(maybetype)}}function maybetypeOrIn(t,r){if(B&&(":"==t||"in"==r))return cont(typeexpr)}function mayberettype(t){if(B&&":"==t)return Q.stream.match(/^\s*\w+\s+is\b/,!1)?cont(expression,isKW,typeexpr):cont(typeexpr)}function isKW(t,r){if("is"==r)return Q.marked="keyword",cont()}function typeexpr(t,r){return"keyof"==r||"typeof"==r||"infer"==r||"readonly"==r?(Q.marked="keyword",cont("typeof"==r?expressionNoComma:typeexpr)):"variable"==t||"void"==r?(Q.marked="type",cont(afterType)):"|"==r||"&"==r?cont(typeexpr):"string"==t||"number"==t||"atom"==t?cont(afterType):"["==t?cont(pushlex("]"),commasep(typeexpr,"]",","),poplex,afterType):"{"==t?cont(pushlex("}"),typeprops,poplex,afterType):"("==t?cont(commasep(typearg,")"),maybeReturnType,afterType):"<"==t?cont(commasep(typeexpr,">"),typeexpr):void 0}function maybeReturnType(t){if("=>"==t)return cont(typeexpr)}function typeprops(t){return t.match(/[\}\)\]]/)?cont():","==t||";"==t?cont(typeprops):pass(typeprop,typeprops)}function typeprop(t,r){return"variable"==t||"keyword"==Q.style?(Q.marked="property",cont(typeprop)):"?"==r||"number"==t||"string"==t?cont(typeprop):":"==t?cont(typeexpr):"["==t?cont(expect("variable"),maybetypeOrIn,expect("]"),typeprop):"("==t?pass(functiondecl,typeprop):t.match(/[;\}\)\],]/)?void 0:cont()}function typearg(t,r){return"variable"==t&&Q.stream.match(/^\s*[?:]/,!1)||"?"==r?cont(typearg):":"==t?cont(typeexpr):"spread"==t?cont(typearg):pass(typeexpr)}function afterType(t,r){return"<"==r?cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType):"|"==r||"."==t||"&"==r?cont(typeexpr):"["==t?cont(typeexpr,expect("]"),afterType):"extends"==r||"implements"==r?(Q.marked="keyword",cont(typeexpr)):"?"==r?cont(typeexpr,expect(":"),typeexpr):void 0}function maybeTypeArgs(t,r){if("<"==r)return cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType)}function typeparam(){return pass(typeexpr,maybeTypeDefault)}function maybeTypeDefault(t,r){if("="==r)return cont(typeexpr)}function vardef(t,r){return"enum"==r?(Q.marked="keyword",cont(enumdef)):pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(t,r){return B&&isModifier(r)?(Q.marked="keyword",cont(pattern)):"variable"==t?(register(r),cont()):"spread"==t?cont(pattern):"["==t?contCommasep(eltpattern,"]"):"{"==t?contCommasep(proppattern,"}"):void 0}function proppattern(t,r){return"variable"!=t||Q.stream.match(/^\s*:/,!1)?("variable"==t&&(Q.marked="property"),"spread"==t?cont(pattern):"}"==t?pass():"["==t?cont(expression,expect("]"),expect(":"),proppattern):cont(expect(":"),pattern,maybeAssign)):(register(r),cont(maybeAssign))}function eltpattern(){return pass(pattern,maybeAssign)}function maybeAssign(t,r){if("="==r)return cont(expressionNoComma)}function vardefCont(t){if(","==t)return cont(vardef)}function maybeelse(t,r){if("keyword b"==t&&"else"==r)return cont(pushlex("form","else"),statement,poplex)}function forspec(t,r){return"await"==r?cont(forspec):"("==t?cont(pushlex(")"),forspec1,poplex):void 0}function forspec1(t){return"var"==t?cont(vardef,forspec2):"variable"==t?cont(forspec2):pass(forspec2)}function forspec2(t,r){return")"==t?cont():";"==t?cont(forspec2):"in"==r||"of"==r?(Q.marked="keyword",cont(expression,forspec2)):pass(expression,forspec2)}function functiondef(t,r){return"*"==r?(Q.marked="keyword",cont(functiondef)):"variable"==t?(register(r),cont(functiondef)):"("==t?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,statement,popcontext):B&&"<"==r?cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondef):void 0}function functiondecl(t,r){return"*"==r?(Q.marked="keyword",cont(functiondecl)):"variable"==t?(register(r),cont(functiondecl)):"("==t?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,popcontext):B&&"<"==r?cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondecl):void 0}function typename(t,r){return"keyword"==t||"variable"==t?(Q.marked="type",cont(typename)):"<"==r?cont(pushlex(">"),commasep(typeparam,">"),poplex):void 0}function funarg(t,r){return"@"==r&&cont(expression,funarg),"spread"==t?cont(funarg):B&&isModifier(r)?(Q.marked="keyword",cont(funarg)):B&&"this"==t?cont(maybetype,maybeAssign):pass(pattern,maybetype,maybeAssign)}function classExpression(t,r){return"variable"==t?className(t,r):classNameAfter(t,r)}function className(t,r){if("variable"==t)return register(r),cont(classNameAfter)}function classNameAfter(t,r){return"<"==r?cont(pushlex(">"),commasep(typeparam,">"),poplex,classNameAfter):"extends"==r||"implements"==r||B&&","==t?("implements"==r&&(Q.marked="keyword"),cont(B?typeexpr:expression,classNameAfter)):"{"==t?cont(pushlex("}"),classBody,poplex):void 0}function classBody(t,r){return"async"==t||"variable"==t&&("static"==r||"get"==r||"set"==r||B&&isModifier(r))&&Q.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(Q.marked="keyword",cont(classBody)):"variable"==t||"keyword"==Q.style?(Q.marked="property",cont(classfield,classBody)):"number"==t||"string"==t?cont(classfield,classBody):"["==t?cont(expression,maybetype,expect("]"),classfield,classBody):"*"==r?(Q.marked="keyword",cont(classBody)):B&&"("==t?pass(functiondecl,classBody):";"==t||","==t?cont(classBody):"}"==t?cont():"@"==r?cont(expression,classBody):void 0}function classfield(t,r){if("?"==r)return cont(classfield);if(":"==t)return cont(typeexpr,maybeAssign);if("="==r)return cont(expressionNoComma);var a=Q.state.lexical.prev;return pass(a&&"interface"==a.info?functiondecl:functiondef)}function afterExport(t,r){return"*"==r?(Q.marked="keyword",cont(maybeFrom,expect(";"))):"default"==r?(Q.marked="keyword",cont(expression,expect(";"))):"{"==t?cont(commasep(exportField,"}"),maybeFrom,expect(";")):pass(statement)}function exportField(t,r){return"as"==r?(Q.marked="keyword",cont(expect("variable"))):"variable"==t?pass(expressionNoComma,exportField):void 0}function afterImport(t){return"string"==t?cont():"("==t?pass(expression):"."==t?pass(maybeoperatorComma):pass(importSpec,maybeMoreImports,maybeFrom)}function importSpec(t,r){return"{"==t?contCommasep(importSpec,"}"):("variable"==t&&register(r),"*"==r&&(Q.marked="keyword"),cont(maybeAs))}function maybeMoreImports(t){if(","==t)return cont(importSpec,maybeMoreImports)}function maybeAs(t,r){if("as"==r)return Q.marked="keyword",cont(importSpec)}function maybeFrom(t,r){if("from"==r)return Q.marked="keyword",cont(expression)}function arrayLiteral(t){return"]"==t?cont():pass(commasep(expressionNoComma,"]"))}function enumdef(){return pass(pushlex("form"),pattern,expect("{"),pushlex("}"),commasep(enummember,"}"),poplex,poplex)}function enummember(){return pass(pattern,maybeAssign)}function expressionAllowed(t,r,a){return r.tokenize==tokenBase&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(r.lastType)||"quasi"==r.lastType&&/\{\s*$/.test(t.string.slice(0,t.pos-(a||0)))}return popcontext.lex=!0,poplex.lex=!0,{startState:function(t){var r={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((t||0)-O,0,"block",!1),localVars:a.localVars,context:a.localVars&&new Context(null,null,!1),indented:t||0};return a.globalVars&&"object"==typeof a.globalVars&&(r.globalVars=a.globalVars),r},token:function(t,r){if(t.sol()&&(r.lexical.hasOwnProperty("align")||(r.lexical.align=!1),r.indented=t.indentation(),findFatArrow(t,r)),r.tokenize!=tokenComment&&t.eatSpace())return null;var a=r.tokenize(t,r);return"comment"==l?a:(r.lastType="operator"!=l||"++"!=S&&"--"!=S?l:"incdec",function parseJS(t,r,a,l,S){var O=t.cc;for(Q.state=t,Q.stream=S,Q.marked=null,Q.cc=O,Q.style=r,t.lexical.hasOwnProperty("align")||(t.lexical.align=!0);;)if((O.length?O.pop():D?expression:statement)(a,l)){for(;O.length&&O[O.length-1].lex;)O.pop()();return Q.marked?Q.marked:"variable"==a&&inScope(t,l)?"variable-2":r}}(r,a,l,S,t))},indent:function(r,l){if(r.tokenize==tokenComment||r.tokenize==tokenQuasi)return t.Pass;if(r.tokenize!=tokenBase)return 0;var S,E=l&&l.charAt(0),D=r.lexical;if(!/^\s*else\b/.test(l))for(var j=r.cc.length-1;j>=0;--j){var B=r.cc[j];if(B==poplex)D=D.prev;else if(B!=maybeelse&&B!=popcontext)break}for(;("stat"==D.type||"form"==D.type)&&("}"==E||(S=r.cc[r.cc.length-1])&&(S==maybeoperatorComma||S==maybeoperatorNoComma)&&!/^[,\.=+\-*:?[\(]/.test(l));)D=D.prev;L&&")"==D.type&&"stat"==D.prev.type&&(D=D.prev);var q=D.type,G=E==q;return"vardef"==q?D.indented+("operator"==r.lastType||","==r.lastType?D.info.length+1:0):"form"==q&&"{"==E?D.indented:"form"==q?D.indented+O:"stat"==q?D.indented+(function isContinuedStatement(t,r){return"operator"==t.lastType||","==t.lastType||X.test(r.charAt(0))||/[,.]/.test(r.charAt(0))}(r,l)?L||O:0):"switch"!=D.info||G||0==a.doubleIndentSwitch?D.align?D.column+(G?0:1):D.indented+(G?0:O):D.indented+(/^(?:case|default)\b/.test(l)?O:2*O)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:D?null:"/*",blockCommentEnd:D?null:"*/",blockCommentContinue:D?null:" * ",lineComment:D?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:D?"json":"javascript",jsonldMode:E,jsonMode:D,expressionAllowed:expressionAllowed,skipExpression:function(t){var r=t.cc[t.cc.length-1];r!=expression&&r!=expressionNoComma||t.cc.pop()}}})),t.registerHelper("wordChars","javascript",/[\w$]/),t.defineMIME("text/javascript","javascript"),t.defineMIME("text/ecmascript","javascript"),t.defineMIME("application/javascript","javascript"),t.defineMIME("application/x-javascript","javascript"),t.defineMIME("application/ecmascript","javascript"),t.defineMIME("application/json",{name:"javascript",json:!0}),t.defineMIME("application/x-json",{name:"javascript",json:!0}),t.defineMIME("application/manifest+json",{name:"javascript",json:!0}),t.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),t.defineMIME("text/typescript",{name:"javascript",typescript:!0}),t.defineMIME("application/typescript",{name:"javascript",typescript:!0})}(a(307))},338:function(t,r,a){"use strict";a.d(r,"d",(function(){return define})),a.d(r,"b",(function(){return addLocalDependency})),a.d(r,"a",(function(){return addAsyncDependency}));var l=a(2);function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function safeGet(t,r){return r.split(".").reduce((function(t,r){return t&&t[r]}),t)}function isFunction(t){return"function"==typeof t}function loadDep(t,r){if(D.shim[t])return function loadByShim(t,r){var a=D.shim[t];return _require(a.deps||[],(function(){return loadScript(t).then(a.exportsFn||function(){return a.init&&a.init()||safeGet(window,a.exports)})}),null,r)}(t,r);var a=function defer(){var t={};return t.promise=new l.default((function(r,a){t.resolve=r,t.reject=a})),t}();return a.name=t,a.path=r,function invokeLater(t,r){function cleanup(){B=null}j=j.then((function(){return B=t,r()})).then(cleanup,cleanup)}(a,(function(){return loadScript(t).then((function(){setTimeout(a.resolve,100)})).catch((function(){a.reject(new Error('Error while loading module "'+t+'"'))}))})),a.promise}function loadScript(t){return new l.default((function(r,a){var l=_require2.load(null,t,toUrl(t,!0));l.onerror=a,l.onload=r}))}var S=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,O=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g;function _require(t,r,a,S){var O=S.slice(-1)[0];return new l.default((function(r,a){l.default.all(t.map((function(t){if(S.indexOf(t)>-1)return l.default.reject(new Error("Circular dependency: "+S.concat(t).join(" -> ")));var r=S.concat(t);return q[t]?q[t](O):(t.indexOf("!")>-1&&(L[t]=function loadWithPlugin(t,r){var a=t.indexOf("!"),S=t.substr(0,a);return t=t.substr(a+1),_require([S],(function(a){return new l.default((function(l,S){function localRequire(){if(!O)return _require2.apply(null,arguments)}Object.keys(_require2).forEach((function(t){localRequire[t]=_require2[t]}));var O=!1;l.error=S,l.fromText=function(t,a){a||(a=t);var L=B;B={name:t,resolve:l,reject:S,path:r},new Function(a)(),B=L,O=!0},a.load(t,localRequire,l,D)}))}),null,r)}(t,r)),E[t]?L[t]=l.default.resolve().then((function(){return _require.apply(null,E[t].concat([r]))})):L[t]||(G[t]?L[t]=G[t]():L[t]=loadDep(t,r)),L[t])}))).then(r,a)})).then((function(t){if(isFunction(r)){var a=r.apply(null,t);return O&&safeGet(L[O],"module.exports")||a}return r}),(function(t){return isFunction(a)&&a(t),_require2.onError(t),l.default.reject(t)}))}function _require2(t,r,a){return _require(t,r,a,[])}var L,E,D,j,B,q={require:function require(t){return _require2},module:function module(t){var module=L[t];if(!module)throw new Error('Module "module" should be required only by modules');return module.module=module.module||{id:t,config:function config(){return D.config[t]||{}}}},exports:function exports(t){return q.module(t).exports={}}};function toUrl(t,r){var a=Object.keys(D.bundles).filter((function(r){return D.bundles[r].indexOf(t)>-1}))[0];return a?_require2.toUrl(a):(D.paths[t]&&(t=D.paths[t]),/^([\w\+\.\-]+:)?\//.test(t)||(t=D.baseUrl+t),r&&t.indexOf(".js")<0&&(t+=".js"),D.urlArgs&&(t+="?"+D.urlArgs),t)}function define(t,r,a){"string"!=typeof t&&(a=r,r=t,t=null),Array.isArray(r)||(a=r,r=[]);var l=B;if(null===t&&!l)throw new Error("Unexpected define!");if(0===r.length&&a.length>0){var L=function wrapCommonJS(t,r){var a=[];return r.toString().replace(S,"").replace(O,(function(t,r){a.push(r)})),{deps:a,factory:function factory(){var l=arguments,S=a.reduce((function(t,r,a){return t[r]=l[a],t}),{});return r((function localRequire(t){if(!S[t])throw new Error('Module "'+a+'" has not been loaded yet');return S[t]}),q.module(t),q.exports(t))}}}(t||l.name,a);r=L.deps,a=L.factory}if(null===t||l&&l.name===t){var D=_require(r,a,l.reject,l.path);l.resolve(D)}else E[t]=[r,a,null]}function addLocalDependency(t,r){L[t]||(L[t]=r)}_require2.resetContext=function(){D={urlArgs:"",baseUrl:"./",paths:{},shim:{},bundles:{},config:{}},L={},E={},j=l.default.resolve(),B=null},_require2.config=function(t){D=function deepmerge(t,r){var a=Array.isArray(r),l=a&&[]||{};return a?(t=t||[],l=l.concat(t),r.forEach((function(r,a){void 0===l[a]?l[a]=r:"object"===_typeof(r)?l[a]=deepmerge(t[a],r):-1===t.indexOf(r)&&l.push(r)}))):(t&&"object"===_typeof(t)&&Object.keys(t).forEach((function(r){l[r]=t[r]})),Object.keys(r).forEach((function(a){"object"===_typeof(r[a])&&r[a]&&t[a]?l[a]=deepmerge(t[a],r[a]):l[a]=r[a]}))),l}(D,t)},_require2.load=function(t,r,a){var l=document.createElement("script");return l.src=a,l.async=!0,document.getElementsByTagName("body")[0].appendChild(l),l},_require2.toUrl=function(t){return toUrl(t,!1)},_require2.specified=function(t){return L.hasOwnProperty(t)},_require2.onError=function(t){console.error(t)},_require2.resetContext();var G={};function addAsyncDependency(t,r){G[t]||(G[t]=r)}r.c=_require2},343:function(t,r,a){"use strict";a.d(r,"a",(function(){return D}));var l=a(131);function _defineProperties(t,r){for(var a=0;a<r.length;a++){var l=r[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}var S=[],O=new MutationObserver((function onMutation(){E||(E=!0,requestAnimationFrame((function(){E=!1,S.forEach((function(t){return t.checkVisibility()}))})))})),L=new Set,E=!1,D=function(){function VisibilityChangeObserver(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,VisibilityChangeObserver),this.isActive=!1,this.isVisible=!1,this.element=t,this.onVisibilityChange=r}return function _createClass(t,r,a){return r&&_defineProperties(t.prototype,r),a&&_defineProperties(t,a),t}(VisibilityChangeObserver,[{key:"start",value:function start(){this.isActive||(this.isActive=!0,this.isVisible=l.b.isElementVisible(this.element),S.push(this),observeElementAndAncestors(this.element))}},{key:"stop",value:function stop(){this.isActive&&(this.isActive=!1,S.splice(S.indexOf(this),1),function resetMutationObserver(){O.disconnect(),L.clear(),S.forEach((function(t){return observeElementAndAncestors(t.element)})),L.forEach((function(t){return observeElement(t)}))}())}},{key:"checkVisibility",value:function checkVisibility(){if(this.isActive){var t=l.b.isElementVisible(this.element);this.isVisible!==t&&(this.isVisible=t,this.onVisibilityChange(t))}}}]),VisibilityChangeObserver}();function observeElementAndAncestors(t){for(;t&&!L.has(t);)observeElement(t),L.add(t),t=t.parentElement}function observeElement(t){O.observe(t,{attributes:!0,attributeFilter:["id","style","class"]})}},408:function(t,r,a){"use strict";a.d(r,"a",(function(){return getFullScreenElement}));a(1),a(7);function getFullScreenElement(){for(var t=["fullscreenElement","webkitFullscreenElement","msFullscreenElement","mozFullScreenElement"],r=0;r<t.length;r++){var a=document[t[r]];if(a)return a}return null}},415:function(t,r,a){"use strict";var l=a(5),S=a.n(l),O=a(0),L=a.n(O),E=(a(1),"stopped"),D="running",j="paused";r.a=S.a.View.extend({state:E,currentLength:void 0,length:5,direction:"down",template:null,showMinutes:!1,initialize:function initialize(){this.template=this.options.labels.counterTemplate,this.options.hasOwnProperty("length")&&(this.length=this.options.length),this.options.hasOwnProperty("direction")&&(this.direction=this.options.direction),this.options.hasOwnProperty("template")&&(this.template=this.options.template),this.options.hasOwnProperty("show_minutes")&&(this.showMinutes=this.options.show_minutes),this.resetCurrentLength(),this.render()},render:function render(){return this.$el.html(this.template.replace("{num}",'<span class="lrn_counterNumber"></span>')),this.counterNumber=this.$(".lrn_counterNumber"),this.setCounterDisplay(this.currentLength),this},counter:function counter(t){this.currentLength=t,this.setCounterDisplay(this.currentLength),"up"===this.direction&&t<this.length||"down"===this.direction&&t>0?this.timerId=L.a.delay(L.a.bind(this.counter,this),1e3,"up"===this.direction?t+1:t-1):(this.timerId=null,this.resetCurrentLength(),this.trigger("complete"))},setCounterDisplay:function setCounterDisplay(t){var r,a,l;this.showMinutes?(a=String(Math.floor(this.currentLength/60)),l=String(this.currentLength%60),r=(a=a.length>1?a:"0"+a)+":"+(l=l.length>1?l:"0"+l)):r=this.currentLength,this.counterNumber.html(r)},begin:function begin(){this.trigger("begin"),this.counter(this.currentLength),this.state=D},pause:function pause(){clearTimeout(this.timerId),this.timerId=null,this.state=j},stop:function stop(){clearTimeout(this.timerId),this.timerId=null,this.resetCurrentLength(),this.state=E},resetCurrentLength:function resetCurrentLength(){this.currentLength="up"===this.direction?0:this.length},isRunning:function isRunning(){return this.state===D},isStopped:function isStopped(){return this.state===E},isPaused:function isPaused(){return this.state===j}})},457:function(t,r,a){"use strict";var l,S,O,L;if("object"==typeof performance&&"function"==typeof performance.now){var E=performance;r.unstable_now=function(){return E.now()}}else{var D=Date,j=D.now();r.unstable_now=function(){return D.now()-j}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var B=null,q=null,w=function(){if(null!==B)try{var t=r.unstable_now();B(!0,t),B=null}catch(t){throw setTimeout(w,0),t}};l=function(t){null!==B?setTimeout(l,0,t):(B=t,setTimeout(w,0))},S=function(t,r){q=setTimeout(t,r)},O=function(){clearTimeout(q)},r.unstable_shouldYield=function(){return!1},L=r.unstable_forceFrameRate=function(){}}else{var G=window.setTimeout,X=window.clearTimeout;if("undefined"!=typeof console){var $=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof $&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var Z=!1,Q=null,ee=-1,te=5,ne=0;r.unstable_shouldYield=function(){return r.unstable_now()>=ne},L=function(){},r.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<t?Math.floor(1e3/t):5};var re=new MessageChannel,oe=re.port2;re.port1.onmessage=function(){if(null!==Q){var t=r.unstable_now();ne=t+te;try{Q(!0,t)?oe.postMessage(null):(Z=!1,Q=null)}catch(t){throw oe.postMessage(null),t}}else Z=!1},l=function(t){Q=t,Z||(Z=!0,oe.postMessage(null))},S=function(t,a){ee=G((function(){t(r.unstable_now())}),a)},O=function(){X(ee),ee=-1}}function H(t,r){var a=t.length;t.push(r);e:for(;;){var l=a-1>>>1,S=t[l];if(!(void 0!==S&&0<I(S,r)))break e;t[l]=r,t[a]=S,a=l}}function J(t){return void 0===(t=t[0])?null:t}function K(t){var r=t[0];if(void 0!==r){var a=t.pop();if(a!==r){t[0]=a;e:for(var l=0,S=t.length;l<S;){var O=2*(l+1)-1,L=t[O],E=O+1,D=t[E];if(void 0!==L&&0>I(L,a))void 0!==D&&0>I(D,L)?(t[l]=D,t[E]=a,l=E):(t[l]=L,t[O]=a,l=O);else{if(!(void 0!==D&&0>I(D,a)))break e;t[l]=D,t[E]=a,l=E}}}return r}return null}function I(t,r){var a=t.sortIndex-r.sortIndex;return 0!==a?a:t.id-r.id}var ie=[],ae=[],se=1,le=null,ce=3,ue=!1,pe=!1,de=!1;function T(t){for(var r=J(ae);null!==r;){if(null===r.callback)K(ae);else{if(!(r.startTime<=t))break;K(ae),r.sortIndex=r.expirationTime,H(ie,r)}r=J(ae)}}function U(t){if(de=!1,T(t),!pe)if(null!==J(ie))pe=!0,l(V);else{var r=J(ae);null!==r&&S(U,r.startTime-t)}}function V(t,a){pe=!1,de&&(de=!1,O()),ue=!0;var l=ce;try{for(T(a),le=J(ie);null!==le&&(!(le.expirationTime>a)||t&&!r.unstable_shouldYield());){var L=le.callback;if("function"==typeof L){le.callback=null,ce=le.priorityLevel;var E=L(le.expirationTime<=a);a=r.unstable_now(),"function"==typeof E?le.callback=E:le===J(ie)&&K(ie),T(a)}else K(ie);le=J(ie)}if(null!==le)var D=!0;else{var j=J(ae);null!==j&&S(U,j.startTime-a),D=!1}return D}finally{le=null,ce=l,ue=!1}}var fe=L;r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(t){t.callback=null},r.unstable_continueExecution=function(){pe||ue||(pe=!0,l(V))},r.unstable_getCurrentPriorityLevel=function(){return ce},r.unstable_getFirstCallbackNode=function(){return J(ie)},r.unstable_next=function(t){switch(ce){case 1:case 2:case 3:var r=3;break;default:r=ce}var a=ce;ce=r;try{return t()}finally{ce=a}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=fe,r.unstable_runWithPriority=function(t,r){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var a=ce;ce=t;try{return r()}finally{ce=a}},r.unstable_scheduleCallback=function(t,a,L){var E=r.unstable_now();switch("object"==typeof L&&null!==L?L="number"==typeof(L=L.delay)&&0<L?E+L:E:L=E,t){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return t={id:se++,callback:a,priorityLevel:t,startTime:L,expirationTime:D=L+D,sortIndex:-1},L>E?(t.sortIndex=L,H(ae,t),null===J(ie)&&t===J(ae)&&(de?O():de=!0,S(U,L-E))):(t.sortIndex=D,H(ie,t),pe||ue||(pe=!0,l(V))),t},r.unstable_wrapCallback=function(t){var r=ce;return function(){var a=ce;ce=r;try{return t.apply(this,arguments)}finally{ce=a}}}},510:function(t,r,a){var l;void 0===(l=function(){var t=function(){var r,a,l,S,O,L,E="undefined",D="object",j="Shockwave Flash",B="application/x-shockwave-flash",q="SWFObjectExprInst",G="onreadystatechange",X=window,$=document,Z=navigator,Q=!1,ee=[],te=[],ne=[],re=[],oe=!1,ie=!1,ae=!0,se=!1,le=function(){var t=typeof $.getElementById!=E&&typeof $.getElementsByTagName!=E&&typeof $.createElement!=E,r=Z.userAgent.toLowerCase(),a=Z.platform.toLowerCase(),l=/win/.test(a||r),S=/mac/.test(a||r),O=!!/webkit/.test(r)&&parseFloat(r.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),L="Microsoft Internet Explorer"===Z.appName,q=[0,0,0],G=null;if(typeof Z.plugins!=E&&typeof Z.plugins[j]==D)(G=Z.plugins[j].description)&&typeof Z.mimeTypes!=E&&Z.mimeTypes[B]&&Z.mimeTypes[B].enabledPlugin&&(Q=!0,L=!1,G=G.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),q[0]=n(G.replace(/^(.*)\..*$/,"$1")),q[1]=n(G.replace(/^.*\.(.*)\s.*$/,"$1")),q[2]=/[a-zA-Z]/.test(G)?n(G.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof X.ActiveXObject!=E)try{var ee=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");ee&&(G=ee.GetVariable("$version"))&&(L=!0,q=[n((G=G.split(" ")[1].split(","))[0]),n(G[1]),n(G[2])])}catch(t){}return{w3:t,pv:q,wk:O,ie:L,win:l,mac:S}}();le.w3&&((typeof $.readyState!=E&&("complete"===$.readyState||"interactive"===$.readyState)||typeof $.readyState==E&&($.getElementsByTagName("body")[0]||$.body))&&f(),oe||(typeof $.addEventListener!=E&&$.addEventListener("DOMContentLoaded",f,!1),le.ie&&($.attachEvent(G,(function aa(){"complete"==$.readyState&&($.detachEvent(G,aa),f())})),X==top&&function ac(){if(!oe){try{$.documentElement.doScroll("left")}catch(t){return void setTimeout(ac,0)}f()}}()),le.wk&&function ab(){oe||(/loaded|complete/.test($.readyState)?f():setTimeout(ab,0))}()));function f(){if(!oe&&document.getElementsByTagName("body")[0]){try{var t,r=C("span");r.style.display="none",(t=$.getElementsByTagName("body")[0].appendChild(r)).parentNode.removeChild(t),t=null,r=null}catch(t){return}oe=!0;for(var a=ee.length,l=0;l<a;l++)ee[l]()}}function M(t){oe?t():ee[ee.length]=t}function H(){var t=te.length;if(t>0)for(var r=0;r<t;r++){var a=te[r].id,l=te[r].callbackFn,S={success:!1,id:a};if(le.pv[0]>0){var O=c(a);if(O)if(!F(te[r].swfVersion)||le.wk&&le.wk<312)if(te[r].expressInstall&&A()){var L={};L.data=te[r].expressInstall,L.width=O.getAttribute("width")||"0",L.height=O.getAttribute("height")||"0",O.getAttribute("class")&&(L.styleclass=O.getAttribute("class")),O.getAttribute("align")&&(L.align=O.getAttribute("align"));for(var D={},j=O.getElementsByTagName("param"),B=j.length,q=0;q<B;q++)"movie"!=j[q].getAttribute("name").toLowerCase()&&(D[j[q].getAttribute("name")]=j[q].getAttribute("value"));R(L,D,a,l)}else b(O),l&&l(S);else w(a,!0),l&&(S.success=!0,S.ref=z(a),S.id=a,l(S))}else if(w(a,!0),l){var G=z(a);G&&typeof G.SetVariable!=E&&(S.success=!0,S.ref=G,S.id=G.id),l(S)}}}function z(t){var r=null,a=c(t);return a&&"OBJECT"===a.nodeName.toUpperCase()&&(r=typeof a.SetVariable!==E?a:a.getElementsByTagName(D)[0]||a),r}function A(){return!ie&&F("6.0.65")&&(le.win||le.mac)&&!(le.wk&&le.wk<312)}function R(t,O,L,D){var j=c(L);if(L=W(L),ie=!0,l=D||null,S={success:!1,id:L},j){"OBJECT"==j.nodeName.toUpperCase()?(r=J(j),a=null):(r=j,a=L),t.id=q,(typeof t.width==E||!/%$/.test(t.width)&&n(t.width)<310)&&(t.width="310"),(typeof t.height==E||!/%$/.test(t.height)&&n(t.height)<137)&&(t.height="137");var B=le.ie?"ActiveX":"PlugIn",G="MMredirectURL="+encodeURIComponent(X.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+B+"&MMdoctitle="+encodeURIComponent($.title.slice(0,47)+" - Flash Player Installation");if(typeof O.flashvars!=E?O.flashvars+="&"+G:O.flashvars=G,le.ie&&4!=j.readyState){var Z=C("div");L+="SWFObjectNew",Z.setAttribute("id",L),j.parentNode.insertBefore(Z,j),j.style.display="none",y(j)}u(t,O,L)}}function b(t){if(le.ie&&4!=t.readyState){t.style.display="none";var r=C("div");t.parentNode.insertBefore(r,t),r.parentNode.replaceChild(J(t),r),y(t)}else t.parentNode.replaceChild(J(t),t)}function J(t){var r=C("div");if(le.win&&le.ie)r.innerHTML=t.innerHTML;else{var a=t.getElementsByTagName(D)[0];if(a){var l=a.childNodes;if(l)for(var S=l.length,O=0;O<S;O++)1==l[O].nodeType&&"PARAM"==l[O].nodeName||8==l[O].nodeType||r.appendChild(l[O].cloneNode(!0))}}return r}function u(t,r,a){var l,S=c(a);if(a=W(a),le.wk&&le.wk<312)return l;if(S){var O,L,j,q=le.ie?C("div"):C(D);for(j in typeof t.id==E&&(t.id=a),r)r.hasOwnProperty(j)&&"movie"!==j.toLowerCase()&&e(q,j,r[j]);for(O in le.ie&&(q=function k(t,r){var a=C("div");return a.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+t+"'>"+r+"</object>",a.firstChild}(t.data,q.innerHTML)),t)t.hasOwnProperty(O)&&("styleclass"===(L=O.toLowerCase())?q.setAttribute("class",t[O]):"classid"!==L&&"data"!==L&&q.setAttribute(O,t[O]));le.ie?ne[ne.length]=t.id:(q.setAttribute("type",B),q.setAttribute("data",t.data)),S.parentNode.replaceChild(q,S),l=q}return l}function e(t,r,a){var l=C("param");l.setAttribute("name",r),l.setAttribute("value",a),t.appendChild(l)}function y(t){var r=c(t);r&&"OBJECT"==r.nodeName.toUpperCase()&&(le.ie?(r.style.display="none",function aa(){if(4==r.readyState){for(var t in r)"function"==typeof r[t]&&(r[t]=null);r.parentNode.removeChild(r)}else setTimeout(aa,10)}()):r.parentNode.removeChild(r))}function U(t){return t&&t.nodeType&&1===t.nodeType}function W(t){return U(t)?t.id:t}function c(t){if(U(t))return t;var r=null;try{r=$.getElementById(t)}catch(t){}return r}function C(t){return $.createElement(t)}function n(t){return parseInt(t,10)}function F(t){t+="";var r=le.pv,a=t.split(".");return a[0]=n(a[0]),a[1]=n(a[1])||0,a[2]=n(a[2])||0,r[0]>a[0]||r[0]==a[0]&&r[1]>a[1]||r[0]==a[0]&&r[1]==a[1]&&r[2]>=a[2]}function v(t,r,a,l){var S=$.getElementsByTagName("head")[0];if(S){var D="string"==typeof a?a:"screen";if(l&&(O=null,L=null),!O||L!=D){var j=C("style");j.setAttribute("type","text/css"),j.setAttribute("media",D),O=S.appendChild(j),le.ie&&typeof $.styleSheets!=E&&$.styleSheets.length>0&&(O=$.styleSheets[$.styleSheets.length-1]),L=D}O&&(typeof O.addRule!=E?O.addRule(t,r):typeof $.createTextNode!=E&&O.appendChild($.createTextNode(t+" {"+r+"}")))}}function w(t,r){if(ae){var a=r?"visible":"hidden",l=c(t);oe&&l?l.style.visibility=a:"string"==typeof t&&v("#"+t,"visibility:"+a)}}function N(t){return null!=/[\\\"<>\.;]/.exec(t)&&typeof encodeURIComponent!=E?encodeURIComponent(t):t}ee[0]=function(){Q?function Y(){var t=$.getElementsByTagName("body")[0],r=C(D);r.setAttribute("style","visibility: hidden;"),r.setAttribute("type",B);var a=t.appendChild(r);if(a){var l=0;!function ab(){if(typeof a.GetVariable!=E)try{var S=a.GetVariable("$version");S&&(S=S.split(" ")[1].split(","),le.pv=[n(S[0]),n(S[1]),n(S[2])])}catch(t){le.pv=[8,0,0]}else if(l<10)return l++,void setTimeout(ab,10);t.removeChild(r),a=null,H()}()}else H()}():H()};le.ie&&window.attachEvent("onunload",(function(){for(var r=re.length,a=0;a<r;a++)re[a][0].detachEvent(re[a][1],re[a][2]);for(var l=ne.length,S=0;S<l;S++)y(ne[S]);for(var O in le)le[O]=null;for(var L in le=null,t)t[L]=null;t=null}));return{registerObject:function(t,r,a,l){if(le.w3&&t&&r){var S={};S.id=t,S.swfVersion=r,S.expressInstall=a,S.callbackFn=l,te[te.length]=S,w(t,!1)}else l&&l({success:!1,id:t})},getObjectById:function(t){if(le.w3)return z(t)},embedSWF:function(t,r,a,l,S,O,L,j,B,q){var G=W(r),X={success:!1,id:G};le.w3&&!(le.wk&&le.wk<312)&&t&&r&&a&&l&&S?(w(G,!1),M((function(){a+="",l+="";var $={};if(B&&typeof B===D)for(var Z in B)$[Z]=B[Z];$.data=t,$.width=a,$.height=l;var Q={};if(j&&typeof j===D)for(var ee in j)Q[ee]=j[ee];if(L&&typeof L===D)for(var te in L)if(L.hasOwnProperty(te)){var ne=se?encodeURIComponent(te):te,re=se?encodeURIComponent(L[te]):L[te];typeof Q.flashvars!=E?Q.flashvars+="&"+ne+"="+re:Q.flashvars=ne+"="+re}if(F(S)){var oe=u($,Q,r);$.id==G&&w(G,!0),X.success=!0,X.ref=oe,X.id=oe.id}else{if(O&&A())return $.data=O,void R($,Q,r,q);w(G,!0)}q&&q(X)}))):q&&q(X)},switchOffAutoHideShow:function(){ae=!1},enableUriEncoding:function(t){se=typeof t===E||t},ua:le,getFlashPlayerVersion:function(){return{major:le.pv[0],minor:le.pv[1],release:le.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(t,r,a){return le.w3?u(t,r,a):void 0},showExpressInstall:function(t,r,a,l){le.w3&&A()&&R(t,r,a,l)},removeSWF:function(t){le.w3&&y(t)},createCSS:function(t,r,a,l){le.w3&&v(t,r,a,l)},addDomLoadEvent:M,addLoadEvent:function s(t){if(typeof X.addEventListener!=E)X.addEventListener("load",t,!1);else if(typeof $.addEventListener!=E)$.addEventListener("load",t,!1);else if(typeof X.attachEvent!=E)!function g(t,r,a){t.attachEvent(r,a),re[re.length]=[t,r,a]}(X,"onload",t);else if("function"==typeof X.onload){var r=X.onload;X.onload=function(){r(),t()}}else X.onload=t},getQueryParamValue:function(t){var r=$.location.search||$.location.hash;if(r){if(/\?/.test(r)&&(r=r.split("?")[1]),null==t)return N(r);for(var a=r.split("&"),l=0;l<a.length;l++)if(a[l].substring(0,a[l].indexOf("="))==t)return N(a[l].substring(a[l].indexOf("=")+1))}return""},expressInstallCallback:function(){if(ie){var t=c(q);t&&r&&(t.parentNode.replaceChild(r,t),a&&(w(a,!0),le.ie&&(r.style.display="block")),l&&l(S)),ie=!1}},version:"2.3"}}();return t}.call(r,a,r,t))||(t.exports=l)},541:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",proper?(__p+='<div class="'+(null==(__t=fractionClass)?"":__t)+'">',integer&&(__p+='<span class="'+(null==(__t=fractionClass)?"":__t)+'-integer">'+(null==(__t=integer)?"":__t)+"</span>"),__p+='<span class="'+(null==(__t=fractionClass)?"":__t)+'-proper-fraction">'+(null==(__t=proper)?"":__t)+"</span></div>"):__p+=""+(null==(__t=integer)?"":__t),__p+="";return __p}},577:function(module,exports,__webpack_require__){var _=__webpack_require__(0);module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="<div ",htmlId&&(__p+='id="'+(null==(__t=htmlId)?"":__t)+'" '),__p+='class="lrn lrn_widget lrn_feature lrn_'+(null==(__t=featureType)?"":__t)+" "+(null==(__t=extraClasses)?"":__t)+'">'+(null==(__t=featureContent)?"":__t)+"</div>";return __p}}}]);